; KANJI.MAC
;
; KANJI (BASIC + Extended BIOS) (special DOS2 version, runs only with DOS2!)
;
; Source re-created by Z80DIS 2.2
; Z80DIS was written by Kenneth Gielow, Palo Alto, CA
;
; Code Copyrighted by ASCII and maybe others
; Source comments by Arjen Zeilemaker
;
; Sourcecode supplied for STUDY ONLY
; Recreation NOT permitted without authorisation of the copyrightholders
;

        .Z80
        ORG     4100H

CGTABL  EQU     0004H
VDP.DR  EQU     0006H
RDSLT   EQU     000CH
CALSLT  EQU     001CH
IDBYT2  EQU     002DH
WRTVDP  EQU     0047H
RDVRM   EQU     004AH
WRTVRM  EQU     004DH
FILVRM  EQU     0056H
LDIRMV  EQU     0059H
LDIRVM  EQU     005CH
CHGMOD  EQU     005FH
GICINI  EQU     0090H
CHSNS   EQU     009CH
CHGET   EQU     009FH
CHPUT   EQU     00A2H
LPTOUT  EQU     00A5H
LPTSTT  EQU     00A8H
BREAKX  EQU     00B7H
I$00C0  EQU     00C0H   ; ----I
CLS     EQU     00C3H
I$00C4  EQU     00C4H   ; ----I
I$00D0  EQU     00D0H   ; ----I
TOTEXT  EQU     00D2H
I$00D4  EQU     00D4H   ; ----I
I$00DC  EQU     00DCH   ; ----I
I$00E0  EQU     00E0H   ; ----I
I$00E2  EQU     00E2H   ; ----I
I$00E3  EQU     00E3H   ; ----I
I$00E4  EQU     00E4H   ; ----I
I$00F0  EQU     00F0H   ; ----I
I$00F8  EQU     00F8H   ; ----I
PUTCHR  EQU     0139H
SNSMAT  EQU     0141H
KILBUF  EQU     0156H
CALBAS  EQU     0159H
EXTROM  EQU     015FH

I.0161  EQU     0161H   ; ----I
I$021E  EQU     021EH   ; ----I
I$023E  EQU     023EH   ; ----I
C$02FE  EQU     02FEH   ; -C---
I$0327  EQU     0327H   ; ----I
I$0373  EQU     0373H   ; ----I
I$043E  EQU     043EH   ; ----I
I$051E  EQU     051EH   ; ----I
I$0627  EQU     0627H   ; ----I
I.0800  EQU     0800H   ; ----I
I$080A  EQU     080AH   ; ----I
I$0B00  EQU     0B00H   ; ----I
I$0C06  EQU     0C06H   ; ----I
C$0C49  EQU     0C49H   ; -C---
D.0C98  EQU     0C98H   ; ---L-
I$0D0C  EQU     0D0CH   ; ----I
I$0D0D  EQU     0D0DH   ; ----I
D$0D4F  EQU     0D4FH   ; ---L-
I$0DE3  EQU     0DE3H   ; ----I
I$0F0F  EQU     0F0FH   ; ----I
I$0F1E  EQU     0F1EH   ; ----I
I$1000  EQU     1000H   ; ----I
I$1008  EQU     1008H   ; ----I
I$1800  EQU     1800H   ; ----I
I$18D9  EQU     18D9H   ; ----I
I$1B00  EQU     1B00H   ; ----I
I$1E08  EQU     1E08H   ; ----I
I$1E20  EQU     1E20H   ; ----I
I$2000  EQU     2000H   ; ----I
I$2028  EQU     2028H   ; ----I
I$2121  EQU     2121H   ; ----I
J$21BA  EQU     21BAH   ; J----
I$2322  EQU     2322H   ; ----I
D$2423  EQU     2423H   ; --S--
J$24BC  EQU     24BCH   ; J----
I$2526  EQU     2526H   ; ----I
I$253F  EQU     253FH   ; ----I
I$256F  EQU     256FH   ; ----I
I$2574  EQU     2574H   ; ----I
C$25C1  EQU     25C1H   ; -C---
J$25DE  EQU     25DEH   ; J----
J$26B7  EQU     26B7H   ; J----
J$28C0  EQU     28C0H   ; J----
J$2ADE  EQU     2ADEH   ; J----
D$2C1D  EQU     2C1DH   ; ---L-
D$2C2B  EQU     2C2BH   ; ---L-
D$2C5D  EQU     2C5DH   ; ---L-
J$2CC1  EQU     2CC1H   ; J----
C$2CDD  EQU     2CDDH   ; -C---
C$2EB8  EQU     2EB8H   ; -C---
J$2EC2  EQU     2EC2H   ; J----
J$2FC2  EQU     2FC2H   ; J----
J$3035  EQU     3035H   ; J----
J$3038  EQU     3038H   ; J----
C$303C  EQU     303CH   ; -C---
J$306E  EQU     306EH   ; J----
I$3306  EQU     3306H   ; ----I
J$3364  EQU     3364H   ; J----
C$337C  EQU     337CH   ; -C---
D$33BB  EQU     33BBH   ; ---L-
J$3549  EQU     3549H   ; J----
C$3551  EQU     3551H   ; -C---
J$35DD  EQU     35DDH   ; J----
J$367E  EQU     367EH   ; J----
J$3766  EQU     3766H   ; J----
J$397A  EQU     397AH   ; J----
J$3B28  EQU     3B28H   ; J----
J$3B2D  EQU     3B2DH   ; J----
D$3C1D  EQU     3C1DH   ; ---L-
D$3C26  EQU     3C26H   ; --S--
J$3C38  EQU     3C38H   ; J----
D$3C3B  EQU     3C3BH   ; ---L-
C$3C4B  EQU     3C4BH   ; -C---
D$3C7D  EQU     3C7DH   ; ---L-
J$3CDD  EQU     3CDDH   ; J----
J$3D50  EQU     3D50H   ; J----
J$3D51  EQU     3D51H   ; J----
C$3FB8  EQU     3FB8H   ; -C---
I$403E  EQU     403EH   ; ----I
I$4050  EQU     4050H   ; ----I
J$405A  EQU     405AH   ; J----
I$406F  EQU     406FH   ; ----I
C.4092  EQU     4092H   ; JC---
I$409B  EQU     409BH   ; ----I
I$803E  EQU     803EH   ; ----I
I.8140  EQU     8140H   ; ----I
J$84FD  EQU     84FDH   ; J----
I$989E  EQU     989EH   ; ----I
I$A080  EQU     0A080H  ; ----I
J$A3B9  EQU     0A3B9H  ; J----
C$A9A7  EQU     0A9A7H  ; -C---
J$ACAD  EQU     0ACADH  ; J----
C$AD00  EQU     0AD00H  ; -C---
D.B130  EQU     0B130H  ; ---LI
I$B2B4  EQU     0B2B4H  ; ----I
I$B2B5  EQU     0B2B5H  ; ----I
D$B2B6  EQU     0B2B6H  ; --S--
D$B2BB  EQU     0B2BBH  ; ---L-
J$B2DE  EQU     0B2DEH  ; J----
D$B331  EQU     0B331H  ; ---L-
C$B3B1  EQU     0B3B1H  ; -C---
I$B3B5  EQU     0B3B5H  ; ----I
C$B3DE  EQU     0B3DEH  ; -C---
D$B4BB  EQU     0B4BBH  ; ---L-
D.B634  EQU     0B634H  ; --S-I
I$B6B5  EQU     0B6B5H  ; ----I
D$B6BB  EQU     0B6BBH  ; ---L-
C.B6CE  EQU     0B6CEH  ; -C---
C$B6DE  EQU     0B6DEH  ; -C---
I$B7B4  EQU     0B7B4H  ; ----I
D.B7B5  EQU     0B7B5H  ; --S--
D.B7BB  EQU     0B7BBH  ; ---L-
D$B7CD  EQU     0B7CDH  ; ---L-
D$B837  EQU     0B837H  ; ---L-
D$B8B5  EQU     0B8B5H  ; --S--
J.B8B7  EQU     0B8B7H  ; J----
D$B8BB  EQU     0B8BBH  ; ---L-
C.B8DE  EQU     0B8DEH  ; JC---
D$B937  EQU     0B937H  ; --S--
C$B9B3  EQU     0B9B3H  ; -C---
D$B9B5  EQU     0B9B5H  ; --S--
D$B9BB  EQU     0B9BBH  ; ---L-
D$BBBB  EQU     0BBBBH  ; ---L-
D$BC3D  EQU     0BC3DH  ; ---L-
D$BCBB  EQU     0BCBBH  ; ---L-
C$BDAF  EQU     0BDAFH  ; -C---
D$BDB5  EQU     0BDB5H  ; --S--
C$BDC2  EQU     0BDC2H  ; -C---
I$BFB3  EQU     0BFB3H  ; ----I
I$C03E  EQU     0C03EH  ; ----I
I$C0B3  EQU     0C0B3H  ; ----I
J$C1DB  EQU     0C1DBH  ; J----
J$C200  EQU     0C200H  ; J----
I$C2B3  EQU     0C2B3H  ; ----I
I$C2B4  EQU     0C2B4H  ; ----I
D$C2B5  EQU     0C2B5H  ; --S--
D$C2BB  EQU     0C2BBH  ; ---L-
C.C2DE  EQU     0C2DEH  ; JC---
J$C4DE  EQU     0C4DEH  ; J----
I$C5B3  EQU     0C5B3H  ; ----I
C.C5B6  EQU     0C5B6H  ; -C---
C$C5DE  EQU     0C5DEH  ; -C---
I$C647  EQU     0C647H  ; ----I
J$C7A6  EQU     0C7A6H  ; J----
I$C9B4  EQU     0C9B4H  ; ----I
J$C9C0  EQU     0C9C0H  ; J----
J$CA00  EQU     0CA00H  ; J----
D$CA48  EQU     0CA48H  ; --S--
D.CB49  EQU     0CB49H  ; --S-I
C$CC00  EQU     0CC00H  ; -C---
C.CCC8  EQU     0CCC8H  ; -C---
C$CD00  EQU     0CD00H  ; -C---
I.D14C  EQU     0D14CH  ; ----I
J$D1B9  EQU     0D1B9H  ; J----
C.D1D0  EQU     0D1D0H  ; -C---
D$D24C  EQU     0D24CH  ; ---L-
J$D300  EQU     0D300H  ; J----
J$D3A2  EQU     0D3A2H  ; J----
J$D3DB  EQU     0D3DBH  ; J----
I$D400  EQU     0D400H  ; ----I
J$D4D5  EQU     0D4D5H  ; J----
C$D6D5  EQU     0D6D5H  ; -C---
I$D7B3  EQU     0D7B3H  ; ----I
I$D8F0  EQU     0D8F0H  ; ----I
I$D9B3  EQU     0D9B3H  ; ----I
D$DAB5  EQU     0DAB5H  ; --S--
J$DB00  EQU     0DB00H  ; J----
C$DC00  EQU     0DC00H  ; -C---
I$DCB3  EQU     0DCB3H  ; ----I
J$DCC0  EQU     0DCC0H  ; J----
C.DCD8  EQU     0DCD8H  ; -C---
I$DDB3  EQU     0DDB3H  ; ----I
I$DDB4  EQU     0DDB4H  ; ----I
D$DDB5  EQU     0DDB5H  ; --S--
D$DDBA  EQU     0DDBAH  ; ---L-
C.DDDE  EQU     0DDDEH  ; JC---
D.DEB6  EQU     0DEB6H  ; --S--
J$DEB7  EQU     0DEB7H  ; J----
D.DEBB  EQU     0DEBBH  ; ---L-
J$DEBC  EQU     0DEBCH  ; J----
C$DEC4  EQU     0DEC4H  ; -C---
C$DECB  EQU     0DECBH  ; -C---
J$DECE  EQU     0DECEH  ; J----
I.DF08  EQU     0DF08H  ; ----I
I$E200  EQU     0E200H  ; ----I
D$E500  EQU     0E500H  ; --S--
C.ECE8  EQU     0ECE8H  ; -C---

I$F247  EQU     0F247H  ; unused DOS2 workspace, used because SLTWKR entry already used by DOS2

D.F30F  EQU     0F30FH  ; --S--

MASTER  EQU     0F348H  ; ----I
D$F349  EQU     0F349H  ; --S--
D$F36B  EQU     0F36BH  ; ---L-
LINL40  EQU     0F3AEH  ; ---L-
LINL32  EQU     0F3AFH  ; ---L-
LINLEN  EQU     0F3B0H  ; --SLI
CRTCNT  EQU     0F3B1H  ; --SLI
CLMLST  EQU     0F3B2H  ; --S--
CLIKSW  EQU     0F3DBH  ; ---L-
CSRY    EQU     0F3DCH  ; --SLI
CSRX    EQU     0F3DDH  ; ---LI
CNSDFG  EQU     0F3DEH  ; --SL-
RG0SAV  EQU     0F3DFH  ; --SL-
RG1SAV  EQU     0F3E0H  ; ---L-
RG2SAV  EQU     0F3E1H  ; ---L-
RG7SAV  EQU     0F3E6H  ; ---L-
TRGFLG  EQU     0F3E8H  ; ----I
FORCLR  EQU     0F3E9H  ; --SL-
BAKCLR  EQU     0F3EAH  ; --SLI
SCNCNT  EQU     0F3F6H  ; ----I
REPCNT  EQU     0F3F7H  ; --S-I
PUTPNT  EQU     0F3F8H  ; --SL-
GETPNT  EQU     0F3FAH  ; --SL-
RAWPRT  EQU     0F418H  ; ----I
CURLIN  EQU     0F41CH  ; ---L-
I$F52F  EQU     0F52FH  ; ----I
BUFMIN  EQU     0F55DH
BUF     EQU     0F55EH
TTYPOS  EQU     0F661H
VALTYP  EQU     0F663H
TXTTAB  EQU     0F676H
DSCTMP  EQU     0F698H
AUTFLG  EQU     0F6AAH
OLDLIN  EQU     0F6BEH
SWPTMP  EQU     0F7BCH
DECCNT  EQU     0F7F4H
DAC     EQU     0F7F6H
HOLD8   EQU     0F806H
D.F85F  EQU     0F85FH  ; --SL-
D$F860  EQU     0F860H  ; --S--
FNKSTR  EQU     0F87FH
ACPAGE  EQU     0FAF6H
EXBRSA  EQU     0FAF8H
CHRCNT  EQU     0FAF9H
MODE    EQU     0FAFCH
NORUSE  EQU     0FAFDH
HOKVLD  EQU     0FB20H
I$FB99  EQU     0FB99H  ; ----I
I$FBAD  EQU     0FBADH  ; ----I
ENSTOP  EQU     0FBB0H
BASROM  EQU     0FBB1H
LINTTB  EQU     0FBB2H
FSTPOS  EQU     0FBCAH
FNKSWI  EQU     0FBCDH
ONGSBF  EQU     0FBD8H
CLIKFL  EQU     0FBD9H
OLDKEY  EQU     0FBDAH
NEWKEY  EQU     0FBE5H
KEYBUF  EQU     0FBF0H
LINWRK  EQU     0FC18H
PATWRK  EQU     0FC40H
HIMEM   EQU     0FC4AH
D$FC6A  EQU     0FC6AH  ; ---L-
D$FC6B  EQU     0FC6BH  ; ---L-
I.FC70  EQU     0FC70H  ; ----I
I.FC73  EQU     0FC73H  ; ----I
I.FC76  EQU     0FC76H  ; ----I
I.FC79  EQU     0FC79H  ; ----I
I.FC7C  EQU     0FC7CH  ; ----I
D.FC9B  EQU     0FC9BH  ; --SL-
D.FCA7  EQU     0FCA7H  ; --S-I
D.FCA8  EQU     0FCA8H  ; --S-I
D.FCA9  EQU     0FCA9H  ; --SL-
D.FCAA  EQU     0FCAAH  ; --SL-
D.FCAB  EQU     0FCABH  ; ---LI
D.FCAC  EQU     0FCACH  ; --SL-
D$FCAD  EQU     0FCADH  ; ---L-
D.FCAF  EQU     0FCAFH  ; --SL-
D.FCB0  EQU     0FCB0H  ; ---L-
D$FCC0  EQU     0FCC0H  ; ---L-
D.FCC1  EQU     0FCC1H  ; ---LI
C.FCF8  EQU     0FCF8H  ; -C---
D$FD0D  EQU     0FD0DH  ; ---L-
D$FD0E  EQU     0FD0EH  ; ---L-
I$FD89  EQU     0FD89H  ; ----I
H.TOTE  EQU     0FDBDH  ; ---L-
D.FDBE  EQU     0FDBEH  ; ---L-
D.FDC2  EQU     0FDC2H  ; --S-I
C$FDCC  EQU     0FDCCH  ; -C---
C$FDD1  EQU     0FDD1H  ; -C---
I$FDE0  EQU     0FDE0H  ; ----I
I.FF08  EQU     0FF08H  ; ----I
I$FF3E  EQU     0FF3EH  ; ----I
I$FF9C  EQU     0FF9CH  ; ----I
D.FFA7  EQU     0FFA7H  ; ---L-
D.FFB6  EQU     0FFB6H  ; --S--
I$FFC0  EQU     0FFC0H  ; ----I
EXTBIO  EQU     0FFCAH  ; -C---
D.FFE7  EQU     0FFE7H  ; ---L-
D.FFE8  EQU     0FFE8H  ; ---L-
I$FFF0  EQU     0FFF0H  ; ----I
I$FFF2  EQU     0FFF2H  ; ----I
D.FFF6  EQU     0FFF6H  ; ---LI
D$FFFA  EQU     0FFFAH  ; ---L-
I$FFFB  EQU     0FFFBH  ; ----I
I.FFFF  EQU     0FFFFH  ; ----I

I4100: 	JP      J$45CC			; TOTEXT handler
?.4103: JP      J.47C3			; CHPUT handler
?.4106: JP      J$4908			; display cursor handler
?.4109: JP      J$491F			; erase cursor handler
?.410C: JP      J$4AF3			; erase function keys handler
?.410F: JP      J$4B17			; display function keys handler
?.4112: JP      J$4D56			; PINLIN handler
?.4115: JP      J$4D6C			; INLIN handler
?.4118: JP      J$6BEF			; LPTOUT handler
?.411B: JP      J$45AD			; CHGET handler
?.411E: JP      J$44E0			; WIDTH handler
?.4121: JP      J$453C			; SCREEN handler
?.4124: JP      J$412D			; statement handler
?.4127: JP      J$414B			; extended bios handler
?.412A: JP      J$418C			; timer interrupt handler

;         Subroutine STATEMENT handler
;            Inputs  ________________________
;            Outputs ________________________

J$412D: LD      A,(IDBYT2)
        CP      02H                     ; MSX2+ or higher ?
        CCF
        RET     C                       ; yep, quit
        LD      A,(D.FFA7)
        CP      0C9H                    ; disk environment ?
        SCF
        RET     Z                       ; nope, quit
        PUSH    HL
        PUSH    BC
        CALL    C.456A                  ; GETSLT
        POP     BC
        LD      HL,MASTER
        CP      (HL)                    ; I am the disksystem master ROM ?
        POP     HL
        SCF
        RET     NZ                      ; nope, quit statement handler
        JP      J$422B

;         Subroutine EXTBIO handler
;            Inputs  ________________________
;            Outputs ________________________

J$414B: PUSH    AF
        LD      A,D
        CP      11H                     ; KANJI EXTBIO ?
        JR      NZ,J.4181               ; nope, quit
        CALL    C.41F9                  ; get KANJI workspace
        LD      A,(IX+0)
        OR      A                       ; KANJI enabled ?
        JR      Z,J.4181                ; nope, quit
        LD      A,E
        OR      A                       ; function 0 ?
        JR      NZ,J$416E
        POP     AF
        XOR     A
        BIT     5,(IX+1)                ; in KANJI mode ?
        RET     Z                       ; nope, quit (mode 0, ANK)
        LD      A,(IX+0)
        RLCA
        RLCA
        AND     03H
        INC     A
        RET

J$416E: DEC     A                       ; function 1 ?
        JR      NZ,J.4181               ; nope, quit
        POP     AF
        CP      4+1
        RET     NC
        PUSH    AF
        PUSH    BC
        PUSH    DE
        PUSH    HL
        CALL    C$4183                  ; select KANJI mode
        POP     HL
        POP     DE
        POP     BC
        POP     AF
        RET

J.4181: POP     AF
        RET

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C$4183: DEC     A
        JP      M,J$447E
        RRCA
        RRCA
        JP      J$42EA

;         Subroutine H.TIMI handler
;            Inputs  ________________________
;            Outputs ________________________

J$418C: PUSH    AF
        CALL    C.41F9                  ; get KANJI workspace
        BIT     5,(IX+1)
        JR      Z,J$419D
        CALL    C.541B
        LD      HL,SCNCNT
        INC     (HL)
J$419D: POP     AF
        RET

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C$419F: PUSH    HL
        CALL    C.456A                  ; GETSLT
        LD      C,A
        POP     HL
        LD      IX,I4100-040H
J$41A9: LD      E,(HL)
        INC     HL
        LD      D,(HL)
        INC     HL
        LD      A,E
        OR      D
        RET     Z
        LD      A,0F7H
        LD      (DE),A
        INC     DE
        LD      A,C
        LD      (DE),A
        INC     DE
        PUSH    IX
        EX      (SP),HL
        LD      A,L
        LD      (DE),A
        INC     DE
        LD      A,H
        LD      (DE),A
        INC     DE
        INC     HL
        INC     HL
        INC     HL
        EX      (SP),HL
        POP     IX
        LD      A,0C9H
        LD      (DE),A
        JR      J$41A9

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.41CB: LD      E,(HL)
        INC     HL
        LD      D,(HL)
        INC     HL
        LD      A,E
        OR      D
        RET     Z
        LD      A,0C9H
        LD      (DE),A
        INC     DE
        LD      (DE),A
        INC     DE
        LD      (DE),A
        INC     DE
        LD      (DE),A
        INC     DE
        LD      (DE),A
        JR      C.41CB

I.41DF:	DEFW	H.TOTE
        DEFW	H.CHPU
        DEFW	H.DSPC
        DEFW	H.ERAC
        DEFW	H.ERAF
        DEFW	H.DSPF
        DEFW	H.PINL
        DEFW	H.INLI
        DEFW	H.LPTO
        DEFW	H.CHGE
        DEFW	H.WIDT
        DEFW	H.SCRE
        DEFW	0

;         Subroutine get KANJI workspace
;            Inputs  ________________________
;            Outputs ________________________

C.41F9: LD      IX,I$F247               ; unused space in DOS2
        RET

;         Subroutine call BASIC routine
;            Inputs  ________________________
;            Outputs ________________________

C.41FE: EXX
        EX      AF,AF'
        LD      HL,-16
        ADD     HL,SP
        LD      SP,HL
        PUSH    HL
        EX      DE,HL
        LD      HL,I$421A
        LD      BC,16
        LDIR
        POP     HL
        PUSH    DE
        CALL    C$4219
        POP     HL
        LD      SP,HL
        EX      AF,AF'
        EXX
        RET

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C$4219: JP      (HL)

I$421A: XOR     A
        CALL    C.4092
        EXX
        EX      AF,AF'
        CALL    CALBAS
        EX      AF,AF'
        EXX
        LD      A,03H   ; 3 
        JP      C.4092

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.422A: RET

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

J$422B: EI
        PUSH    HL
        LD      HL,I$4254
J$4230: LD      DE,I$FD89
J$4233: LD      A,(DE)
J$4234: CP      (HL)
        JR      NZ,J$4247
        INC     DE
        INC     HL
        AND     A
        JR      NZ,J$4233
        LD      E,(HL)
        INC     HL
        LD      D,(HL)
        POP     HL
        CALL    C$4245
        AND     A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$4245: PUSH    DE
        RET
J$4247: LD      C,0FFH
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$4249: XOR     A
        CPIR
        INC     HL
        INC     HL
        CP      (HL)
        JR      NZ,J$4230
        POP     HL
        SCF
        RET
I$4254: LD      D,B
        LD      B,C
        LD      C,H
        LD      B,L
        LD      D,H
        LD      D,H
        LD      B,L
        NOP
        JP      (HL)
?.425D: LD      (HL),C
        LD      B,E
        LD      C,H
        LD      D,E
        NOP
        SBC     A,H
        LD      B,A
        LD      B,C
        LD      C,E
        LD      B,E
        LD      C,(HL)
        LD      D,(HL)
        NOP
        CALL    C$4A6C
        LD      C,C
        LD      D,E
        NOP
        LD      H,E
        LD      L,(HL)
        LD      D,E
        LD      C,D
        LD      C,C
        LD      D,E
        NOP
        LD      C,H
        LD      L,(HL)
        LD      C,E
        LD      B,C
        LD      B,E
        LD      C,(HL)
        LD      D,(HL)
        NOP
        OR      H
        LD      L,L
        LD      C,E
        LD      B,L
        LD      E,B
        LD      D,H
        NOP
        AND     D
        LD      L,(HL)
        LD      C,E
        LD      C,C
        LD      C,(HL)
        LD      D,E
        LD      D,H
        LD      D,D
        NOP
        AND     D
        LD      L,A
        LD      C,E
        LD      C,H
        LD      B,L
        LD      C,(HL)
        NOP
        LD      B,H
        LD      (HL),B
        LD      C,E
        LD      C,L
        LD      C,C
        LD      B,H
        NOP
        EI
        LD      L,(HL)
        LD      C,E
        LD      C,(HL)
        LD      C,D
        NOP
        LD      L,E
        LD      L,A
        LD      C,E
        LD      D,H
        LD      E,C
        LD      D,B
        LD      B,L
        NOP
        ADD     A,(HL)
        LD      (HL),B
        LD      C,E
        LD      B,C
        LD      C,(HL)
        LD      C,D
        LD      C,C
        NOP
        RET     PO
        LD      B,D
        LD      C,E
        LD      B,C
        LD      C,(HL)
        LD      C,D
        LD      C,C
        JR      NC,J$42BC
J$42BC: RET     PO
        LD      B,D
        LD      C,E
        LD      B,C
        LD      C,(HL)
        LD      C,D
        LD      C,C
        LD      SP,I$E200
        LD      B,D
        LD      C,E
        LD      B,C
        LD      C,(HL)
        LD      C,D
        LD      C,C
        LD      (D$E500),A
        LD      B,D
        LD      C,E
        LD      B,C
        LD      C,(HL)
        LD      C,D
        LD      C,C
        INC     SP
        NOP
        RET     PE
        LD      B,D
        LD      B,C
        LD      C,(HL)
        LD      C,E
        NOP
        LD      A,(HL)
        LD      B,H
        NOP
 
        XOR     A
        DEFB    001H
        LD      A,040H
        DEFB    001H
        LD      A,080H
        DEFB    001H
        LD      A,0C0H
J$42EA: PUSH    HL
        PUSH    AF
        LD      HL,I.41DF
        CALL    C$419F
        CALL    C.41F9                  ; get KANJI workspace
        SET     5,(IX+1)
        POP     BC
        LD      A,(IX+0)
        AND     A
        PUSH    AF
        LD      (IX+0),B
        LD      A,18H
        LD      (LINTTB+0),A
        XOR     A
        OUT     (0D8H),A
        LD      A,02H   ; 2 
        OUT     (0D9H),A
        LD      HL,I$4476
        LD      B,08H   ; 8 
J$4313: IN      A,(0D9H)
        CP      (HL)
        JR      NZ,J$431F
        INC     HL
        DJNZ    J$4313
        SET     3,(IX+0)                ; JIS1 rom found
J$431F: IN      A,(40H)
        PUSH    AF
        LD      A,0F7H
        OUT     (40H),A
        LD      B,01H   ; 1 
J$4328: IN      A,(40H)
        CP      08H     ; 8 
        JR      Z,J.4357
        LD      A,01H   ; 1 
        OUT     (42H),A
        XOR     A
        OUT     (47H),A
        OUT     (48H),A
        LD      B,A
        IN      A,(49H)
        LD      C,A
        IN      A,(49H)
        OR      C
        JR      NZ,J.4357
        LD      A,0EH   ; 14 
        OUT     (47H),A
        LD      A,5FH   ; "_"
        OUT     (48H),A
        LD      C,00H
        LD      B,8
J$434C: IN      A,(49H)
        ADD     A,C
        LD      C,A
        DJNZ    J$434C
        CP      4CH     ; "L"
        JR      NZ,J.4357
        INC     B
J.4357: DJNZ    J$435D
        SET     4,(IX+0)                ; ? rom found
J$435D: LD      B,01H   ; 1 
        IN      A,(41H)
J$4361: CP      08H     ; 8 
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$4363: JR      Z,J.437F
        LD      A,02H   ; 2 
        OUT     (42H),A
        LD      A,25H   ; "%"
        OUT     (47H),A
        LD      A,5EH   ; "^"
        OUT     (48H),A
        DEC     B
        IN      A,(49H)
        SUB     41H     ; "A"
        LD      C,A
        IN      A,(49H)
        SUB     42H     ; "B"
        OR      C
        JR      NZ,J.437F
        INC     B
J.437F: DJNZ    J$4385
        SET     6,(IX+1)                ; ? rom found
J$4385: POP     AF
        CPL
        OUT     (40H),A
        LD      A,3EH   ; ">"
        OUT     (0DAH),A
        LD      A,35H   ; "5"
        OUT     (0DBH),A
        LD      BC,I.0800
J$4394: IN      A,(0DBH)
        ADD     A,C
        LD      C,A
        DJNZ    J$4394
        CP      95H
        JR      NZ,J$43A3
        LD      HL,MODE
        SET     6,(HL)                  ; JIS2 rom found
J$43A3: LD      A,(D.FFA7)
        CP      0C9H                    ; disk environment ?
        JR      Z,J$43B6                ; nope,
        LD      HL,0A080H
        LD      (D.F30F+0),HL
        LD      HL,0FDE0H
        LD      (D.F30F+2),HL
J$43B6: CALL    C.442D
        CALL    C.422A
        POP     AF
        POP     HL
        JR      NZ,C.4418
        LD      (SWPTMP+0),HL
        CALL    C.422A
        LD      IX,I$6C1C
        CALL    C.41FE
        CALL    C$6800
        CALL    C,C$7474
        PUSH    AF
        CALL    C.4418
        POP     AF
        LD      HL,(SWPTMP+0)
        RET     C
        PUSH    HL
        LD      HL,(CURLIN)
        LD      (OLDLIN),HL
        LD      HL,I$445B
        LD      DE,HOLD8
        LD      BC,27
        LDIR
        LD      A,(D.F85F)
        LD      (HOLD8+5),A
        POP     HL
        LD      A,L
        LD      (HOLD8+13),A
        LD      A,H
        LD      (HOLD8+21),A
        XOR     A
        LD      (D.F85F),A
        LD      HL,BUF
        LD      (D$F860),HL
        LD      HL,BUF+2
        LD      (BUF+0),HL
        LD      (HL),A
        LD      HL,HOLD8
        LD      IX,I$4601
        JP      C.41FE
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4418: XOR     A
        LD      IX,CHPUT
        JP      C.4561

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C$4420: LD      A,(D.FFA7)
        CP      0C9H                    ; disk environment ?
        JR      Z,C.442D                ; nope,
        LD      A,(D$F36B)
        CP      0C3H                    ; MSXDOS ?
        RET     Z                       ; yep, quit
;
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.442D: PUSH    HL
        CALL    C.44D3
        BIT     6,(IX+0)
        JR      NC,J$4443
        JR      Z,J.4453
        LD      E,A
        ADD     A,A
        ADD     A,A
        ADD     A,E
        RRCA
        RRCA
        AND     3FH     ; "?"
        JR      J.4453
J$4443: JR      NZ,J.4453
J$4445: LD      L,A
        LD      H,00H
        ADD     HL,HL
        ADD     HL,HL
        LD      DE,I$FFFB
        LD      A,0FFH
J$444F: ADD     HL,DE
        INC     A
        JR      C,J$444F
J.4453: LD      (LINLEN),A
        LD      (IX+6),A
        POP     HL
        RET
I$445B: LD      A,(D$B7CD)
        RST     28H
        RRCA
        NOP
        LD      A,(D.0C98)
J$4462  EQU     $-2
        RET     NZ
        OR      2CH     ; ","
        RRCA
        NOP
        LD      A,(D.0C98)
        POP     BC
        OR      2CH     ; ","
        RRCA
        NOP
        LD      A,(D$0099)
        DEFB    0,0
I$4476: DEFB    0
        LD      B,B
        JR      NZ,J$448A
        EX      AF,AF'
        INC     B
        LD      (BC),A
        LD      BC,I$F9CD
J$447E  EQU     $-2
        LD      B,C
        BIT     5,(IX+1)
        RET     Z
        RES     5,(IX+1)
J$448A: PUSH    HL
        LD      HL,I.41DF
        CALL    C.41CB
        CALL    C.422A
        CALL    C.6C92
        CALL    C.7E50
        JR      Z,J$44A3                ; No MSX-JE
        BIT     0,(IY+8)
        CALL    NZ,C.68D3
J$44A3: LD      (IY+8),0
        CALL    C.44D3
        LD      (LINLEN),A
        LD      A,18H
        LD      (CRTCNT),A
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$44B2: LD      A,02H   ; 2 
        LD      (D.FCAF),A
        LD      IX,TOTEXT
        CALL    C.4561
        CALL    C$4540
        LD      A,(D.FFA7)
        CP      0C9H                    ; disk environment ?
        JR      Z,J$44D1                ; nope,
        LD      HL,0
        LD      (D.F30F+0),HL
        LD      (D.F30F+2),HL
J$44D1: POP     HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.44D3: LD      A,(D.FCB0)
        AND     A
        LD      A,(LINL40)
        RET     Z
        LD      A,(LINL32)
        SCF
        RET

;         Subroutine WIDTH handler
;            Inputs  ________________________
;            Outputs ________________________

J$44E0: EI
        CP      1AH
        JR      C,J.4518
        CALL    C.41F9                  ; get KANJI workspace
        LD      A,(D.FCAF)
        CP      02H     ; 2 
        JR      NC,J.4518
        LD      A,(IDBYT2)
        AND     A                       ; MSX1 ?
        LD      A,E
        JR      NZ,J$4508               ; nope, MSX2 or higher
        BIT     6,(IX+0)
        JR      NZ,J$4502
        CP      21H     ; "!"
        JR      C,J.451B
        JR      J.4518
J$4502: CP      29H     ; ")"
        JR      C,J.451B
        JR      J.4518
J$4508: BIT     6,(IX+0)
        JR      NZ,J$4514
        CP      41H     ; "A"
        JR      C,J.451B
        JR      J.4518
J$4514: CP      51H     ; "Q"
        JR      C,J.451B
J.4518: XOR     A
        LD      E,A
        RET
J.451B: LD      (LINLEN),A
        LD      A,(RG0SAV)
        OR      08H     ; 8 
        LD      (RG0SAV),A
        CALL    C$45E5
        LD      A,(LINLEN)
J$452C: SUB     0EH     ; 14 
        JR      NC,J$452C
        ADD     A,1CH
        CPL
        INC     A
        ADD     A,E
        LD      (CLMLST),A
        CALL    C.4583
        RET

;         Subroutine SCREEN handler
;            Inputs  ________________________
;            Outputs ________________________

J$453C: RET     Z
        CP      2CH     ; ","
        RET     Z
;
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$4540: PUSH    AF
        LD      A,(D.FFE8)
        AND     0F3H
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$4546: LD      C,09H   ; 9 
        CALL    C.4557
        LD      A,(D.FFE7)
        AND     0FDH
        LD      C,08H   ; 8 
        CALL    C.4557
        POP     AF
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.4557: LD      B,A
        LD      A,(EXBRSA)
        AND     A
        RET     Z
        LD      IX,WRTVDP

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.4561: LD      IY,(D$FCC0)
        CALL    CALSLT
        EI
        RET

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.456A: IN      A,(0A8H)
        RRCA
        RRCA
        AND     03H     ; 3 
        LD      HL,D.FCC1
        LD      B,00H
        LD      C,A
        ADD     HL,BC
        OR      (HL)
        RET     P
        LD      C,A
        INC     HL
        INC     HL
        INC     HL
        INC     HL
        LD      A,(HL)
        AND     0CH     ; 12 
        OR      C
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4583: PUSH    HL
        PUSH    AF
        LD      A,(D.FDBE)
        ADD     A,A
        LD      HL,14
        JR      NC,J$4590
        LD      L,14+8
J$4590: ADD     HL,SP
        LD      (HL),8BH
        INC     HL
        LD      (HL),0F3H
        POP     AF
        POP     HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4599: PUSH    HL
        PUSH    AF
        LD      A,(D.FDBE)
        ADD     A,A
        LD      HL,14
        JR      NC,J$45A6
        LD      L,14+8
J$45A6: ADD     HL,SP
        LD      (HL),E
        INC     HL
        LD      (HL),D
        POP     AF
        POP     HL
        RET

;         Subroutine CHGET handler
;            Inputs  ________________________
;            Outputs ________________________

J$45AD: EI
        LD      DE,I$0D0D
        CALL    C.4599
        CALL    C.41F9                  ; get KANJI workspace
        XOR     A
        CALL    C.45EA
;
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$45BB: LD      A,0C9H
        LD      (D.FDC2),A
        CALL    C.41F9                  ; get KANJI workspace
        CALL    C$68F0
        LD      HL,D.FDC2
        LD      (HL),0F7H
        RET

;         Subroutine TOTEXT handler
;            Inputs  ________________________
;            Outputs ________________________

J$45CC: EI
        CALL    C.4583
        CALL    C.41F9                  ; get KANJI workspace
        LD      A,(NORUSE)
        BIT     7,A
        RET     NZ
        LD      A,(D.FCB0)
        LD      (D.FCAF),A
        LD      A,(IX+6)
        LD      (LINLEN),A
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$45E5: LD      A,18H
        LD      (LINTTB+0),A
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.45EA: PUSH    AF
        LD      A,(RG0SAV)
        AND     0EH     ; 14 
        JR      Z,J$4606
        CP      04H     ; 4 
        JR      NZ,J.45FD
        LD      A,(RG1SAV)
        AND     18H
        JR      J$460D
J.45FD: LD      A,(LINTTB+0)
        CP      18H
I$4601  EQU     $-1
        JR      Z,J$4614
        JR      J$4621
J$4606: LD      A,(RG1SAV)
        AND     18H
        JR      Z,J$4611
J$460D: CP      10H     ; 16 
        JR      NZ,J.45FD
J$4611: CALL    C$4420
J$4614: LD      A,0FFH
        LD      (LINTTB+0),A
        LD      A,(IX+1)
        OR      0FH     ; 15 
        LD      (IX+1),A
J$4621: PUSH    HL
        LD      A,(D.FCAF)
        CP      01H     ; 1 
        JR      NZ,J$462A
        XOR     A
J$462A: LD      L,A
        LD      A,(IX+1)
        LD      H,A
        AND     0F0H
        OR      L
        LD      (IX+1),A
        LD      A,H
        AND     0FH     ; 15 
        CP      L
        JP      Z,J.4759
        PUSH    DE
        PUSH    BC
        RES     5,(IX+0)
        LD      A,L
        CP      02H     ; 2 
        JR      NC,J$4686
        SET     5,(IX+0)
        LD      A,(IDBYT2)
        AND     A                       ; MSX1 ?
        LD      B,02H   ; 2 
        JR      Z,J.4672                ; yep,
        BIT     6,(IX+0)
        LD      A,(LINLEN)
        JR      NZ,J$4660
        CP      21H     ; "!"
        JR      J$4662
J$4660: CP      29H     ; ")"
J$4662: LD      B,05H   ; 5 
        JR      C,J.4672
I$4666: LD      A,(MODE)
J$4668  EQU     $-1
        AND     06H     ; 6 
        CP      04H                     ; 128 KB VRAM ?
        LD      B,7
        JR      Z,J.4672                ; yep, use screenmode 7
        DEC     B                       ; nope, use screenmode 6
J.4672: PUSH    BC
        LD      A,B
        CALL    CHGMOD
        XOR     A
        LD      (D.FCAF),A
        LD      A,(IDBYT2)
        AND     A                       ; MSX1 ?
        LD      A,(D.FFE7)
        SET     1,A
        JR      J$469F
J$4686: LD      B,A
        LD      A,(IX+1)
        AND     0F0H
        OR      B
        LD      (IX+1),A
        LD      A,0FFH
        LD      (LINLEN),A
        PUSH    BC
        LD      A,(IDBYT2)
        AND     A                       ; MSX1 ?
        LD      A,(D.FFE7)
        RES     1,A
J$469F: LD      B,A
        LD      C,08H   ; 8 
        CALL    NZ,WRTVDP               ; MSX2 or higher,
        POP     AF
        DEC     A
        LD      C,A
        LD      A,(IX+0)
        AND     0F8H
        OR      C
        LD      (IX+0),A
        RRCA
J$46B2: RRCA
        AND     30H     ; "0"
        SLA     C
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$46B7: OR      C
        LD      C,A
        LD      B,00H
        LD      HL,I$475C
J$46BD  EQU     $-1
        ADD     HL,BC
        LD      A,(LINLEN)
        CP      1AH
        JR      NC,J$46CB
        LD      A,1AH
        LD      (LINLEN),A
J$46CB: CP      (HL)
        JR      C,J$46D2
        LD      A,(HL)
        LD      (LINLEN),A
J$46D2: LD      B,A
        LD      A,(D.FCAF)
        CP      02H     ; 2 
        LD      A,B
        JR      NC,C.46DE
        LD      (IX+6),A
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.46DE: INC     HL
        LD      A,(HL)
        LD      (CRTCNT),A
        LD      A,(IDBYT2)
        AND     A                       ; MSX1 ?
        JR      Z,J.472B                ; yep,
        LD      A,(D.FCAF)
        CP      02H     ; 2 
        JR      C,J$46F7
        LD      A,(NORUSE)
        BIT     7,A
        JR      Z,J.472B
J$46F7: LD      A,(IX+0)
        AND     07H     ; 7 
        CP      04H     ; 4 
        LD      A,(RG2SAV)
        JR      C,J.4718
        BIT     7,(IX+0)
        JR      Z,J.4718
        OR      20H     ; " "
        LD      B,A
        LD      C,02H   ; 2 
        CALL    WRTVDP
        LD      A,(D.FFE8)
        OR      0CH     ; 12 
        JR      J$4725
J.4718: AND     0DFH
        LD      B,A
        LD      C,02H   ; 2 
        CALL    WRTVDP
        LD      A,(D.FFE8)
        AND     0F3H
J$4725: LD      B,A
        LD      C,09H   ; 9 
        CALL    WRTVDP
J.472B: LD      A,(RG7SAV)
J$472E: AND     0F0H
        LD      HL,BAKCLR
        OR      (HL)
        LD      B,A
        LD      C,07H   ; 7 
        LD      A,(D.FCAF)
        CP      02H     ; 2 
        CALL    C,WRTVDP
        LD      HL,0101H
        LD      (CSRY),HL
J$4743  EQU     $-2
        POP     BC
        POP     DE
        LD      A,(D.FCAF)
        CP      02H     ; 2 
        JR      NC,J.4759
        POP     HL
        POP     AF
        PUSH    AF
        PUSH    HL
        CP      0CH     ; 12 
        LD      A,0CH   ; 12 
        CALL    NZ,C.47B7
J.4759: POP     HL
        POP     AF
        RET
I$475C: DEFB    0,0
        JR      NZ,J$476C
        EX      AF,AF'
        INC     BC
        JR      NZ,J$4770
        JR      NZ,J$4773
        LD      B,B
        DEC     C
        LD      B,B
        DEC     C
        JR      NZ,J$4779
J$476C: DEFB    0,0
        JR      Z,J$477C
J$4770: LD      A,(BC)
        INC     BC
        JR      Z,J$4780
J$4773  EQU     $-1
        JR      Z,J$4783
        LD      D,B
        DEC     C
        LD      D,B
J$4779: DEC     C
        JR      Z,J$4789
J$477C: DEFB    0,0
        JR      NZ,J$478C
J$4780: EX      AF,AF'
        INC     BC
        JR      NZ,J$4790
J$4783  EQU     $-1
        JR      NZ,J$479E
        LD      B,B
        JR      J$47C9
J$4789: JR      J$47AB
?.478B: JR      J$478D
J$478C  EQU     $-1
J$478D: NOP
        JR      Z,J$479C
J$4790: LD      A,(BC)
        INC     BC
        JR      Z,J$47A0
        JR      Z,J$47AE
        LD      D,B
        JR      J$47E9

?.4799: JR      J.47C3
?.479B: JR      J$47D7
J$479C  EQU     $-1
?.479D: XOR     A
J$479E: CALL    M,C$02FE
J$47A0  EQU     $-1
        JR      NC,J.47B3
        CALL    C.41F9                  ; get KANJI workspace
        BIT     5,(IX+1)
        JR      Z,J.47B3
J$47AB  EQU     $-1
        LD      A,0CH   ; 12 
J$47AE: CALL    C.45EA
        JR      C.47B7
J.47B3: XOR     A
        JP      CLS

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.47B7: PUSH    HL
        PUSH    DE
        PUSH    BC
        PUSH    AF
        CALL    C$47D2
        POP     AF
        POP     BC
        POP     DE
        POP     HL
        RET

;         Subroutine CHPUT handler
;            Inputs  ________________________
;            Outputs ________________________

J.47C3: EI
        CALL    C.41F9                  ; get KANJI workspace
        CALL    C.45EA
J$47C9  EQU     $-1
        LD      C,A
        LD      DE,I$0D0C
        CALL    C.4599
        LD      A,C
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$47D2: PUSH    AF
        CALL    C.4918
        POP     AF
J$47D7: CALL    C.47E5
        CALL    C.4901
        LD      A,(CSRX)
        DEC     A
        LD      (TTYPOS),A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.47E5: LD      C,A
        LD      HL,D.FCA7
J$47E9: LD      A,(HL)
        AND     A
        JP      NZ,J$48AF
        LD      A,C
        CP      20H     ; " "
        JR      C,J$4830
        LD      HL,(CSRY)
        CP      7FH
        JP      Z,J$4A66
        BIT     7,(IX+2)
        JR      NZ,J$4814
        CALL    C.4982
        JR      C,J$4817
        LD      A,(LINLEN)
        CP      H
        PUSH    BC
        LD      A,0FFH
        CALL    Z,C.47E5
        POP     BC
        JP      C.4D13
J$4814: CALL    C.499D
J$4817: CALL    C.4D13
        CALL    C.499D
        RET     NZ
        XOR     A
        CALL    C$4CE7
        LD      H,01H   ; 1 
        CALL    C.49CE
        RET     NZ
        CALL    C.49D6
        LD      L,01H   ; 1 
        JP      C.49F5
J$4830: LD      (IX+2),00H
        LD      HL,C.484D
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$4837: LD      C,0CH   ; 12 
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4839: INC     HL
        INC     HL
        AND     A
        DEC     C
        RET     M
        CP      (HL)
        INC     HL
        JR      NZ,C.4839
        LD      C,(HL)
        INC     HL
        LD      B,(HL)
        LD      HL,(CSRY)
        CALL    C.484D
J$4849  EQU     $-2
        XOR     A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.484D: PUSH    BC
        RET
?.484F: RLCA
        RET     NZ
        NOP
        EX      AF,AF'
        AND     L
        LD      C,C
        ADD     HL,BC
        SBC     A,49H   ; "I"
        LD      A,(BC)
        INC     H
        LD      C,B
        DEC     BC
        CALL    PE,C$0C49
        RLCA
        LD      C,E
        DEC     C
        XOR     49H     ; "I"
        DEC     DE
        XOR     C
        LD      C,B
        INC     E
        RET     Z
        LD      C,C
        DEC     E
        AND     L
        LD      C,C
        LD      E,0C4H
        LD      C,C
        RRA
I$4871: ADC     A,49H   ; "I"
        LD      L,D
        RLCA
        LD      C,E
        LD      B,L
        RLCA
        LD      C,E
        LD      C,E
        LD      (HL),L
        LD      C,D
        LD      C,D
        RST     08H
        LD      C,D
        LD      L,H
        LD      (HL),E
        LD      C,D
        LD      C,H
        INC     L
        LD      C,D
        LD      C,L
        JP      P,J$5949
        AND     (HL)
        LD      C,B
        LD      B,C
        CALL    NZ,C$4249
        ADC     A,49H   ; "I"
        LD      B,E
        SBC     A,L
        LD      C,C
        LD      B,H
        JP      NZ,J$4849
        CALL    PE,C$7849
        AND     B
        LD      C,B
        LD      A,C
        AND     E
        LD      C,B
        LD      A,01H   ; 1 
        LD      BC,I$023E
        LD      BC,I$043E
        LD      BC,I$FF3E
        LD      (D.FCA7),A
        RET
J$48AF: JP      P,J$48BD
        LD      (HL),00H
        LD      A,C
        LD      HL,I$4871
C$48B7  EQU     $-1
        LD      C,0FH   ; 15 
        JP      C.4839
J$48BD: DEC     A
        JR      Z,J$48DE
        DEC     A
        JR      Z,J$48E8
        DEC     A
        LD      (HL),A
        LD      A,(LINLEN)
        LD      DE,CSRX
        JR      Z,J$48D3
        LD      (HL),03H        ; 3 
        CALL    C.4CEE
        DEC     DE
J$48D3: LD      B,A
        LD      A,C
        SUB     20H     ; " "
        CP      B
        INC     A
        LD      (DE),A
        RET     C
        LD      A,B
        LD      (DE),A
J$48DD: RET
J$48DE: LD      (HL),A
        LD      A,C
        SUB     34H     ; "4"
        JR      Z,J$48EF
        DEC     A
        JR      Z,J$48F6
        RET
J$48E8: LD      (HL),A
        LD      A,C
        SUB     34H     ; "4"
        JR      NZ,J$48F3
        INC     A
J$48EF: LD      (D.FCAA),A
        RET
J$48F3: DEC     A
        RET     NZ
        INC     A
J$48F6: LD      (D.FCA9),A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$48FA: LD      A,(D.FCA9)
        AND     A
        RET     NZ
        JR      J.4926
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4901: LD      A,(D.FCA9)
        AND     A
        RET     Z
        JR      J.4926

;         Subroutine display cursor handler
;            Inputs  ________________________
;            Outputs ________________________

J$4908: EI
        CALL    C.4583
        CALL    C.41F9                  ; get KANJI workspace
        JR      J.4926

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C$4911: LD      A,(D.FCA9)
        AND     A
        RET     NZ
        JR      J.4926
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4918: LD      A,(D.FCA9)
        AND     A
        RET     Z
        JR      J.4926

;         Subroutine erase cursor handler
;            Inputs  ________________________
;            Outputs ________________________

J$491F: EI
        CALL    C.4583
        CALL    C.41F9                  ; get KANJI workspace
J.4926: CALL    C$4946
        RET     NC
I$492A: LD      A,(D.FCAA)
        AND     A
        LD      E,00H
        JR      Z,C.4934
        LD      E,01H   ; 1 
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4934: PUSH    DE
        CALL    C.4954
        CP      01H     ; 1 
        JR      NZ,J$493D
        XOR     A
J$493D: POP     DE
        OR      E
        LD      E,A
        LD      HL,(CSRY)
        JP      C.5CED
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$4946: LD      A,(D.FCAF)
        CP      02H     ; 2 
        RET     C
        LD      A,(NORUSE)
        BIT     7,A
        RET     Z
        SCF
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4954: LD      HL,(CSRY)
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4957: PUSH    HL
        LD      H,01H   ; 1 
        CALL    C.4CF8
        POP     AF
        LD      L,A
J.495F: LD      A,L
        CP      H
        JR      Z,J$4979
        LD      A,01H   ; 1 
        RET     C
        LD      A,C
        CALL    C.4982
        LD      A,(VDP.DR)
        LD      C,A
        IN      C,(C)
        INC     H
        JR      C,J.495F
        LD      C,A
        IN      C,(C)
        INC     H
        JR      J.495F
J$4979: LD      A,C
        CALL    C.4982
        LD      A,02H   ; 2 
        RET     NC
        XOR     A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4982: CP      81H
        RET     C
        CP      0A0H
        CCF
        RET     NC
        CP      0E0H
        RET     C
        CP      0FDH
        CCF
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4990: CP      40H     ; "@"
        RET     C
        CP      0FDH
        CCF
        RET     C
        CP      7FH
        SCF
        RET     Z
        AND     A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.499D: LD      A,(LINLEN)
        CP      H
        RET     Z
        INC     H
        JR      C.49D6
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.49A5: CALL    C.49C2
        RET     NZ
        LD      A,(LINLEN)
        LD      H,A
        DEC     L
        RET     Z
        CALL    C.4CF8
        INC     A
        JR      NZ,C.49D6
        DEC     H
        JR      C.49D6
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$49B8: CALL    C.49C2
        RET     NZ
        LD      A,(LINLEN)
        LD      H,A
        JR      J.49C4
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.49C2: DEC     H
        LD      A,2DH   ; "-"
J.49C4  EQU     $-1
        RET     Z
        JR      C.49D6
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.49C8: CALL    C.499D
        RET     NZ
        LD      H,01H   ; 1 
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.49CE: CALL    C.4CEE
        CP      L
        RET     Z
        JR      C,J$49DA
        INC     L
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.49D6: LD      (CSRY),HL
        RET
J$49DA: DEC     L
        XOR     A
        JR      C.49D6
J$49DE: LD      A,20H   ; " "
        CALL    C.47E5
        LD      A,(CSRX)
        DEC     A
        AND     07H     ; 7 
        JR      NZ,J$49DE
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$49EC: LD      L,01H   ; 1 
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.49EE: LD      H,01H   ; 1 
        JR      C.49D6
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.49F2: CALL    C.49EE
;
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.49F5: CALL    C.4CEE
        SUB     L
        RET     C
        JP      Z,C.4A73
        PUSH    HL
        PUSH    AF
        LD      C,A
        LD      B,00H
        CALL    C.4CD9
        LD      L,E
        LD      H,D
        INC     HL
        LDIR
        LD      HL,FSTPOS
        DEC     (HL)
        POP     AF
        POP     HL
        CALL    C$5DED
J$4A13: PUSH    AF
        INC     L
        CALL    C.4BCE
        DEC     L
        CALL    C.4C1D
        INC     L
        CALL    C.4BDC
        DEC     L
        CALL    C.4C2B
        INC     L
        POP     AF
        DEC     A
        JR      NZ,J$4A13
        JP      C.4A73
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$4A2C: CALL    C.49EE
;
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$4A2F: CALL    C.4CEE
        LD      H,A
        SUB     L
        RET     C
        JP      Z,C.4A73
        LD      L,H
        PUSH    HL
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$4A3A: PUSH    AF
        LD      C,A
        LD      B,00H
        CALL    C.4CD9
        LD      L,E
        LD      H,D
        PUSH    HL
        DEC     HL
        LDDR
        POP     HL
        LD      (HL),H
        POP     AF
        POP     HL
        CALL    C$5F2C
J$4A4E: PUSH    AF
        DEC     L
        CALL    C.4BCE
        INC     L
        CALL    C.4C1D
        DEC     L
        CALL    C.4BDC
        INC     L
        CALL    C.4C2B
        DEC     L
        POP     AF
        DEC     A
        JR      NZ,J$4A4E
        JR      C.4A73
J$4A66: LD      (IX+2),00H
        CALL    C.49A5
C$4A6C  EQU     $-1
        RET     Z
        LD      C,20H   ; " "
        JP      C.4D13
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4A73: LD      H,01H   ; 1 
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4A75: CALL    C.4A7E
        PUSH    HL
        CALL    C.600F
        POP     HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4A7E: CALL    C.4CE5
        PUSH    HL
        CALL    C.4C6E
        POP     DE
        PUSH    DE
        LD      A,(LINLEN)
        SUB     D
        INC     A
        LD      C,A
        LD      B,00H
        LD      A,(IDBYT2)
        AND     A                       ; MSX1 ?
        LD      A,20H   ; " "
        PUSH    AF
        CALL    Z,FILVRM                ; yep,
        POP     AF
        CALL    NZ,C$4A9F               ; nope,
        POP     HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$4A9F: LD      E,A
        LD      A,L
        NEG
        JR      Z,C.4AB3
        CP      C
        JR      NC,C.4AB3
        PUSH    HL
        PUSH    BC
        LD      C,A
        CALL    C.4AB3
        POP     BC
        POP     HL
        CALL    C.4ABE
;
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4AB3: PUSH    BC
        CALL    C.4D3A
        POP     HL
        LD      B,L
J$4AB9: OUT     (C),E
        DJNZ    J$4AB9
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4ABE: LD      A,C
        ADD     A,L
        LD      C,A
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$4AC1: LD      L,00H
        INC     H
        LD      A,(IX+0)
        AND     07H     ; 7 
        CP      06H     ; 6 
        RET     NC
        RES     7,H
        RET
J$4ACF: PUSH    HL
        CALL    C.4A75
        POP     HL
        CALL    C.4CEE
        CP      L
        RET     C
        RET     Z
        LD      H,01H   ; 1 
        INC     L
        JR      J$4ACF
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$4ADF: LD      HL,0101H
        LD      (CSRY),HL
J$4AE5: CALL    C.4A7E
        CALL    C.4CEE
        CP      L
        RET     C
        RET     Z
        LD      H,01H   ; 1 
        INC     L
        JR      J$4AE5

;         Subroutine erase function keys handler
;            Inputs  ________________________
;            Outputs ________________________

J$4AF3: EI
        CALL    C.4583
        CALL    C.41F9                  ; get KANJI workspace
        XOR     A
        LD      (CNSDFG),A
        PUSH    HL
        LD      HL,(CRTCNT)
        CALL    C.4A73
        POP     HL
        RET
?.4B07: CALL    C$611A
        CALL    C$6ABF
        CALL    C$4ADF
;
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$4B10: LD      A,CNSDFG)
        AND     A
        RET     Z
        JR      J$4B1B

;         Subroutine display function keys handler
;            Inputs  ________________________
;            Outputs ________________________

J$4B17: EI
        CALL    C.4583
J$4B1B: CALL    C.41F9                  ; get KANJI workspace
        CALL    C.7E50
        AND     A
        BIT     0,(IY+8)
        CALL    NZ,C.6B7B
        RET     C
        LD      A,0FFH
        LD      (CNSDFG),A
        PUSH    HL
        LD      A,(CSRY)
        LD      HL,CRTCNT
        CP      (HL)
        LD      A,0AH   ; 10 
        CALL    Z,C.47B7
        LD      A,(NEWKEY+6)
        RRCA
        LD      DE,FNKSTR+5*16
        LD      A,00H
        JR      NC,J$4B4B
        LD      DE,FNKSTR
        INC     A
J$4B4B: LD      (FNKSWI),A
        LD      HL,(CRTCNT)
        LD      H,01H   ; 1 
        JR      NC,J.4B60
        CALL    C.7E50
J$4B56  EQU     $-2
        JR      Z,J.4B60                ; No MSX-JE,
        BIT     0,(IY+8)
        JR      NZ,J.4BB7
J.4B60: LD      A,(LINLEN)
        SUB     04H     ; 4 
        JR      C,J.4BB7
        LD      B,0FFH
J$4B69: SUB     05H     ; 5 
        INC     B
        JR      NC,J$4B69
        JR      Z,J.4BB7
        LD      C,05H   ; 5 
J$4B72: PUSH    BC
        LD      C,0FH   ; 15 
J.4B75: LD      A,(DE)
        AND     A
        JR      Z,J.4B98
        CP      21H     ; "!"
        JR      C,J.4B9F
        CALL    C.4982
        JR      C,J.4BA1
        LD      A,B
        DEC     A
        JR      Z,J.4B9F
        INC     DE
        LD      A,(DE)
        DEC     DE
        CALL    C.4990
        JR      C,J$4BBC
        LD      A,(DE)
        CALL    C.4BC6
        INC     DE
        DEC     C
        DEC     B
        LD      A,(DE)
        JR      J.4BA1
J.4B98: CALL    C.4BC4
        DJNZ    J.4B98
        JR      J$4BA8
J.4B9F: LD      A,20H   ; " "
J.4BA1: CALL    C.4BC6
        INC     DE
        DEC     C
        DJNZ    J.4B75
J$4BA8: EX      (SP),HL
        LD      A,L
        EX      (SP),HL
        DEC     A
        CALL    NZ,C.4BC4
        INC     DE
        EX      DE,HL
        ADD     HL,BC
        EX      DE,HL
J$4BB3: POP     BC
        DEC     C
        JR      NZ,J$4B72
J.4BB7: CALL    C.600F
        POP     HL
        RET
J$4BBC: CALL    C.4BC4
        INC     DE
        DEC     C
        DEC     B
        JR      J.4B9F
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4BC4: LD      A,20H   ; " "
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4BC6: PUSH    BC
        LD      C,A
        CALL    C.58DC
        POP     BC
        INC     H
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4BCE: PUSH    HL
        LD      H,01H   ; 1 
        LD      A,(LINLEN)
        CP      29H     ; ")"
        JR      C,J.4BE7
        LD      A,28H   ; "("
        JR      J.4BE7
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4BDC: LD      A,(LINLEN)
        CP      29H     ; ")"
        RET     C
        PUSH    HL
        LD      H,29H   ; ")"
        SUB     28H     ; "("
J.4BE7: CALL    C$4BEC
        POP     HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$4BEC: LD      C,A
        CALL    C.4C6E
        LD      B,00H
        LD      DE,LINWRK
        LD      A,(IDBYT2)
        AND     A                       ; MSX1 ?
        JP      Z,LDIRMV                ; yep,
        LD      A,L
        NEG
        JR      Z,C.4C0F
        CP      C
        JR      NC,C.4C0F
        PUSH    HL
        PUSH    BC
        LD      C,A
        CALL    C.4C0F
        POP     BC
        POP     HL
        CALL    C.4ABE
;
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4C0F: PUSH    BC
        CALL    C.4D31
        POP     HL
        LD      B,L
        EX      DE,HL
J$4C16: INI
        JP      NZ,J$4C16
        EX      DE,HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4C1D: PUSH    HL
        LD      H,01H   ; 1 
        LD      A,(LINLEN)
        CP      29H     ; ")"
        JR      C,J.4C36
        LD      A,28H   ; "("
J$4C29: JR      J.4C36
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4C2B: LD      A,(LINLEN)
        CP      29H     ; ")"
        RET     C
        PUSH    HL
        LD      H,29H   ; ")"
        SUB     28H     ; "("
J.4C36: CALL    C$4C3B
        POP     HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$4C3B: LD      C,A
        CALL    C.4C6E
        EX      DE,HL
        LD      B,00H
        LD      HL,LINWRK
        LD      A,(IDBYT2)
        AND     A                       ; MSX1 ?
        JP      Z,LDIRVM                ; yep,
        EX      DE,HL
        LD      A,L
        NEG
        JR      Z,C.4C60
        CP      C
        JR      NC,C.4C60
        PUSH    HL
        PUSH    BC
        LD      C,A
        CALL    C.4C60
        POP     BC
        POP     HL
        CALL    C.4ABE
;
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4C60: PUSH    BC
        CALL    C.4D3A
I$4C64: POP     HL
        LD      B,L
        EX      DE,HL
J$4C67: OUTI
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$4C69: JP      NZ,J$4C67
        EX      DE,HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4C6E: PUSH    BC
        LD      E,H
        LD      D,00H
        DEC     E
        LD      H,D
        DEC     L
        LD      A,L
        ADD     A,A
        ADD     A,A
        ADD     A,A
        LD      L,A
        LD      A,(IX+0)
        AND     07H     ; 7 
        CP      02H     ; 2 
        LD      BC,I$0B00
        JR      Z,J$4CC3
        LD      C,L
        LD      B,H
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,BC
        LD      BC,I$1E20
        DEC     A
        JR      Z,J.4CC4
        SUB     02H     ; 2 
        JR      Z,J$4CC8
        DEC     A
        LD      BC,J.6A00
        JR      Z,J.4CA9
        CP      03H     ; 3 
        LD      BC,I$D400
        JR      Z,J.4CA9
        ADD     HL,HL
        DEC     A
        JR      NZ,J.4CA9
        LD      BC,J.6A00
J.4CA9: ADD     HL,DE
        ADD     HL,BC
        LD      A,(D.FFF6)
        LD      C,00H
        LD      B,A
        LD      A,(IX+0)
        AND     07H     ; 7 
        CP      06H     ; 6 
        JR      NC,J$4CC5
        SRL     B
        RR      C
        ADD     HL,BC
        RES     7,H
        POP     BC
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$4CC2: RET
J$4CC3: ADD     HL,HL
J.4CC4: ADD     HL,DE
J$4CC5: ADD     HL,BC
        POP     BC
        RET
J$4CC8: LD      A,H
        AND     A
        LD      BC,I$1E08
        JR      NZ,J.4CC4
        LD      A,L
        CP      78H     ; "x"
        JR      NC,J.4CC4
        LD      BC,I$1B00
        JR      J.4CC4
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4CD9: PUSH    HL
        LD      DE,LINTTB-1
        LD      H,0
J$4CDE  EQU     $-1
        ADD     HL,DE
        LD      A,(HL)
        EX      DE,HL
        POP     HL
        AND     A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4CE5: LD      A,0AFH
C$4CE6  EQU     $-1
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$4CE7: PUSH    AF
        CALL    C.4CD9
        POP     AF
        LD      (DE),A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4CEE: LD      A,(CNSDFG)
        PUSH    HL
        LD      HL,CRTCNT
        ADD     A,(HL)
        POP     HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4CF8: PUSH    DE
        PUSH    HL
        CALL    C.4C6E
        LD      A,(IDBYT2)
        AND     A                       ; MSX1 ?
        JR      Z,J$4D0C                ; yep,
        CALL    C.4D31
        IN      A,(C)
        LD      C,A
        POP     HL
        POP     DE
        RET
J$4D0C: CALL    RDVRM
        LD      C,A
        POP     HL
        POP     DE
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4D13: PUSH    DE
        PUSH    HL
        CALL    C.4C6E
        LD      A,(IDBYT2)
        AND     A                       ; MSX1 ?
        JR      Z,J$4D27                ; yep,
        LD      B,C
        CALL    C.4D3A
        OUT     (C),B
        LD      C,B
        JR      J$4D2B
J$4D27: LD      A,C
        CALL    WRTVRM
J$4D2B: POP     HL
        CALL    C.58DC
        POP     DE
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4D31: LD      A,(VDP.DR)
        LD      C,A
        LD      A,H
        RES     6,H
        JR      J$4D41
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4D3A: LD      A,(VDP.DR)
        LD      C,A
        LD      A,H
        SET     6,H
J$4D41: RES     7,H
        RLCA
        RLCA
        AND     03H     ; 3 
        INC     C
        DI
        OUT     (C),A
        LD      A,8EH
        OUT     (C),A
        OUT     (C),L
        EI
        OUT     (C),H
        DEC     C
        RET

;         Subroutine PINLIN handler
;            Inputs  ________________________
;            Outputs ________________________

J$4D56: EI
        CALL    C.4583
        CALL    C.41F9                  ; get KANJI workspace
        LD      A,0FFH
        LD      (DECCNT),A
        LD      A,(AUTFLG)
        AND     A
        JR      NZ,J$4D77
        LD      L,00H
        JR      J$4D7F

;         Subroutine INLIN handler
;            Inputs  ________________________
;            Outputs ________________________

J$4D6C: EI
        CALL    C.4583
        CALL    C.41F9                  ; get KANJI workspace
        XOR     A
        LD      (DECCNT),A
J$4D77: LD      HL,(CSRY)
        DEC     L
        CALL    NZ,C.4CE5
        INC     L
J$4D7F: LD      (FSTPOS),HL
        XOR     A
        LD      (D.FC9B),A
J$4D86: CALL    C.4D9E
        LD      HL,I$4E82
        LD      C,0EH   ; 14 
        CALL    C.4839
        PUSH    AF
        CALL    NZ,C.4DB1
        POP     AF
        JR      NC,J$4D86
        LD      HL,BUFMIN
        RET     Z
        CCF
        RET

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.4D9E: LD      A,(D.FCAF)
        PUSH    AF
        XOR     A
        LD      (D.FCAF),A
        CALL    C$45BB
        POP     BC
        PUSH    AF
        LD      A,B
        LD      (D.FCAF),A
        POP     AF
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4DB1: PUSH    AF
        CP      09H     ; 9 
        JR      NZ,J$4DC5
J$4DB6: POP     AF
J$4DB7: LD      A,20H   ; " "
        CALL    C.4DB1
        LD      A,(CSRX)
        DEC     A
        AND     07H     ; 7 
        JR      NZ,J$4DB7
        RET
J$4DC5: POP     AF
        LD      HL,D.FCA8
        CP      20H     ; " "
        JP      C,J$4E71
        INC     (HL)
        DEC     (HL)
        JR      Z,J$4E05
        CALL    C.4982
        JR      C,J$4DF4
        PUSH    AF
        CALL    C.4D9E
        PUSH    AF
        CALL    C.4954
        DEC     A
        JR      NZ,J$4DE7
        LD      A,1DH
        CALL    C.47B7
J$4DE7: CALL    C$4F6B
        POP     HL
        EX      (SP),HL
        LD      A,H
        CALL    C.47B7
        POP     AF
        JP      C.47B7
J$4DF4: PUSH    AF
        CALL    C.4954
        DEC     A
        LD      A,1DH
        CALL    Z,C.47B7
        CALL    C$4F84
        POP     AF
        JP      C.47B7
J$4E05: CALL    C.4982
        JR      C,J$4E4F
        PUSH    AF
        CALL    C.4D9E
        POP     DE
        LD      E,A
        LD      HL,(CSRY)
        LD      A,(LINLEN)
        INC     H
        INC     A
        CP      H
        JR      NZ,J$4E24
        CALL    C.4CEE
        CP      L
        JR      Z,C.4E39
        INC     L
        LD      H,02H   ; 2 
J$4E24: CALL    C.4957
J$4E27: CP      02H     ; 2 
        PUSH    AF
        CALL    C.4E39
C$4E2B  EQU     $-2
        POP     AF
        RET     NZ
        LD      A,20H   ; " "
        CALL    C.47B7
        LD      A,1DH
        JP      C.47B7
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4E39: CALL    C.4954
        DEC     A
        LD      A,1DH
        CALL    Z,C.47B7
        LD      A,20H   ; " "
        CALL    Z,C.47B7
        LD      A,D
        CALL    C.47B7
        LD      A,E
        JP      C.47B7
J$4E4F: LD      D,A
        CALL    C.4954
        PUSH    AF
        DEC     A
        LD      A,1DH
        CALL    Z,C.47B7
        LD      A,20H   ; " "
        CALL    Z,C.47B7
        LD      A,D
        CALL    C.47B7
J$4E61  EQU     $-2
        POP     AF
        CP      02H     ; 2 
        RET     NZ
        LD      A,20H   ; " "
        CALL    C.47B7
        LD      A,1DH
        JP      C.47B7
J$4E71: LD      (HL),00H
        CALL    C.47B7
        LD      A,3EH   ; ">"
J$4E77  EQU     $-1
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.4E78: XOR     A
        PUSH    AF
        CALL    C.4918
        POP     AF
        LD      (D.FCAA),A
        JP      C.4901
I$4E82  EQU     $-2
?.4E84: EX      AF,AF'
        CCF
        LD      D,B
        LD      (DE),A
        LD      E,(HL)
        LD      C,A
        DEC     DE
        ADC     A,E
        DI
        LD      (BC),A
        AND     (HL)
        LD      D,C
        LD      B,90H
        LD      D,C
        LD      C,6FH   ; "o"
        LD      D,C
        DEC     B
        LD      B,(HL)
        LD      D,C
        INC     BC
        LD      HL,(D$0D4F)
        XOR     (HL)
        LD      C,(HL)
        DEC     D
        DEC     SP
        LD      D,C
        LD      A,A
        LD      L,H
        LD      D,B
        DEC     E
        INC     L
        LD      D,D
        LD      E,0C0H
        LD      D,D
        RRA
        DEC     (HL)
        LD      D,D
        CALL    C.5218
        LD      A,(AUTFLG)
        AND     A
        JR      Z,J$4EB9
        LD      H,01H   ; 1 
J$4EB9: PUSH    HL
        CALL    C.4918
        POP     HL
        LD      DE,BUF
        LD      B,0FEH
        DEC     L
J$4EC4: INC     L
J$4EC5: PUSH    BC
        CALL    C.4CF8
        POP     BC
        AND     A
        JR      Z,J.4EDC
        CP      0FFH
        JR      Z,J.4EDC
        CP      20H     ; " "
        JR      NC,J$4ED7
        ADD     A,40H   ; "@"
J$4ED7: LD      (DE),A
        INC     DE
        DEC     B
        JR      Z,J.4EEC
J.4EDC: INC     H
        LD      A,(LINLEN)
        CP      H
        JR      NC,J$4EC5
        PUSH    DE
        CALL    C.4CD9
        POP     DE
        LD      H,01H   ; 1 
        JR      Z,J$4EC4
J.4EEC: DEC     DE
        LD      A,(DE)
        CP      20H     ; " "
        JR      Z,J.4EEC
        PUSH    HL
        PUSH    DE
        CALL    C.4901
        POP     DE
        POP     HL
        INC     DE
        XOR     A
        LD      (DE),A
J.4EFC: LD      A,0DH   ; 13 
        AND     A
J$4EFF: PUSH    AF
        CALL    C.4CE5
        CALL    C$4F13
        LD      A,0AH   ; 10 
        CALL    C.47B7
        XOR     A
        LD      (D.FCA8),A
        POP     AF
        SCF
        POP     HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$4F13: LD      A,1BH
        CALL    C.47B7
        LD      A,59H   ; "Y"
        CALL    C.47B7
        LD      A,L
        ADD     A,1FH
        CALL    C.47B7
        LD      A,H
        ADD     A,1FH
        JP      C.47B7
J$4F29: INC     L
        CALL    C.4CD9
        JR      Z,J$4F29
        CALL    C.4E78
        XOR     A
        LD      (BUF+0),A
        LD      H,01H   ; 1 
        PUSH    HL
        CALL    GICINI
        CALL    C$4F4A
        POP     HL
        JR      C,J.4EFC
C$4F41  EQU     $-1
        LD      A,(BASROM)
        AND     A
        JR      NZ,J.4EFC
        JR      J$4EFF
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$4F4A: LD      A,(D$FC6A)
        RRCA
        RET     NC
        LD      HL,(D$FC6B)
        LD      A,H
        OR      L
        RET     Z
        LD      HL,(CURLIN)
        INC     HL
        LD      A,H
        OR      L
        RET     Z
        SCF
        RET
?.4F5E: LD      HL,D.FCA8
        LD      A,(HL)
        XOR     0FFH
        LD      (HL),A
        JP      Z,C.4E78
        JP      J$4E77
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$4F6B: CALL    C.4918
        CALL    C.500B
        LD      C,20H   ; " "
        CALL    C.5015
        LD      A,(CSRX)
        LD      HL,LINLEN
        CP      (HL)
        LD      C,20H   ; " "
        CALL    Z,C.5015
        JR      J$4F8A
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$4F84: CALL    C.4918
        CALL    C.500B
J$4F8A: LD      C,20H   ; " "
        CALL    C.5015
        LD      HL,(CSRY)
J$4F92: PUSH    HL
        AND     A
        PUSH    AF
J$4F95: CALL    C.4CF8
        CALL    C.5015
        CALL    C.5038
        POP     AF
        LD      A,C
        CALL    NC,C.4982
        JR      C,J$4FAE
        LD      A,LINLEN)
        CP      H
        LD      C,0FFH
        JR      Z,J$4FB1
        AND     A
J$4FAE: CALL    C$5027
J$4FB1: CCF
        PUSH    AF
        CALL    C.4D13
        LD      A,(LINLEN)
        INC     H
        CP      H
        JR      NC,J$4F95
        POP     AF
        LD      HL,(BUF+2)
        LD      A,(BUF+0)
        CP      L
        POP     HL
        JP      Z,C.4901
        CALL    C.4CD9
        JR      Z,J$5006
        CALL    C.5038
        LD      A,C
        CP      20H     ; " "
        PUSH    AF
        JR      NZ,J.4FE1
        LD      A,(LINLEN)
        CP      H
        JR      Z,J.4FE1
        POP     AF
        JP      C.4901
J.4FE1: CALL    C$4CE6
        INC     L
        PUSH    HL
        CALL    C.4CEE
        CP      L
        JR      C,J$4FF1
        CALL    C$4A2F
        JR      J$5000
J$4FF1: LD      HL,CSRY
        DEC     (HL)
        JR      NZ,J$4FF8
        INC     (HL)
J$4FF8: LD      L,01H   ; 1 
        CALL    C.49F5
        POP     HL
        DEC     L
        PUSH    HL
J$5000: POP     HL
        POP     AF
        JP      Z,C.4901
        DEC     L
J$5006: INC     L
        LD      H,01H   ; 1 
        JR      J$4F92
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.500B: LD      HL,BUF+162
        LD      (BUF+0),HL
        LD      (BUF+2),HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.5015: LD      A,C
        INC     A
        RET     Z
        PUSH    HL
        LD      HL,(BUF+0)
        LD      (HL),C
        INC     HL
        LD      A,L
        AND     1FH
        LD      L,A
        LD      (BUF+0),HL
        POP     HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$5027: PUSH    HL
        PUSH    AF
        LD      HL,(BUF+2)
        LD      C,(HL)
        INC     HL
        LD      A,L
        AND     1FH
        LD      L,A
        LD      (BUF+2),HL
        POP     AF
        POP     HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.5038: PUSH    HL
        LD      HL,(BUF+2)
        LD      C,(HL)
        POP     HL
        RET
?.503F: CALL    C.4918
        CALL    C.4954
        LD      HL,(CSRY)
        DEC     A
        JR      NZ,J$504C
        DEC     H
J$504C: DEC     L
        DEC     H
        JR      NZ,J.5066
        INC     H
        LD      A,L
        AND     A
        JR      Z,J.5066
        CALL    C.4CD9
        JR      NZ,J.5066
        LD      A,(LINLEN)
        LD      H,A
        CALL    C.4CF8
        INC     A
        JR      NZ,J$5065
        DEC     H
J$5065: DEC     L
J.5066: INC     L
        LD      (CSRY),HL
        JR      J$506F
?.506C: CALL    C.4918
J$506F: LD      HL,(CSRY)
        CALL    C.4CF8
        INC     A
        JR      NZ,J$507E
        LD      H,01H   ; 1 
        INC     L
        LD      (CSRY),HL
J$507E: CALL    C.4954
        LD      HL,(CSRY)
        CP      01H     ; 1 
        JR      NZ,J$508C
        DEC     H
        LD      (CSRY),HL
J$508C: AND     A
        LD      D,01H   ; 1 
        JR      Z,J.50C2
        INC     D
        LD      A,H
        DEC     A
        JR      NZ,J.50C2
        LD      A,L
        DEC     A
        JR      Z,J.50C2
        PUSH    HL
        DEC     L
        LD      A,(LINLEN)
        LD      H,A
        CALL    C.4CF8
        INC     A
        POP     HL
        JR      NZ,J.50C2
        LD      H,03H   ; 3 
        PUSH    HL
        CALL    C.4957
        POP     HL
        LD      H,01H   ; 1 
        AND     A
        JR      NZ,J.50C2
J$50B2  EQU     $-1
        DEC     L
        LD      A,(LINLEN)
        LD      H,A
        LD      (CSRY),HL
        DEC     D
        PUSH    HL
        INC     L
        LD      H,03H   ; 3 
        JR      J.50EF
J.50C2: LD      E,00H
J$50C4: ADD     HL,DE
        LD      A,(LINLEN)
        CP      H
        JR      C,J$50D7
        CALL    C.4CF8
        LD      A,H
        SUB     D
        LD      H,A
        CALL    C.4D13
        INC     H
        JR      J$50C4
J$50D7: PUSH    DE
        CALL    C.4CD9
        POP     DE
        JR      NZ,J$5132
C.50DD  EQU     $-1
        LD      A,C
        ADD     A,01H   ; 1 
        LD      A,D
        ADC     A,00H
        LD      D,A
        LD      A,(LINLEN)
        SUB     D
        INC     A
        LD      H,A
        PUSH    HL
        INC     L
        LD      H,01H   ; 1 
J.50EF: CALL    C.4CF8
        CALL    C.4982
        LD      A,02H   ; 2 
        SBC     A,00H
        CP      D
        JR      Z,J$50FE
        JR      NC,J$5122
J$50FE: LD      E,A
        NEG
        ADD     A,D
        LD      D,A
        DEC     E
        JR      Z,J$5110
        INC     H
        EX      (SP),HL
        CALL    C.4D13
        INC     H
        EX      (SP),HL
        CALL    C.4CF8
J$5110: INC     H
        EX      (SP),HL
        CALL    C.4D13
        INC     H
        EX      (SP),HL
        LD      A,D
        AND     A
        JR      NZ,J.50EF
        POP     AF
        LD      D,H
        DEC     D
        LD      H,01H   ; 1 
        JR      J.50C2
J$5122: EX      (SP),HL
        LD      C,0FFH
        CALL    C.4D13
        POP     HL
        LD      D,H
        DEC     D
        LD      H,01H   ; 1 
        JR      NZ,J.50C2
        JP      C.4901
J$5132: LD      A,H
        SUB     D
        LD      H,A
        CALL    C.4A75
        JP      C.4901
?.513B: CALL    C.4918
        CALL    C.5218
        LD      (CSRY),HL
        JR      J.5156
?.5146: CALL    C.4918
        CALL    C.4954
        DEC     A
        LD      HL,(CSRY)
        JR      NZ,J.5156
        DEC     H
        LD      (CSRY),HL
J.5156: CALL    C.4CD9
        PUSH    AF
        CALL    C.4A75
        POP     AF
        JR      NZ,J.5165
        LD      H,01H   ; 1 
        INC     L
        JR      J.5156
J.5165: CALL    C.4901
        XOR     A
        LD      (D.FCA8),A
        JP      C.4E78
?.516F: CALL    C.4918
        LD      HL,(CSRY)
        DEC     L
J$5176: INC     L
        CALL    C.4CD9
I$517A: JR      Z,J$5176
        LD      A,(LINLEN)
        LD      H,A
        INC     H
J$5181: DEC     H
        JR      Z,J$518B
        CALL    C.4CF8
        CP      20H     ; " "
        JR      Z,J$5181
J$518B: CALL    C.49C8
        JR      J.5165
?.5190: CALL    C.4918
        CALL    C.51D6
J$5196: CALL    C.51BC
        JR      Z,J.5165
        JR      C,J$5196
J$519D: CALL    C.51BC
        JR      Z,J.5165
        JR      NC,J$519D
        JR      J.5165
?.51A6: CALL    C.4918
J$51A9: CALL    C.51D6
        JR      Z,J.5165
        JR      NC,J$51A9
J$51B0: CALL    C.51D6
        JR      Z,J.5165
        JR      C,J$51B0
        CALL    C.49C8
        JR      J.5165
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.51BC: LD      HL,(CSRY)
        CALL    C.49C8
        CALL    C.4954
        DEC     A
        LD      HL,(CSRY)
        CALL    Z,C.49C8
        CALL    C.4CEE
        LD      E,A
        LD      A,(LINLEN)
        LD      D,A
        JR      J$51E9
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.51D6: LD      HL,(CSRY)
        CALL    C.49A5
        CALL    C.4954
        DEC     A
        LD      HL,(CSRY)
        CALL    Z,C.49A5
        LD      DE,0101H
J$51E9: LD      HL,(CSRY)
        RST     20H
J$51ED: RET     Z
        LD      DE,I$5214
        PUSH    DE
        CALL    C.4CF8
        CP      30H     ; "0"
        CCF
        RET     NC
        CP      3AH     ; ":"
        RET     C
        CP      41H     ; "A"
        CCF
        RET     NC
        CP      5BH     ; "["
        RET     C
        CP      61H     ; "a"
        CCF
        RET     NC
        CP      7BH     ; "{"
        RET     C
        CP      81H
        CCF
        RET     NC
        CP      0A0H
        RET     C
        CP      0A6H
        CCF
I$5214: LD      A,00H
        INC     A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.5218: DEC     L
        JR      Z,J$5220
        CALL    C.4CD9
I$521C  EQU     $-2
        JR      Z,C.5218
J$5220: INC     L
        LD      A,(FSTPOS)
        CP      L
        LD      H,01H   ; 1 
        RET     NZ
        LD      HL,(FSTPOS)
        RET
?.522C: CALL    C.4918
        CALL    C$49B8
        JP      J.5165
?.5235: CALL    C.4918
        CALL    C$523E
        JP      J.5165
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$523E: CALL    C.53E6
        JP      NC,C.49CE
        CALL    C.4CEE
        LD      HL,(CSRY)
        CP      L
        JP      NZ,C.49CE
J.524E: LD      A,L
        DEC     A
        JR      Z,J$5259
        DEC     L
        CALL    C.4CD9
        JR      Z,J.524E
        INC     L
J$5259: CALL    C.536F
        JR      C,J$5264
        DEC     L
        JR      NZ,J.524E
        LD      DE,I.FFFF
J$5264: INC     DE
        LD      BC,(TXTTAB)
J$5269: LD      L,C
        LD      H,B
        LD      C,(HL)
        INC     HL
        LD      B,(HL)
        LD      A,C
        OR      B
        RET     Z
        INC     HL
        LD      A,(HL)
        SUB     E
        INC     HL
        LD      A,(HL)
        SBC     A,D
        JR      C,J$5269
        DEC     HL
        CALL    C.533C
        LD      HL,(CSRY)
        PUSH    HL
        CALL    C.4CEE
I$5284: CP      B
        JR      C,J.5298
        JR      Z,J.5298
        LD      L,B
J$528A: CALL    C.4CD9
        JR      NZ,J.5298
        PUSH    HL
        LD      L,01H   ; 1 
        CALL    C.49F2
        POP     HL
        JR      J$528A
J.5298: LD      L,01H   ; 1 
        CALL    C.49F2
        POP     HL
        PUSH    HL
        LD      H,01H   ; 1 
        LD      (CSRY),HL
        CALL    C.52AC
        POP     HL
        LD      (CSRY),HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.52AC: LD      HL,SWPTMP
        CALL    C.52B5
        LD      HL,BUF

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.52B5: LD      A,(HL)
        AND     A
        RET     Z
        PUSH    HL
        CALL    C.47E5
        POP     HL
        INC     HL
        JR      C.52B5
?.52C0: CALL    C.4918
        CALL    C$52C9
        JP      J.5165
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$52C9: CALL    C.53E6
        JP      NC,J.49C4
        LD      A,(CSRY)
        DEC     A
        JP      NZ,J.49C4
        LD      L,00H
C$52D7  EQU     $-1
J$52D8: INC     L
        CALL    C.536F
        JR      C,J$52EF
J$52DE: CALL    C.4CEE
        CP      L
        JR      Z,J$52EC
        CALL    C.4CD9
        JR      NZ,J$52D8
        INC     L
        JR      J$52DE
J$52EC: LD      DE,I.FFFF
J$52EF: LD      BC,0
        LD      HL,(TXTTAB)
J$52F5: LD      A,(HL)
        INC     HL
        OR      (HL)
        JR      Z,J.530C
        INC     HL
        LD      A,(HL)
        SUB     E
        INC     HL
        LD      A,(HL)
        SBC     A,D
        JR      NC,J.530C
        DEC     HL
        LD      C,L
        LD      B,H
        DEC     HL
        LD      A,(HL)
        DEC     HL
        LD      L,(HL)
        LD      H,A
        JR      J$52F5
J.530C: LD      A,C
        OR      B
        RET     Z
        LD      L,C
        LD      H,B
        CALL    C.533C
        CALL    C.4CEE
        SUB     B
        JR      Z,J.5326
        JR      C,J.5326
        LD      L,A
J$531D: CALL    C.4CD9
        JR      NZ,J.5326
        INC     B
        DEC     L
        JR      NZ,J$531D
J.5326: LD      HL,(CSRY)
        PUSH    HL
        CALL    C$49EC
J$532D: PUSH    BC
        CALL    C$4A2C
        POP     BC
        DJNZ    J$532D
        CALL    C.52AC
        POP     HL
        LD      (CSRY),HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.533C: LD      E,(HL)
        INC     HL
        LD      D,(HL)
        INC     HL
        PUSH    HL
        EX      DE,HL
        CALL    C$53AA
        POP     HL
        PUSH    IX
        LD      IX,I$5284
        CALL    C.41FE
        POP     IX
        LD      HL,SWPTMP-1
        LD      C,0FEH
        XOR     A
J$5357: INC     HL
        INC     C
        CP      (HL)
        JR      NZ,J$5357
        LD      HL,BUF-1
J$535F: INC     HL
        INC     C
        CP      (HL)
        JR      NZ,J$535F
        LD      B,A
        LD      A,(LINLEN)
        LD      E,A
        LD      A,C
J$536A: INC     B
        SUB     E
        JR      NC,J$536A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.536F: LD      H,01H   ; 1 
        LD      A,(LINLEN)
        LD      B,A
J$5375: CALL    C.4CF8
        CP      20H     ; " "
        JR      NZ,J$5380
        INC     H
        DJNZ    J$5375
        RET
J$5380: SUB     30H     ; "0"
        CCF
        RET     NC
        CP      0AH     ; 10 
        RET     NC
        LD      DE,0
J$538A: CALL    C.4CF8
        CP      20H     ; " "
        JR      Z,J$53A5
        SUB     30H     ; "0"
        RET     C
        CP      0AH     ; 10 
        CCF
        RET     C
        PUSH    HL
        LD      L,E
        LD      H,D
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,DE
        ADD     HL,HL
        LD      E,A
        LD      D,00H
        ADD     HL,DE
        EX      DE,HL
        POP     HL
J$53A5: INC     H
        DJNZ    J$538A
        SCF
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$53AA: LD      DE,SWPTMP
        XOR     A
        LD      BC,I$D8F0
        CALL    C.53D2
        LD      BC,LINWRK
        CALL    C.53D2
        LD      BC,I$FF9C
        CALL    C.53D2
        LD      BC,D.FFF6
        CALL    C.53D2
        LD      A,L
        OR      30H     ; "0"
        LD      (DE),A
        INC     DE
        LD      A,20H   ; " "
        LD      (DE),A
        INC     DE
        XOR     A
        LD      (DE),A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.53D2: PUSH    AF
        LD      A,0FFH
J$53D5: INC     A
        ADD     HL,BC
        JR      C,J$53D5
        SBC     HL,BC
        POP     BC
        INC     B
        DJNZ    J$53E1
        AND     A
        RET     Z
J$53E1: OR      30H     ; "0"
        LD      (DE),A
        INC     DE
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.53E6: LD      A,(NORUSE)
        AND     40H     ; "@"
        RET     Z
        LD      A,(DECCNT)
        AND     A
        RET     Z
        LD      A,(NEWKEY+6)
        RRCA
        CCF
        RET
?.53F7: EI
        PUSH    AF
        LD      A,(H.TOTE)
        CP      0C9H
        JR      Z,J$5407
        CALL    C.541B
        LD      HL,SCNCNT
        INC     (HL)
J$5407: LD      A,(D$FD0D)
        CP      0C9H
        JR      Z,J$5419
        PUSH    AF
        POP     IY
        LD      IX,(D$FD0E)
        POP     AF
        JP      CALSLT

J$5419: POP     AF
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.541B: LD      HL,SCNCNT
        DEC     (HL)
        RET     NZ
        LD      (HL),02H        ; 2 
        LD      HL,I.FC70
        LD      A,(HL)
        LD      HL,I.FC73
        OR      (HL)
        LD      HL,I.FC76
        OR      (HL)
        LD      HL,I.FC79
        OR      (HL)
        LD      HL,I.FC7C
        OR      (HL)
        RRCA
        JR      NC,J$5482
        XOR     A
        CALL    C.5840
        AND     30H     ; "0"
        PUSH    AF
        LD      A,01H   ; 1 
        CALL    C.5840
        AND     30H     ; "0"
        RLCA
        RLCA
        POP     BC
        OR      B
        PUSH    AF
        CALL    C$57F2
        AND     01H     ; 1 
        POP     BC
        OR      B
        LD      C,A
        LD      HL,TRGFLG
        XOR     (HL)
        AND     (HL)
        LD      (HL),C
        LD      C,A
        RRCA
        LD      HL,I.FC70
        CALL    C,C.5674
        RL      C
        LD      HL,I.FC7C
        CALL    C,C.5674
        RL      C
        LD      HL,I.FC76
        CALL    C,C.5674
        RL      C
        LD      HL,I.FC79
        CALL    C,C.5674
        RL      C
        LD      HL,I.FC73
        CALL    C,C.5674
J$5482: XOR     A
        LD      (CLIKFL),A
        CALL    C$54A1
        RET     NZ
        LD      HL,REPCNT
        DEC     (HL)
        RET     NZ
        LD      (HL),01H        ; 1 
        LD      HL,OLDKEY+0
        LD      DE,OLDKEY+1
        LD      BC,11-1
        LD      (HL),0FFH
        LDIR
        JP      J.54DD
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$54A1: IN      A,(0AAH)
        AND     0F0H
        LD      C,A
        LD      B,11
        LD      HL,NEWKEY
J$54AB: LD      A,C
        OUT     (0AAH),A
        IN      A,(0A9H)
        LD      (HL),A
        INC     C
        INC     HL
        DJNZ    J$54AB
        LD      A,(ENSTOP)
        AND     A
        JR      Z,J.54C9
        LD      A,(NEWKEY+6)
        CP      0E8H
        JR      NZ,J.54C9
        LD      IX,I$409B
        JP      CALBAS
J.54C9: LD      DE,NEWKEY
        LD      B,11
J$54CE: DEC     DE
        DEC     HL
        LD      A,(DE)
        CP      (HL)
        JR      NZ,J$54D8
        DJNZ    J$54CE
        JR      J.54DD
J$54D8: LD      A,20
        LD      (REPCNT),A
J.54DD: LD      B,11
        LD      HL,OLDKEY
        LD      DE,NEWKEY
J$54E5: LD      A,(DE)
        LD      C,A
        XOR     (HL)
        AND     (HL)
        LD      (HL),C
        CALL    NZ,C$54F9
        INC     DE
        INC     HL
        DJNZ    J$54E5
        LD      HL,(GETPNT)
        LD      A,(PUTPNT)
        SUB     L
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$54F9: PUSH    HL
        PUSH    DE
        PUSH    BC
        PUSH    AF
        LD      A,0BH   ; 11 
J$54FE  EQU     $-1
        SUB     B
        ADD     A,A
        ADD     A,A
        ADD     A,A
        LD      C,A
        LD      B,08H   ; 8 
        POP     AF
J$5507: RRA
        PUSH    BC
        PUSH    AF
        CALL    C,C$559F
        POP     AF
        POP     BC
        INC     C
        DJNZ    J$5507
        POP     BC
        POP     DE
        POP     HL
        RET
I$5516: LD      A,(BC)
        RET
?.5518: LD      D,L
        LD      D,03H   ; 3 
        LD      D,(HL)
        JR      NC,J$54FE
        LD      D,L
        INC     SP
        SUB     E
        LD      D,(HL)
        INC     (HL)
        OR      C
        LD      D,(HL)
        DEC     (HL)
        RST     38H
        LD      D,A
        LD      A,(D$561D)
        INC     A
        SUB     E
        LD      D,(HL)
        DEC     A
        POP     BC
        LD      D,(HL)
        LD      B,C
        SUB     E
        LD      D,(HL)
        LD      B,D
        ADC     A,C
        LD      D,(HL)
        LD      C,B
        SUB     E
        LD      D,(HL)
        RST     38H
        AND     D
        LD      D,(HL)
I$553D: RST     38H
        LD      HL,I$2322
        INC     H
        DEC     H
        LD      H,27H   ; "'"
        JR      Z,J$5570
I$5547: RET     NC
        LD      D,(HL)
        RET     NC
        LD      D,(HL)
        PUSH    AF
        LD      D,L
        RST     30H
        LD      D,L
I$554F: LD      (HL),C
        LD      D,L
        LD      H,L
        LD      D,L
        LD      E,C
        LD      D,L
        LD      C,L
        LD      D,L
I$5557: DEC     L
        LD      E,(HL)
        LD      E,H
        LD      B,B
        LD      E,E
        DEC     SP
        LD      A,(D$2C5D)
        LD      L,2FH   ; "/"
        RST     38H
        DEC     A
        LD      A,(HL)
        LD      A,H
        LD      H,B
        LD      A,E
        DEC     HL
        LD      HL,(D$3C7D)
        LD      A,3FH   ; "?"
        LD      E,A
        DEC     L
J$5570: LD      E,1CH
        NOP
        DEC     DE
        DEC     SP
        LD      A,(D$2C1D)
        LD      L,2FH   ; "/"
        RST     38H
        DEC     A
        LD      E,1CH
        NOP
        DEC     DE
        DEC     HL
        LD      HL,(D$3C1D)
        LD      A,3FH   ; "?"
        RRA
        DEFB    0,0,0,0,0,0,0,0,0,0
        DEC     DE
        ADD     HL,BC
        NOP
        EX      AF,AF'
        JR      J$55A4
?.5597: JR      NZ,J$55A5
        LD      (DE),A
        LD      A,A
        DEC     E
        LD      E,1FH
        INC     E
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$559F: LD      A,C
        CP      0FFH
        RET     Z
        LD      HL,I$5516
J$55A4  EQU     $-2
J$55A5  EQU     $-1
        CALL    C$FDCC
        CP      30H     ; "0"
        JR      NC,J.55BE
        LD      A,(NEWKEY+6)
        RRCA
        RRCA
        JR      NC,J$55BD
        RRCA
        RET     NC
        LD      A,(D.FCAC)
        AND     A
        JP      NZ,J$56FD
J$55BD: LD      A,C
J.55BE: CP      (HL)
        INC     HL
        LD      E,(HL)
        INC     HL
        LD      D,(HL)
        INC     HL
        PUSH    DE
        RET     C
        POP     DE
        JR      J.55BE
?.55C9: ADD     A,30H   ; "0"
        LD      B,A
        LD      A,(NEWKEY+6)
        RRCA
        LD      A,B
        JR      C,C.55DD
        LD      B,00H
        LD      HL,I$553D
        ADD     HL,BC
        LD      A,(HL)
        CP      0FFH
        RET     Z
;
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.55DD: JP      C.56D0

?.55E0: LD      A,(NEWKEY+6)
        AND     03H     ; 3 
        ADD     A,A
        LD      E,A
        LD      D,00H
        LD      HL,I$5547
        ADD     HL,DE
        LD      A,(HL)
        INC     HL
        LD      H,(HL)
        LD      L,A
        LD      A,C
        SUB     15H
        JP      (HL)
?.55F5: ADD     A,20H   ; " "
        LD      B,A
        LD      A,(D.FCAB)
        CPL
        AND     20H     ; " "
        XOR     B
        ADD     A,40H   ; "@"
        JR      C.55DD
?.5603: LD      HL,I$554F
        LD      A,(NEWKEY+6)
        AND     03H     ; 3 
        ADD     A,A
        LD      E,A
        LD      D,00H
        ADD     HL,DE
        LD      A,(HL)
        INC     HL
        LD      H,(HL)
        LD      L,A
        LD      E,C
        ADD     HL,DE
        LD      A,(HL)
        CP      0FFH
        JP      NZ,C.56D0
        RET
D$561D: LD      A,(NEWKEY+6)
        RRCA
        JR      C,J$5627
        LD      A,C
        ADD     A,5
        LD      C,A
J$5627: LD      E,C
        LD      D,0
        LD      HL,I$FB99
        ADD     HL,DE
        LD      A,(HL)
        AND     A
        JR      NZ,J$5666
J$5632: EX      DE,HL
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        LD      DE,I$F52F
        ADD     HL,DE
        EX      DE,HL
        DEC     DE
J.563D: INC     DE
J$563E: LD      A,(DE)
        INC     DE
        AND     A
        RET     Z
        CALL    C.4982
        JR      C,J$565D
        LD      B,A
        LD      A,(DE)
        AND     A
        RET     Z
        CALL    C.4990
        JR      C,J.563D
        LD      A,(NORUSE)
        BIT     5,A
        JR      NZ,J.563D
        LD      A,B
        CALL    C.5662
        LD      A,(DE)
        INC     DE
J$565D: CALL    C.5662
        JR      J$563E

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.5662: CALL    C.56D0
I$5665: RET
J$5666: LD      HL,(CURLIN)
        INC     HL
        LD      A,H
        OR      L
        JR      Z,J$5632
        LD      HL,I$FBAD
        ADD     HL,DE
        ADD     HL,DE
        ADD     HL,DE

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.5674: LD      A,(HL)
        AND     01H     ; 1 
        RET     Z
        LD      A,(HL)
        OR      04H     ; 4 
        CP      (HL)
        RET     Z
        LD      (HL),A
        XOR     05H     ; 5 
        RET     NZ
        LD      A,(ONGSBF)
        INC     A
        LD      (ONGSBF),A
        RET
?.5689: LD      A,(NEWKEY+6)
        RRCA
        LD      A,0CH   ; 12 
        SBC     A,00H
        JR      C.56D0
?.5693: CALL    C$FDD1
        LD      E,A
        LD      D,00H
        LD      HL,I$5557
        ADD     HL,DE
        LD      A,(HL)
J$569E: AND     A
        RET     Z
        JR      C.56D0
?.56A2: LD      E,A
        LD      D,00H
        LD      HL,I$0DE3
        ADD     HL,DE
        LD      A,(D.FCC1)
        CALL    RDSLT
        JR      J$569E
?.56B1: LD      HL,D.FCAB
        LD      A,(HL)
        CPL
        LD      (HL),A
        CPL
        AND     A
        LD      A,0CH   ; 12 
        JR      Z,J$56BE
        INC     A
J$56BE: OUT     (0ABH),A
        RET
?.56C1: LD      A,(NEWKEY+6)
        RRCA
        RRCA
        LD      A,03H   ; 3 
        JR      NC,J$56CB
        INC     A
J$56CB: LD      (D.FC9B),A
        JR      C,C.56DE
;
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.56D0: POP     HL
        PUSH    HL
        LD      BC,I$5665
        OR      A
        SBC     HL,BC
        PUSH    DE
        CALL    C$585E
        POP     DE
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.56DE: LD      A,(CLIKSW)
        AND     A
        RET     Z
        LD      A,(CLIKFL)
        AND     A
        RET     NZ
        LD      A,0FH   ; 15 
        LD      (CLIKFL),A
        OUT     (0ABH),A
        LD      A,0AH   ; 10 
J$56F1: DEC     A
        JR      NZ,J$56F1
        AND     A
        LD      A,0EH   ; 14 
        JR      Z,J$56FA
        INC     A
J$56FA: OUT     (0ABH),A
        RET
J$56FD: LD      A,(D$FCAD)
        AND     A
        LD      A,(NEWKEY+6)
        RRCA
        JR      Z,J$5711
        LD      HL,I$5792
        JR      C,J.5719
        LD      HL,I$57C2
        JR      J.5719
J$5711: LD      HL,I$5732
        JR      C,J.5719
        LD      HL,I$5762
J.5719: LD      B,00H
        ADD     HL,BC
        LD      BC,C.56D0
        PUSH    BC
        LD      A,(D.FCAB)
        AND     A
        LD      A,(HL)
        RET     NZ
        CP      0A6H
        RET     C
        CP      0B0H
        RET     Z
        CP      0DEH
        RET     NC
        XOR     20H     ; " "
        RET
I$5732: RET
?.5733: OR      C
        OR      D
        OR      E
        OR      H
        OR      L
        PUSH    BC
        ADD     A,0C7H
        RET     Z
        RST     10H
        RET     C
        EXX
        JP      C,J$D3DB
        SBC     A,0DFH
        SUB     0DCH
        AND     (HL)
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        CP      E
        CALL    NZ,C$BDC2
        CP      B
        CP      (HL)
        CP      A
        RST     08H
        CALL    Z,C.D1D0
        JP      NC,J$D4D5
        CALL    C.B6CE
        CP      C
        CP      H
        CP      D
        SET     0,E
        OR      A
        POP     BC
        JP      Z,J$C9C0
I$5762  EQU     $-1
        AND     A
        XOR     B
        XOR     C
        XOR     D
        XOR     E
        PUSH    BC
        ADD     A,0C7H
        RET     Z
        RST     10H
        RET     C
        EXX
        JP      C,J$D3A2
        OR      B
        AND     E
        XOR     (HL)
        AND     H
        AND     C
        AND     L
        CP      E
        CALL    NZ,C$BDAF
        CP      B
        CP      (HL)
        CP      A
        RST     08H
        CALL    Z,C.D1D0
        JP      NC,J$ACAD
        CALL    C.B6CE
        CP      C
        CP      H
        CP      D
        SET     0,E
        OR      A
        POP     BC
        JP      Z,J$DCC0
I$5792  EQU     $-1
        RST     00H
        CALL    Z,C$B3B1
        OR      H
        OR      L
        CALL    NC,C$D6D5
        ADC     A,0CDH
        OR      B
        SBC     A,0DFH
        JP      C,J$D1B9
        RET     Z
        EXX
        JP      NC,J$C1DB
        CP      D
        CP      A
        CP      H
        OR      D
        JP      Z,J.B8B7
        ADD     A,0CFH
        RET
?.57B3: RET     C
        OUT     (0D0H),A
        RST     10H
        CP      (HL)
        RET     NZ
        CP      L
        CALL    NZ,C.C5B6
        SET     0,E
        CP      E
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        JP      NZ,J$C7A6
I$57C2  EQU     $-2
        CALL    Z,C$A9A7
        XOR     D
        XOR     E
        XOR     H
        XOR     L
        XOR     (HL)
        ADC     A,0CDH
        OR      B
        SBC     A,0A2H
        JP      C,J$A3B9
        AND     H
        AND     C
        AND     L
        IN      A,(0C1H)
        CP      D
        CP      A
        CP      H
        XOR     B
        JP      Z,J.B8B7
        ADD     A,0CFH
        RET
?.57E3: RET     C
        OUT     (0D0H),A
        RST     10H
        CP      (HL)
        RET     NZ
        CP      L
        CALL    NZ,C.C5B6
        SET     0,E
        CP      E
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        XOR     A
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$57F2: DI
        IN      A,(0AAH)
        AND     0F0H
        ADD     A,08H   ; 8 
        OUT     (0AAH),A
        IN      A,(0A9H)
        EI
        RET
?.57FF: LD      HL,MODE
        BIT     0,(HL)
        JR      Z,J$580B
        XOR     A
        RES     0,(HL)
        JR      J.582B
J$580B: LD      A,(D.FCAC)
        INC     A
        JR      Z,J$5828
        LD      A,(IDBYT2)
        AND     A                       ; MSX1 ?
        JR      Z,J.5826                ; yep,
        LD      A,(NEWKEY+6)
        RRCA
        JR      C,J.5826
        XOR     A
        LD      (CHRCNT),A
        INC     A
        SET     0,(HL)
        JR      J.582B
J.5826: LD      A,0FFH
J$5828: LD      (D.FCAC),A
J.582B: PUSH    AF
        LD      A,0FH   ; 15 
        OUT     (0A0H),A
        IN      A,(0A2H)
        AND     7FH
        LD      B,A
        POP     AF
        OR      A
        LD      A,80H
        JR      Z,J$583C
        XOR     A
J$583C: OR      B
        OUT     (0A1H),A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.5840: LD      B,A
        LD      A,0FH   ; 15 
        DI
        OUT     (0A0H),A
        IN      A,(0A2H)
        DJNZ    J$5850
        AND     0DFH
        OR      4CH     ; "L"
        JR      J$5854
J$5850: AND     0AFH
        OR      03H     ; 3 
J$5854: OUT     (0A1H),A
        LD      A,0EH   ; 14 
        OUT     (0A0H),A
        EI
        IN      A,(0A2H)
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$585E: PUSH    AF
        LD      A,(MODE)
        AND     01H     ; 1 
        JR      Z,J$58A7
        POP     AF
        PUSH    AF
        LD      HL,(PUTPNT)
        PUSH    HL
        LD      IX,PUTCHR
        CALL    EXTROM
        POP     HL
        POP     AF
        RET     Z
        LD      B,00H
        LD      DE,(PUTPNT)
        LD      (PUTPNT),HL
J$587F: LD      A,L
        CP      E
        JR      Z,J$588B
        LD      A,(HL)
        PUSH    AF
        INC     B
        CALL    C.58D3
        JR      J$587F
J$588B: LD      A,B
        AND     A
        RET     Z
        LD      E,B
        LD      L,B
        DEC     L
        LD      H,00H
        ADD     HL,HL
        ADD     HL,SP
        INC     HL
J$5896: LD      A,(HL)
        PUSH    HL
        PUSH    BC
        CALL    C$58AD
        POP     BC
        POP     HL
        DEC     HL
        DEC     HL
        DJNZ    J$5896
        LD      B,E
J$58A3: POP     AF
        DJNZ    J$58A3
        RET
J$58A7: CALL    C.56DE
        POP     AF
        JR      Z,C.58C3
;
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$58AD: LD      HL,NORUSE
        BIT     5,(HL)
        JR      NZ,C.58C3

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C$58B4: CALL    C$75A4
        JR      C,C.58C3
        LD      B,24H   ; "$"
        CALL    C.7104
        LD      A,B
        CALL    C.58C3
        LD      A,C

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.58C3: LD      HL,(PUTPNT)
        LD      (HL),A
        CALL    C.58D3
        LD      A,(GETPNT)
        CP      L
        RET     Z
        LD      (PUTPNT),HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.58D3: INC     HL
        LD      A,L
        CP      18H
        RET     NZ
        LD      HL,KEYBUF
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.58DC: PUSH    HL
        PUSH    DE
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$58DE: PUSH    BC
        PUSH    AF
        CALL    C$58E8
        POP     AF
        POP     BC
        POP     DE
        POP     HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$58E8: CALL    C.6386
        ADD     A,H
        LD      H,A
        LD      A,(IX+2)
        LD      (IX+2),00H
        AND     A
        LD      B,A
        JP      NZ,J$5AAD
        LD      A,C
        CALL    C.4982
        JR      C,J$5974
        LD      (IX+2),A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.5903: LD      A,(IDBYT2)
        CP      02H                     ; MSX2+ or higher ?
        RET     C                       ; nope, quit
        LD      A,(D$FFFA)
        AND     18H
        CP      18H
        RET     NZ
        LD      A,(MODE)
        AND     20H     ; " "
        RET

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.5917: CALL    C.5903
        RET     NZ
        POP     IY
        LD      A,(NORUSE)
        PUSH    AF
        AND     0FH     ; 15 
        LD      DE,(FORCLR)
        PUSH    DE
        JR      NZ,J$5953
        LD      DE,0F0FH
        LD      (FORCLR),DE
        LD      A,(NORUSE)
        AND     0F0H
        OR      01H     ; 1 
        LD      (NORUSE),A
        PUSH    IY
        PUSH    BC
        PUSH    HL
        CALL    C.5972
        POP     HL
        POP     BC
        POP     IY
        LD      A,(NORUSE)
J$5949: AND     0F0H
        OR      02H     ; 2 
        LD      (NORUSE),A
        POP     DE
        PUSH    DE
        SCF
J$5953: PUSH    AF
        LD      A,E
        RLA
        RLA
        RLA
        RLA
        LD      E,A
        POP     AF
        LD      A,D
        RLA
        RLA
        RLA
        RLA
        LD      D,A
        LD      (FORCLR),DE
        CALL    C.5972
        POP     DE
        LD      (FORCLR),DE
        POP     AF
        LD      (NORUSE),A
        RET

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.5972: JP      (IY)

J$5974: CALL    C.5917
        LD      A,C
        CP      0FFH
        JR      NZ,J$597F
        LD      C,20H   ; " "
        LD      A,C
J$597F: CP      20H     ; " "
        JR      NZ,J$598F
        LD      A,(IX+0)
        AND     07H     ; 7 
        CP      04H     ; 4 
        LD      A,01H   ; 1 
        JP      NC,J.6028
J$598F: LD      A,(IX+0)
        AND     50H     ; "P"
        CP      50H     ; "P"
        JR      NZ,J$59A2
        PUSH    HL
        LD      L,C
        LD      H,00H
        CALL    C.6250
        POP     HL
        JR      J.59D5
J$59A2: LD      A,(IX+0)
        AND     48H     ; "H"
        CP      08H     ; 8 
        JR      Z,J$59B0
        CALL    C.62E8
        JR      J.59D5
J$59B0: LD      A,C
        AND     A
        JP      M,J$59BB
        SUB     20H     ; " "
        LD      B,00H
        JR      J$59BF
J$59BB: SUB     80H
        LD      B,0DH   ; 13 
J$59BF: CP      40H     ; "@"
        JR      C,J$59C6
        SUB     40H     ; "@"
        INC     B
J$59C6: OUT     (0D8H),A
        LD      A,B
        OUT     (0D9H),A
        PUSH    HL
        LD      HL,HOLD8
        LD      BC,I$18D9
        INIR
        POP     HL
J.59D5: LD      A,(IX+0)
        AND     07H     ; 7 
        CP      04H     ; 4 
        JP      C,J$63BF
        LD      A,(IX+0)
        ADD     A,A
        JR      C,J$5A2F
        JP      P,J$59FA
        PUSH    HL
        LD      L,H
        DEC     L
        LD      H,00H
        LD      E,L
        LD      D,H
        ADD     HL,HL
        ADD     HL,DE
        ADD     HL,HL
        LD      (HOLD8+36),HL
        LD      HL,6
        JR      J$5A08
J$59FA: PUSH    HL
        LD      L,H
        DEC     L
        LD      H,00H
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        LD      (HOLD8+36),HL
        LD      HL,8
J$5A08: LD      (HOLD8+40),HL
        LD      A,L
        LD      (HOLD8+45),A
        POP     HL
        DEC     L
        LD      H,00H
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        LD      (HOLD8+38),HL
        LD      HL,16
        LD      (HOLD8+42),HL
        LD      A,08H   ; 8 
        LD      (HOLD8+46),A
        LD      A,01H   ; 1 
        LD      (HOLD8+47),A
        LD      DE,HOLD8
        JR      C.5A81
J$5A2F: JP      P,J$5A44
        PUSH    HL
        LD      L,H
        DEC     L
        LD      H,00H
        LD      E,L
        LD      D,H
        ADD     HL,HL
        ADD     HL,DE
        ADD     HL,HL
        LD      (HOLD8+36),HL
        LD      HL,6
        JR      J$5A52
J$5A44: PUSH    HL
        LD      L,H
        DEC     L
        LD      H,00H
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        LD      (HOLD8+36),HL
        LD      HL,8
J$5A52: LD      (HOLD8+40),HL
        LD      A,L
        LD      (HOLD8+45),A
        POP     HL
        DEC     L
        LD      H,00H
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        LD      (HOLD8+38),HL
        LD      HL,8
        LD      (HOLD8+42),HL
        LD      A,04H   ; 4 
        LD      (HOLD8+46),A
        LD      A,02H   ; 2 
        LD      (HOLD8+47),A
        LD      DE,HOLD8
        CALL    C.5A81
        LD      HL,HOLD8+39
        SET     0,(HL)
        LD      DE,HOLD8+1
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.5A81: CALL    C.619B
        CALL    C$5A8B
        LD      A,08H   ; 8 
        ADD     A,L
        LD      L,A
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$5A8B: LD      A,(HOLD8+46)
J$5A8E: PUSH    AF
        LD      A,(HL)
J.5A90: RLA
        JP      NC,J$5A9B
        OUT     (C),E
        DJNZ    J.5A90
        JP      J$5A9F
J$5A9B: OUT     (C),D
        DJNZ    J.5A90
J$5A9F: LD      A,(HOLD8+45)
        LD      B,A
        LD      A,(HOLD8+47)
        ADD     A,L
        LD      L,A
        POP     AF
        DEC     A
        JR      NZ,J$5A8E
        RET
J$5AAD: LD      A,C
        CALL    C.4990
        JR      C,J$5AC1
        LD      A,B
        CP      98H
        JR      NZ,J.5AC4
;
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$5AB8: LD      A,C
        CP      80H
        JR      C,J.5AC4
        CP      9FH
        JR      NC,J.5AC4
J$5AC1: LD      BC,I.8140
J.5AC4: CALL    C.5917
        DEC     H
        EX      DE,HL
        LD      HL,I.8140
        AND     A
        SBC     HL,BC
        EX      DE,HL
        JR      NZ,J$5ADE
        LD      A,(IX+0)
        AND     07H     ; 7 
        CP      04H     ; 4 
        LD      A,02H   ; 2 
        JP      NC,J.6028
J$5ADE: PUSH    HL
        LD      HL,I$989E
        AND     A
        SBC     HL,BC
        POP     HL
        BIT     6,(IX+0)
        JR      Z,J.5B0A
        BIT     4,(IX+0)
        JR      NC,J$5AF6
        BIT     6,(IX+1)
J$5AF6: JR      Z,J.5B0A
        PUSH    HL
        LD      A,B
        AND     3FH     ; "?"
        ADD     A,0DH   ; 13 
        LD      H,A
        LD      A,C
        SUB     40H     ; "@"
        LD      L,A
        CALL    C.6250
        POP     HL
        JP      J.5BF1
J.5B0A: BIT     3,(IX+0)
        JR      NC,J$5B15
        LD      A,(MODE)
        AND     40H     ; "@"
J$5B15: JP      NZ,J$5BB4
        PUSH    HL
        LD      HL,I.8140
        AND     A
        SBC     HL,BC
        JR      NZ,J$5B31
        LD      HL,HOLD8+0
        LD      DE,HOLD8+1
        LD      BC,32-1
        LD      (HL),0
        LDIR
        JP      J.5BB1
J$5B31: CALL    C.621D
        CP      01H     ; 1 
        JR      NZ,J$5B51
        LD      A,C
        ADD     A,20H   ; " "
        LD      HL,I.7449
        LD      BC,42
        CPDR
        JR      NZ,J$5B4C
        LD      HL,I.744A
        ADD     HL,BC
        LD      A,(HL)
        JR      J$5B58
J$5B4C: SUB     20H     ; " "
        LD      C,A
        LD      A,01H   ; 1 
J$5B51: CP      03H     ; 3 
        JR      NZ,J$5B5E
        LD      A,C
        ADD     A,20H   ; " "
J$5B58: LD      HL,I$5B68
        CP      A
        JR      J$5B70
J$5B5E: CP      04H     ; 4 
        JR      Z,J$5B66
        CP      05H     ; 5 
        JR      NZ,J$5BA5
J$5B66: CP      05H     ; 5 
I$5B68: LD      B,00H
        LD      HL,I.7372
        ADD     HL,BC
        ADD     HL,BC
        LD      A,(HL)
J$5B70: PUSH    AF
        JR      Z,J$5B75
        XOR     20H     ; " "
J$5B75: LD      C,A
        CALL    C.62E8
        POP     AF
        JR      Z,J.5B94
        BIT     6,(IX+0)
        JR      Z,J.5B94
        INC     HL
        LD      A,(HL)
        AND     A
        DEC     HL
        JR      NZ,J$5B8D
        CALL    C$6359
        JR      J.5BB1
J$5B8D: LD      B,18H
        PUSH    HL
        CALL    C$623E
        POP     HL
J.5B94: INC     HL
        LD      A,(HL)
        AND     A
        PUSH    AF
        CALL    Z,C$6310
        POP     AF
        LD      C,A
        LD      DE,HOLD8+8
        CALL    NZ,C$62EB
        JR      J.5BB1
J$5BA5: PUSH    BC
        LD      DE,HOLD8
        CALL    C.62CC
        POP     BC
        LD      A,C
        CALL    C.62CC
J.5BB1: POP     HL
        JR      J.5BF1
J$5BB4: PUSH    HL
        CALL    C.621D
        LD      E,C
        LD      D,00H
        LD      L,A
        LD      H,D
        LD      C,L
        LD      B,H
        ADD     HL,HL
        ADD     HL,BC
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,DE
        CP      30H     ; "0"
        JR      C,J$5BD3
        LD      A,H
        SUB     12H     ; 18 
        LD      H,A
        LD      C,0DAH
        JR      J$5BDB
J$5BD3: CP      10H     ; 16 
        JR      C,J$5BD9
        DEC     H
        DEC     H
J$5BD9: LD      C,0D8H
J$5BDB: OUT     (C),L
        ADD     HL,HL
        ADD     HL,HL
        INC     C
        OUT     (C),H
        LD      HL,HOLD8
        LD      B,20H   ; " "
        INIR
        BIT     6,(IX+0)
        CALL    NZ,C$623C
        POP     HL
J.5BF1: LD      A,(IX+0)
        AND     07H     ; 7 
        CP      04H     ; 4 
        JP      C,J$63B6
        LD      A,(IX+0)
        ADD     A,A
        JR      C,J$5C51
        JP      P,J$5C1B
        PUSH    HL
        LD      L,H
        DEC     L
        LD      H,00H
        LD      E,L
        LD      D,H
        ADD     HL,HL
        ADD     HL,DE
        ADD     HL,HL
        LD      (HOLD8+36),HL
        LD      HL,12
        LD      (HOLD8+40),HL
        LD      A,06H   ; 6 
        JR      J$5C2E
J$5C1B: PUSH    HL
        LD      L,H
        DEC     L
        LD      H,00H
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        LD      (HOLD8+36),HL
        LD      HL,16
        LD      (HOLD8+40),HL
        LD      A,08H   ; 8 
J$5C2E: LD      (HOLD8+45),A
        POP     HL
        DEC     L
        LD      H,00H
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        LD      (HOLD8+38),HL
        LD      HL,16
        LD      (HOLD8+42),HL
        LD      A,08H   ; 8 
        LD      (HOLD8+46),A
        LD      A,0F9H
        LD      (HOLD8+47),A
        LD      DE,HOLD8
        JR      C.5CA9
J$5C51: JP      P,J$5C6B
        PUSH    HL
        LD      L,H
        DEC     L
        LD      H,00H
        LD      E,L
        LD      D,H
        ADD     HL,HL
        ADD     HL,DE
        ADD     HL,HL
        LD      (HOLD8+36),HL
        LD      HL,12
        LD      (HOLD8+40),HL
        LD      A,06H   ; 6 
        JR      J$5C7E
J$5C6B: PUSH    HL
        LD      L,H
        DEC     L
        LD      H,00H
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        LD      (HOLD8+36),HL
        LD      HL,16
        LD      (HOLD8+40),HL
        LD      A,08H   ; 8 
J$5C7E: LD      (HOLD8+45),A
        POP     HL
        DEC     L
        LD      H,00H
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        LD      (HOLD8+38),HL
        LD      HL,8
        LD      (HOLD8+42),HL
        LD      A,04H   ; 4 
        LD      (HOLD8+46),A
        LD      A,0FAH
        LD      (HOLD8+47),A
        LD      DE,HOLD8
        CALL    C.5CA9
        LD      HL,HOLD8+39
        SET     0,(HL)
        LD      DE,HOLD8+1
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.5CA9: CALL    C.619B
        CALL    C$5CB3
        LD      A,08H   ; 8 
        ADD     A,L
        LD      L,A
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$5CB3: LD      A,(HOLD8+46)
J$5CB6: PUSH    AF
        LD      A,(HL)
J.5CB8: RLA
        JP      NC,J$5CC3
        OUT     (C),E
        DJNZ    J.5CB8
        JP      J$5CC7
J$5CC3: OUT     (C),D
        DJNZ    J.5CB8
J$5CC7: LD      A,(HOLD8+45)
        LD      B,A
        LD      A,08H   ; 8 
        ADD     A,L
        LD      L,A
J$5CCF: LD      A,(HL)
J.5CD0: RLA
        JP      NC,J$5CDB
        OUT     (C),E
        DJNZ    J.5CD0
        JP      J$5CDF
J$5CDB: OUT     (C),D
        DJNZ    J.5CD0
J$5CDF: LD      A,(HOLD8+45)
        LD      B,A
        LD      A,(HOLD8+47)
        ADD     A,L
        LD      L,A
        POP     AF
        DEC     A
        JR      NZ,J$5CB6
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.5CED: PUSH    HL
        CALL    C$5CF3
        POP     HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$5CF3: CALL    C.6386
        ADD     A,H
        LD      H,A
        LD      A,(IX+0)
        AND     07H     ; 7 
        CP      04H     ; 4 
        JP      C,J$655D
        LD      A,(IX+0)
        ADD     A,A
        JP      C,J$5D54
        JP      P,J$5D1E
        PUSH    HL
        LD      L,H
        DEC     L
        LD      H,00H
        LD      C,L
        LD      B,H
        ADD     HL,HL
        ADD     HL,BC
        ADD     HL,HL
        LD      (HOLD8+36),HL
        LD      HL,6
        JR      J$5D2C
J$5D1E: PUSH    HL
        LD      L,H
        DEC     L
        LD      H,00H
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        LD      (HOLD8+36),HL
        LD      HL,8
J$5D2C: BIT     1,E
        JR      Z,J$5D31
        ADD     HL,HL
J$5D31: LD      (HOLD8+40),HL
        POP     HL
        DEC     L
        LD      H,00H
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        LD      D,00H
        BIT     0,E
        LD      E,00H
        JR      Z,J$5D46
        LD      E,0AH   ; 10 
J$5D46: ADD     HL,DE
        LD      (HOLD8+38),HL
        LD      HL,16
        SBC     HL,DE
        LD      (HOLD8+42),HL
        JR      C.5DA7
J$5D54: BIT     6,(IX+0)
        JR      Z,J$5D6C
        PUSH    HL
        LD      L,H
        DEC     L
        LD      H,00H
        LD      C,L
        LD      B,H
        ADD     HL,HL
        ADD     HL,BC
        ADD     HL,HL
        LD      (HOLD8+36),HL
        LD      HL,6
        JR      J$5D7A
J$5D6C: PUSH    HL
        LD      L,H
        DEC     L
        LD      H,00H
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        LD      (HOLD8+36),HL
        LD      HL,8
J$5D7A: BIT     1,E
        JR      Z,J$5D7F
        ADD     HL,HL
J$5D7F: LD      (HOLD8+40),HL
        POP     HL
        DEC     L
        LD      H,00H
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        LD      D,00H
        BIT     0,E
        LD      E,00H
        JR      Z,J$5D93
        LD      E,05H   ; 5 
J$5D93: ADD     HL,DE
        LD      (HOLD8+38),HL
        LD      HL,8
        SBC     HL,DE
        LD      (HOLD8+42),HL
        CALL    C.5DA7
        LD      HL,HOLD8+39
        SET     0,(HL)
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.5DA7: CALL    C.616D
        INC     C
        INC     C
        LD      HL,(HOLD8+36)
        OUT     (C),L
        OUT     (C),H
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$5DB3: LD      HL,(HOLD8+38)
        LD      A,(D.FFF6)
        ADD     A,L
        OUT     (C),A
        LD      A,(ACPAGE)
        ADD     A,H
        OUT     (C),A
        LD      HL,(HOLD8+40)
        OUT     (C),L
        OUT     (C),H
        LD      HL,(HOLD8+42)
        OUT     (C),L
        OUT     (C),H
        LD      A,(FORCLR)
        LD      B,A
        LD      A,(BAKCLR)
        XOR     B
        LD      B,A
        CALL    C.5903
        LD      A,B
        JR      NZ,J$5DE3
        ADD     A,A
        ADD     A,A
        ADD     A,A
        ADD     A,A
J$5DE3: OUT     (C),A
        XOR     A
        OUT     (C),A
        LD      A,83H
        OUT     (C),A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$5DED: PUSH    HL
        PUSH    AF
        CALL    C$5DF5
        POP     AF
        POP     HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$5DF5: LD      D,A
        LD      A,(IX+0)
        AND     07H     ; 7 
        CP      04H     ; 4 
        JP      C,J$669B
        CALL    C$5E06
        JP      C.617E
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$5E06: BIT     5,(IX+0)
        JP      Z,C.5E8E
        LD      A,L
        DEC     A
        JP      NZ,C.5E8E
        BIT     7,(IX+0)
        LD      E,10H   ; 16 
        JR      Z,J$5E1C
        LD      E,08H   ; 8 
J$5E1C: PUSH    AF
        LD      HL,I$00E2
        LD      A,0FH   ; 15 
        CALL    C.5FDD
        CALL    C.5F1C
        POP     AF
        JR      NZ,J$5E64
        LD      A,D
        AND     A
        JR      Z,C.5E50
        LD      HL,I$00C0
        LD      E,33H   ; "3"
        LD      A,04H   ; 4 
        CALL    C.5EB0
        LD      HL,I$00C4
        LD      E,10H   ; 16 
        LD      A,0CH   ; 12 
        CALL    C.5EB0
        CALL    C.5E50
        LD      HL,I$00E3
        LD      E,0DDH
        LD      A,04H   ; 4 
        JP      C.5EB0
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.5E50: CALL    C$5EE1
        LD      C,10H   ; 16 
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.5E55: LD      A,(D.FFF6)
        ADD     A,C
        LD      B,A
        LD      C,17H
        PUSH    BC
        CALL    C.617E
        POP     BC
        JP      WRTVDP

J$5E64: LD      H,00H
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        LD      A,D
        ADD     A,A
        ADD     A,A
        ADD     A,A
        LD      E,38H   ; "8"
        PUSH    AF
        PUSH    HL
        CALL    NZ,C.5EA5
        POP     HL
        PUSH    HL
        LD      A,0DCH
        SUB     L
        CALL    C.5EFD
        LD      C,08H   ; 8 
        CALL    C.5E55
        POP     HL
        POP     AF
        LD      DE,48
        ADD     HL,DE
        LD      E,0D0H
        AND     A
        CALL    NZ,C.5EA5
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.5E8E: LD      A,D
        LD      H,00H
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        ADD     A,A
        ADD     A,A
        ADD     A,A
        BIT     7,(IX+0)
        LD      E,0F8H
        JR      NZ,C.5EA5
        ADD     HL,HL
        ADD     A,A
        LD      E,0F0H
        JR      C.5EB0
I$5EA4  EQU     $-1
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.5EA5: PUSH    HL
        PUSH    DE
        PUSH    AF
        CALL    C.5EB0
        POP     AF
        POP     DE
        POP     HL
        SET     0,H

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.5EB0: LD      B,A
        LD      A,(D.FFF6)
        ADD     A,L
        LD      L,A
        LD      A,E
        ADD     A,L
        LD      E,A
        LD      D,H
J$5EBA: LD      A,E
        CP      L
        JR      NC,J$5EBF
        LD      A,L
J$5EBF: NEG
        CP      B
        JR      C,J$5EC5
        LD      A,B
J$5EC5: PUSH    AF
        CALL    C$5ED7
        POP     AF
        LD      C,A
        LD      A,L
        ADD     A,C
        LD      L,A
        LD      A,E
        ADD     A,C
        LD      E,A
        LD      A,B
        SUB     C
        LD      B,A
        JR      NZ,J$5EBA
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$5ED7: CALL    C.61F3
        OUT     (C),A
        LD      A,0E0H
        OUT     (C),A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$5EE1: CALL    C.5F1C
        LD      H,00H
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        LD      A,10H   ; 16 
        CALL    C.5F06
        LD      HL,I$00E0
        LD      A,04H   ; 4 
        JR      C.5F06
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$5EF6: LD      HL,I$00F0
        LD      A,10H   ; 16 
        JR      C.5F06
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.5EFD: PUSH    HL
        PUSH    AF
        CALL    C.5F06
        POP     AF
        POP     HL
        SET     0,H
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.5F06: PUSH    AF
        LD      C,00H
        LD      A,(IX+0)
        INC     A
        AND     02H     ; 2 
        CP      01H     ; 1 
        ADC     A,C
        LD      B,A
        LD      E,C
        LD      D,C
        POP     AF
        CALL    C.6080
        JP      C.617E
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.5F1C: CALL    C.4CEE
        LD      L,A
        LD      A,(CNSDFG)
        AND     01H     ; 1 
        LD      D,A
        CALL    C.6B7B
        RET     C
        INC     D
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$5F2C: PUSH    HL
        PUSH    AF
        CALL    C$5F34
        POP     AF
        POP     HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$5F34: LD      D,A
        LD      A,(IX+0)
        AND     07H     ; 7 
        CP      04H     ; 4 
        JP      C,J$66CF
        CALL    C$5F45
        JP      C.617E
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$5F45: BIT     5,(IX+0)
        JR      Z,J.5FB8
        LD      A,L
        SUB     D
        DEC     A
        JR      NZ,J.5FB8
        BIT     7,(IX+0)
        JR      NZ,J$5F79
        CALL    C$5EF6
        LD      C,0F0H
        CALL    C.5E55
        CALL    C.5F1C
        INC     L
        LD      A,D
        AND     A
        CALL    NZ,C.5E8E
        LD      HL,I$00D0
        LD      A,04H   ; 4 
        CALL    C.5F06
        LD      E,0F0H
        LD      HL,I$00E4
        LD      A,0FH   ; 15 
        JP      C.5EB0
J$5F79: CALL    C.5F1C
        LD      H,00H
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        LD      A,D
        ADD     A,A
        ADD     A,A
        ADD     A,A
        LD      E,30H   ; "0"
        PUSH    AF
        PUSH    HL
        CALL    NZ,C.5EA5
        POP     HL
        PUSH    HL
        LD      A,0CCH
        SUB     L
        CALL    C.5EFD
        LD      HL,I$00F8
        LD      A,08H   ; 8 
        CALL    C.5EFD
        LD      C,0F8H
        CALL    C.5E55
        LD      E,0F8H
        LD      HL,I$00DC
        LD      A,0FH   ; 15 
        CALL    C.5EB0
        POP     HL
        POP     AF
        LD      DE,56
        ADD     HL,DE
        LD      E,0C8H
        AND     A
        CALL    NZ,C.5EA5
        RET
J.5FB8: LD      A,D
        LD      H,00H
        DEC     L
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        ADD     A,A
        ADD     A,A
        ADD     A,A
        BIT     7,(IX+0)
        JR      NZ,J$5FCF
        ADD     HL,HL
        DEC     HL
        ADD     A,A
        LD      E,10H   ; 16 
        JR      C.5FDD
J$5FCF: DEC     HL
        LD      E,08H   ; 8 
        PUSH    HL
        PUSH    DE
        PUSH    AF
        CALL    C.5FDD
J$5FD8: POP     AF
        POP     DE
        POP     HL
        SET     0,H
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.5FDD: LD      B,A
        LD      A,(D.FFF6)
        ADD     A,L
        LD      L,A
        LD      A,E
        ADD     A,L
        LD      E,A
        LD      D,H
J$5FE7: LD      A,E
        CP      L
        JR      C,J$5FEC
        LD      A,L
J$5FEC: INC     A
        CP      B
        JR      C,J$5FF1
        LD      A,B
J$5FF1: PUSH    AF
        CALL    C$6003
        POP     AF
        LD      C,A
        LD      A,L
        SUB     C
        LD      L,A
        LD      A,E
        SUB     C
        LD      E,A
        LD      A,B
        SUB     C
        LD      B,A
        JR      NZ,J$5FE7
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$6003: CALL    C.61F3
        LD      A,08H   ; 8 
        OUT     (C),A
        LD      A,0E0H
        OUT     (C),A
        RET

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.600F: CALL    C.6386
        ADD     A,H
        LD      H,A
        LD      A,(IX+0)
        AND     07H     ; 7 
        CP      04H     ; 4 
        JP      C,J$6705
        CALL    C$6024
        JP      C.617E

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$6024: CALL    C.5917
        SCF
J.6028: PUSH    HL
        PUSH    AF
        LD      L,H
        LD      H,00H
        DEC     L
        ADD     HL,HL
        BIT     6,(IX+0)
        JR      Z,J$603F
        LD      E,L
        LD      D,H
        ADD     HL,HL
        ADD     HL,DE
        EX      DE,HL
        LD      BC,I$0C06
        JR      J$6045
J$603F: ADD     HL,HL
        ADD     HL,HL
        EX      DE,HL
        LD      BC,I$1008
J$6045: POP     AF
        JR      C,J$6051
        DEC     A
        JR      Z,J$604C
        LD      C,B
J$604C: LD      B,00H
        POP     HL
        JR      J$6064
J$6051: LD      L,00H
        LD      A,(IX+0)
        INC     A
        AND     02H     ; 2 
        CP      01H     ; 1 
        ADC     A,L
        LD      H,A
        SBC     HL,DE
        LD      C,L
        LD      B,H
        POP     HL
        RET     Z
        RET     C
J$6064: DEC     L
        LD      H,00H
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        BIT     7,(IX+0)
        JR      NZ,J$6075
        ADD     HL,HL
        LD      A,10H   ; 16 
        JR      C.6080
J$6075: PUSH    BC
        PUSH    HL
        CALL    C$607E
        POP     HL
        POP     BC
        SET     0,H
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$607E: LD      A,08H   ; 8 
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.6080: PUSH    AF
        LD      A,(D.FFF6)
        ADD     A,L
        LD      L,A
        POP     AF
        NEG
        CP      L
        JR      NC,C.6099
        PUSH    HL
        PUSH    BC
        PUSH    AF
        LD      A,L
        CALL    C.6099
        POP     AF
        POP     BC
        POP     HL
        SUB     L
        LD      L,00H
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.6099: NEG
        PUSH    AF
        PUSH    BC
        CALL    C.616D
        INC     C
        INC     C
        OUT     (C),E
        OUT     (C),D
        OUT     (C),L
        LD      A,(ACPAGE)
        ADD     A,H
        OUT     (C),A
        POP     HL
        OUT     (C),L
        OUT     (C),H
        POP     AF
        OUT     (C),A
        XOR     A
        OUT     (C),A
        LD      A,(NORUSE)
        AND     0FH     ; 15 
        JR      NZ,J.60EF
        LD      A,(IX+0)
        BIT     0,A
        JR      Z,J$60D8
        BIT     1,A
        JR      Z,J$60E5
        LD      A,(BAKCLR)
J$60CE: OUT     (C),A
        XOR     A
        OUT     (C),A
        LD      A,0C0H
        OUT     (C),A
        RET
J$60D8: BIT     0,E
        JR      NZ,J.60EF
        BIT     0,L
J$60DE: JR      NZ,J.60EF
        CALL    C.6101
        JR      J$60CE
J$60E5: LD      A,E
        AND     03H     ; 3 
        JR      NZ,J.60EF
        LD      A,L
        AND     03H     ; 3 
        JR      J$60DE
J.60EF: LD      A,(BAKCLR)
        OUT     (C),A
        XOR     A
        OUT     (C),A
        LD      A,(NORUSE)
        AND     0FH     ; 15 
        OR      80H
        OUT     (C),A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.6101: LD      A,(BAKCLR)
        BIT     0,(IX+0)
        JR      Z,J$6113
        BIT     1,(IX+0)
        RET     NZ
        LD      B,A
        ADD     A,A
        ADD     A,A
        OR      B
J$6113: LD      B,A
        ADD     A,A
        ADD     A,A
        ADD     A,A
        ADD     A,A
        OR      B
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$611A: LD      A,(IX+0)
        AND     07H     ; 7 
        CP      04H     ; 4 
        JP      C,J$67AD
        LD      H,00H
        CALL    C$6130
        BIT     7,(IX+0)
        RET     Z
        LD      H,01H   ; 1 
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$6130: LD      A,(D.FCAF)
        CP      02H     ; 2 
        LD      DE,256
        JR      C,J$613D
        LD      DE,I$00D4
J$613D: CALL    C.616D
        INC     C
        INC     C
        XOR     A
        OUT     (C),A
        OUT     (C),A
        OUT     (C),A
        LD      A,(ACPAGE)
        ADD     A,H
        OUT     (C),A
        OUT     (C),A
        LD      A,(IX+0)
        INC     A
        AND     02H     ; 2 
        CP      01H     ; 1 
        ADC     A,00H
        OUT     (C),A
        OUT     (C),E
        OUT     (C),D
        CALL    C.6101
        OUT     (C),A
        XOR     A
        OUT     (C),A
        LD      A,0C0H
        JR      J$617C
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.616D: LD      A,24H   ; "$"
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$616F: PUSH    AF
        LD      A,(VDP.DR)
        LD      C,A
        INC     C
        POP     AF
        DI
        OUT     (C),A
        LD      A,91H
        EI
J$617C: OUT     (C),A
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.617E: LD      A,(VDP.DR)
        LD      C,A
        INC     C
J$6183: LD      A,02H   ; 2 
        DI
        OUT     (C),A
        LD      A,8FH
        OUT     (C),A
        IN      A,(C)
        RRA
        LD      A,00H
        OUT     (C),A
        LD      A,8FH
        EI
        OUT     (C),A
        JR      C,J$6183
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.619B: CALL    C.616D
        INC     C
        INC     C
        LD      HL,(HOLD8+36)
        OUT     (C),L
        OUT     (C),H
        LD      HL,(HOLD8+38)
        LD      A,(D.FFF6)
        ADD     A,L
        OUT     (C),A
        LD      A,(ACPAGE)
        ADD     A,H
        OUT     (C),A
        LD      HL,(HOLD8+40)
        OUT     (C),L
        OUT     (C),H
        LD      HL,(HOLD8+42)
        OUT     (C),L
        OUT     (C),H
        EX      DE,HL
        LD      DE,(FORCLR)
        RL      (HL)
        JP      NC,J$61D1
        OUT     (C),E
        JP      NC,J$51ED
J$61D1  EQU     $-2
        XOR     A
        OUT     (C),A
        LD      A,(NORUSE)
        AND     0FH     ; 15 
        OR      0B0H
        OUT     (C),A
        DEC     C
        DEC     C
        LD      A,0ACH
        DI
        OUT     (C),A
        LD      A,91H
        EI
        OUT     (C),A
        INC     C
        INC     C
        LD      A,(HOLD8+45)
        DEC     A
        LD      B,A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.61F3: PUSH    AF
        LD      A,22H   ; """
        CALL    C$616F
        INC     C
        INC     C
        OUT     (C),L
        LD      A,(ACPAGE)
        ADD     A,H
        OUT     (C),A
        XOR     A
        OUT     (C),A
        OUT     (C),A
        OUT     (C),E
        LD      A,(ACPAGE)
        ADD     A,D
        OUT     (C),A
        OUT     (C),A
        OUT     (C),A
        POP     AF
        OUT     (C),A
        XOR     A
        OUT     (C),A
        OUT     (C),A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.621D: LD      A,C
        CP      80H
        ADC     A,0FFH
        CP      9EH
        PUSH    AF
        JR      C,J$6229
        SUB     5EH     ; "^"
J$6229: SUB     3FH     ; "?"
        LD      C,A
        LD      A,B
        CP      0E0H
        JR      C,J$6233
        SUB     40H     ; "@"
J$6233: SUB     81H
        LD      B,A
        POP     AF
        CCF
        LD      A,B
        RLA
        INC     A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$623C: LD      B,20H   ; " "
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$623E: LD      HL,HOLD8
        LD      D,0
J$6243: LD      E,(HL)
        PUSH    HL
        LD      HL,I$7274
        ADD     HL,DE
        LD      A,(HL)
        POP     HL
        LD      (HL),A
        INC     HL
        DJNZ    J$6243
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.6250: IN      A,(40H)
        PUSH    AF
        LD      A,0F7H
        OUT     (40H),A
        PUSH    HL
        LD      DE,I$253F
        OR      A
        SBC     HL,DE
        POP     HL
        IN      A,(41H)
        JR      NC,J$6265
        IN      A,(40H)
J$6265: CP      08H     ; 8 
        JR      Z,J$626D
        LD      A,03H   ; 3 
        OUT     (42H),A
J$626D: CALL    C$6275
        POP     AF
        CPL
        OUT     (40H),A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$6275: LD      A,H
        OUT     (47H),A
        LD      A,L
        OUT     (48H),A
        LD      HL,0
        LD      (HOLD8+0),HL
        LD      (HOLD8+8),HL
        LD      (HOLD8+22),HL
        LD      (HOLD8+30),HL
        LD      IY,HOLD8+2
        CALL    C$6295
        LD      IY,HOLD8+16

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C$6295: LD      B,03H   ; 3 
J$6297: IN      A,(49H)
        LD      (IY+0),A
        RRCA
        RRCA
        AND     0C0H
        LD      C,A
        IN      A,(49H)
        LD      E,A
        RRCA
        RRCA
        AND     3FH     ; "?"
        OR      C
        LD      (IY+8),A
        LD      A,E
        ADD     A,A
        ADD     A,A
        ADD     A,A
        ADD     A,A
        LD      C,A
        IN      A,(49H)
        LD      E,A
        RRCA
        RRCA
        RRCA
        RRCA
        AND     0FH     ; 15 
        OR      C
        LD      (IY+1),A
        LD      A,E
        ADD     A,A
        ADD     A,A
        LD      (IY+9),A
        INC     IY
        INC     IY
        DJNZ    J$6297
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.62CC: ADD     A,20H   ; " "
        PUSH    AF
        RRCA
        RRCA
        RRCA
        RRCA
        CALL    C$62D7
        POP     AF
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$62D7: AND     0FH     ; 15 
        CP      0AH     ; 10 
        SBC     A,69H   ; "i"
        DAA
        LD      L,A
        CALL    C.6305
        LD      BC,8
        LDIR
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.62E8: LD      DE,HOLD8
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$62EB: PUSH    HL
        LD      L,C
        CALL    C.6305
        LD      C,02H   ; 2 
J$62F2: LD      B,04H   ; 4 
J$62F4: LD      A,(HL)
        INC     HL
        LD      (DE),A
        INC     DE
        LD      (DE),A
        INC     DE
        DJNZ    J$62F4
        LD      A,08H   ; 8 
        ADD     A,E
        LD      E,A
        DEC     C
        JR      NZ,J$62F2
        POP     HL
        RET

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.6305: LD      H,00H
        ADD     HL,HL
        ADD     HL,HL
        ADD     HL,HL
        LD      BC,(CGTABL)
        ADD     HL,BC
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$6310: LD      IY,HOLD8
        CALL    C$631B
        LD      IY,HOLD8+16
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$631B: LD      D,04H   ; 4 
J$631D: LD      E,02H   ; 2 
        LD      A,(IY+0)
J$6322: LD      B,04H   ; 4 
        BIT     6,(IX+0)
        JR      Z,J$632B
        DEC     B
J$632B: LD      C,00H
J$632D: ADD     A,A
        RL      C
        RRC     C
        RL      C
        RL      C
        DJNZ    J$632D
        BIT     6,(IX+0)
        JR      Z,J$6342
        RL      C
        RL      C
J$6342: LD      (IY+0),C
        LD      (IY+1),C
        LD      BC,8
        ADD     IY,BC
        DEC     E
        JR      NZ,J$6322
        LD      BC,I$FFF2
        ADD     IY,BC
        DEC     D
        JR      NZ,J$631D
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$6359: LD      IY,HOLD8
        CALL    C$6364
        LD      IY,HOLD8+16
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$6364: LD      B,04H   ; 4 
J$6366: LD      A,(IY+0)
        RRCA
        RRCA
        LD      C,A
        AND     3CH     ; "<"
        LD      (IY+0),A
        LD      (IY+1),A
        LD      A,C
        RRCA
        RRCA
        AND     0F0H
        LD      (IY+8),A
        LD      (IY+9),A
        INC     IY
        INC     IY
        DJNZ    J$6366
        RET

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.6386: PUSH    BC
        CALL    C$6395
        LD      A,(LINLEN)
        NEG
        ADD     A,B
        INC     A
        AND     A
        RRA
        POP     BC
        RET

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$6395: LD      A,(IX+0)
        AND     07H     ; 7 
        LD      BC,I$080A
        CP      02H     ; 2 
        JR      Z,J.63AF
        LD      BC,I$4050
        CP      05H     ; 5 
        JR      Z,J.63AF
        CP      06H     ; 6 
        JR      Z,J.63AF
        LD      BC,I$2028
J.63AF: BIT     6,(IX+0)
        RET     Z
        LD      B,C
        RET
J$63B6: CP      02H     ; 2 
        JP      Z,J$64D4
        LD      E,10H   ; 16 
        JR      J$63C6
J$63BF: CP      02H     ; 2 
        JP      Z,J$64D8
        LD      E,08H   ; 8 
J$63C6: LD      A,L
        DEC     A
        ADD     A,A
        LD      L,A
        LD      A,H
        DEC     A
        ADD     A,A
        BIT     6,(IX+0)
        JR      NZ,J$6405
        ADD     A,A
        ADD     A,A
        LD      H,L
        LD      L,A
        LD      A,(VDP.DR)
        LD      C,A
        INC     C
        LD      A,E
        LD      E,L
        LD      D,H
        CALL    C.67CF
        LD      HL,HOLD8
        LD      B,A
        DEC     C
J$63E7: OUTI
        JP      NZ,J$63E7
        INC     C
        LD      L,E
        LD      H,D
        INC     H
        CALL    C.67CF
        LD      HL,HOLD8+16
        LD      B,A
        DEC     C
J$63F8: OUTI
        JP      NZ,J$63F8
        INC     C
        EX      DE,HL
        SET     5,H
        LD      B,A
        JP      J.6746
J$6405: LD      B,A
        ADD     A,A
        ADD     A,B
        LD      H,L
        LD      L,A
        LD      A,(VDP.DR)
        LD      C,A
        INC     C
        LD      A,E
        CP      08H     ; 8 
        LD      IY,HOLD8
        JR      Z,C.6426
        PUSH    HL
        CALL    C.6426
        POP     HL
        LD      A,06H   ; 6 
        ADD     A,L
        LD      L,A
        LD      IY,HOLD8+8
        INC     C
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.6426: LD      A,L
        RES     0,L
        RES     1,L
        RES     2,L
        AND     07H     ; 7 
        LD      D,03H   ; 3 
        JR      Z,C.6476
        CP      02H     ; 2 
        JR      Z,J$646D
        CP      06H     ; 6 
        JR      Z,J$6454
        LD      D,04H   ; 4 
        PUSH    HL
        CALL    C.64AD
        POP     HL
        LD      D,0F0H
        PUSH    IY
        CALL    C.6476
        POP     IY
        INC     C
        LD      DE,I.DF08
        ADD     HL,DE
        LD      D,3FH   ; "?"
        JR      C.6476
J$6454: LD      D,02H   ; 2 
        PUSH    HL
        CALL    C.64AD
        POP     HL
        LD      D,0FCH
        PUSH    IY
        CALL    C.6476
        POP     IY
        INC     C
        LD      DE,I.DF08
        ADD     HL,DE
        LD      D,0FH   ; 15 
        JR      C.6476
J$646D: LD      D,0FEH
        PUSH    HL
        CALL    C.64AD
        POP     HL
        LD      D,0C0H
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.6476: PUSH    BC
        CALL    C.648C
        LD      BC,8
        ADD     IY,BC
        POP     BC
        INC     H
        CALL    C.648C
        DEC     H
        SET     5,H
J$6487: LD      B,08H   ; 8 
        JP      J.6746
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.648C: PUSH    HL
        CALL    C.67D1
        DEC     C
        LD      HL,PATWRK
        LD      B,08H   ; 8 
J$6496: IN      A,(C)
        AND     D
        LD      E,A
        LD      A,D
        CPL
        AND     (IY+0)
        OR      E
        LD      (HL),A
        INC     HL
        INC     IY
        DJNZ    J$6496
        POP     HL
        PUSH    HL
        LD      B,08H   ; 8 
        JP      J.6623
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.64AD: PUSH    IY
        POP     HL
        CALL    C$64B7
        LD      A,08H   ; 8 
        ADD     A,L
        LD      L,A
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$64B7: LD      E,08H   ; 8 
        BIT     7,D
        JR      NZ,J.64C8
J$64BD: LD      B,D
        LD      A,(HL)
J$64BF: RLCA
        DJNZ    J$64BF
        LD      (HL),A
        INC     HL
        DEC     E
        JR      NZ,J$64BD
        RET
J.64C8: LD      B,D
        LD      A,(HL)
J$64CA: RRCA
        INC     B
        JR      NZ,J$64CA
        LD      (HL),A
        INC     HL
        DEC     E
        JR      NZ,J.64C8
        RET
J$64D4: LD      E,02H   ; 2 
        JR      J$64DA
J$64D8: LD      E,01H   ; 1 
J$64DA: LD      A,L
        DEC     A
        ADD     A,A
        LD      L,A
        LD      A,H
        DEC     A
        CALL    C.679F
        LD      H,L
        LD      L,A
        LD      A,(VDP.DR)
        LD      C,A
        DEC     E
        LD      DE,HOLD8
        JR      Z,C.6504
        PUSH    HL
        CALL    C.6504
        POP     HL
        BIT     6,(IX+0)
        LD      DE,32
        JR      Z,J$6500
        LD      DE,24
J$6500: ADD     HL,DE
        LD      DE,HOLD8+8
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.6504: PUSH    HL
        CALL    C$650F
        LD      DE,16
        ADD     HL,DE
        EX      DE,HL
        POP     HL
        INC     H
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$650F: INC     C
        CALL    C.67CF
        EX      DE,HL
        DEC     C
        BIT     6,(IX+0)
        LD      E,04H   ; 4 
        JR      Z,J.651F
        LD      E,03H   ; 3 
J.651F: PUSH    HL
        LD      B,08H   ; 8 
J$6522: RL      (HL)
        LD      A,(BAKCLR)
        JP      NC,J$652D
        LD      A,(FORCLR)
J$652D: ADD     A,A
        ADD     A,A
        ADD     A,A
        ADD     A,A
        LD      D,A
        RL      (HL)
        LD      A,(BAKCLR)
        JP      NC,J$653D
        LD      A,(FORCLR)
J$653D: AND     0FH     ; 15 
        OR      D
        OUT     (C),A
        INC     HL
        DJNZ    J$6522
        POP     HL
        DEC     E
        JR      NZ,J.651F
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.654A: LD      A,(BAKCLR)
        JR      J$6552
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.654F: LD      A,(FORCLR)
J$6552: PUSH    HL
        ADD     A,A
        ADD     A,A
        ADD     A,A
        ADD     A,A
        LD      HL,BAKCLR
        OR      (HL)
        POP     HL
        RET
J$655D: CP      02H     ; 2 
        JP      Z,J$662D
        LD      A,L
        DEC     A
        ADD     A,A
        LD      L,A
        LD      A,H
        DEC     A
        ADD     A,A
        BIT     6,(IX+0)
        JR      NZ,J$65AE
        ADD     A,A
        ADD     A,A
        LD      H,L
        LD      L,A
        LD      A,(VDP.DR)
        LD      C,A
        INC     C
        BIT     0,E
        JR      NZ,J$659F
        BIT     1,E
        LD      B,08H   ; 8 
        JR      Z,J$6584
        LD      B,10H   ; 16 
J$6584: PUSH    BC
        PUSH    HL
        CALL    C.658C
        POP     HL
        POP     BC
        INC     H
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.658C: CALL    C.67D1
        DEC     C
        IN      A,(C)
        INC     C
        CPL
        CALL    C.67CF
        DEC     C
        OUT     (C),A
        INC     C
        INC     HL
        DJNZ    C.658C
        RET
J$659F: INC     H
        LD      B,06H   ; 6 
        CALL    C$65A8
        BIT     1,E
        RET     Z
;
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$65A8: INC     L
        INC     L
        LD      B,06H   ; 6 
        JR      C.658C
J$65AE: LD      B,A
        ADD     A,A
        ADD     A,B
        LD      H,L
        LD      L,A
        LD      A,(VDP.DR)
        LD      C,A
        INC     C
        BIT     1,E
        JR      Z,C.65C5
        PUSH    HL
        CALL    C.65C5
        POP     HL
        LD      A,06H   ; 6 
        ADD     A,L
        LD      L,A
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.65C5: LD      A,L
        RES     1,L
        RES     2,L
        AND     07H     ; 7 
        LD      D,0FCH
        JR      Z,C.65F8
        CP      02H     ; 2 
        JR      Z,J$65F6
        CP      06H     ; 6 
        JR      Z,J$65E7
        LD      D,0FH   ; 15 
        CALL    C.65F8
        LD      A,E
        LD      DE,I.FF08
        ADD     HL,DE
        LD      E,A
        LD      D,0C0H
        JR      C.65F8
J$65E7: LD      D,03H   ; 3 
        CALL    C.65F8
        LD      A,E
        LD      DE,I.FF08
        ADD     HL,DE
        LD      E,A
        LD      D,0F0H
        JR      C.65F8
J$65F6: LD      D,3FH   ; "?"
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.65F8: BIT     0,E
        CALL    Z,C$65FE
        INC     H
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$65FE: PUSH    HL
        LD      B,08H   ; 8 
        BIT     0,E
        JR      Z,J$6609
        INC     HL
        INC     HL
        LD      B,06H   ; 6 
J$6609: CALL    C.67D1
        DEC     C
        LD      HL,PATWRK
J$6610: IN      A,(C)
        XOR     D
        LD      (HL),A
        INC     HL
        DJNZ    J$6610
        POP     HL
        PUSH    HL
        LD      B,08H   ; 8 
        BIT     0,E
        JR      Z,J.6623
        INC     HL
        INC     HL
        LD      B,06H   ; 6 
J.6623: INC     C
        CALL    C.67CF
I$6627: LD      HL,PATWRK
        JP      J$67F7
J$662D: LD      A,L
        DEC     A
        ADD     A,A
        LD      L,A
        LD      A,H
        DEC     A
        CALL    C.679F
        LD      H,L
        LD      L,A
        LD      A,(VDP.DR)
        LD      C,A
        INC     C
        LD      A,(FORCLR)
        LD      D,A
        LD      A,(BAKCLR)
        XOR     D
        LD      D,A
        ADD     A,A
        ADD     A,A
        ADD     A,A
        ADD     A,A
        OR      D
        LD      D,A
        BIT     0,E
        JR      NZ,J$667E
        BIT     1,E
        LD      B,20H   ; " "
        LD      E,18H
        JR      Z,J$665C
        LD      B,40H   ; "@"
        LD      E,30H   ; "0"
J$665C: BIT     6,(IX+0)
        JR      Z,J$6663
        LD      B,E
J$6663: PUSH    BC
        PUSH    HL
        CALL    C.666B
        POP     HL
        POP     BC
        INC     H
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.666B: CALL    C.67D1
        DEC     C
        IN      A,(C)
        INC     C
        XOR     D
        CALL    C.67CF
        DEC     C
        OUT     (C),A
        INC     C
        INC     HL
        DJNZ    C.666B
        RET
J$667E: INC     H
        PUSH    DE
        CALL    C$6687
        POP     DE
        BIT     1,E
        RET     Z
;
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$6687: LD      E,04H   ; 4 
        BIT     6,(IX+0)
        JR      Z,J.6690
        DEC     E
J.6690: INC     L
        INC     L
        LD      B,06H   ; 6 
        CALL    C.666B
        DEC     E
        JR      NZ,J.6690
        RET
J$669B: PUSH    AF
        LD      A,D
        ADD     A,A
        ADD     A,A
        ADD     A,A
        ADD     A,A
        LD      E,A
        LD      A,L
        ADD     A,A
        LD      H,A
        LD      L,00H
        LD      A,(VDP.DR)
        LD      C,A
        INC     C
        POP     AF
        CP      02H     ; 2 
        JR      Z,C.66BA
        PUSH    DE
        PUSH    HL
        SET     5,H
        CALL    C.66BA
        POP     HL
        POP     DE
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.66BA: CALL    C.67DC
        DEC     H
        DEC     H
        CALL    C.67EE
        INC     H
        INC     H
        LD      A,L
        ADD     A,20H   ; " "
        LD      L,A
        JR      NC,J$66CB
        INC     H
J$66CB: DEC     E
        JR      NZ,C.66BA
        RET
J$66CF: PUSH    AF
        LD      A,D
        ADD     A,A
        ADD     A,A
        ADD     A,A
        ADD     A,A
        LD      E,A
        LD      A,L
        DEC     A
        ADD     A,A
        DEC     A
        LD      H,A
        LD      L,0E0H
        LD      A,(VDP.DR)
        LD      C,A
        INC     C
        POP     AF
        CP      02H     ; 2 
        JR      Z,C.66F0
        PUSH    DE
        PUSH    HL
        SET     5,H
        CALL    C.66F0
        POP     HL
        POP     DE
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.66F0: CALL    C.67DC
        INC     H
        INC     H
        CALL    C.67EE
        DEC     H
        DEC     H
        LD      A,L
        SUB     20H     ; " "
        LD      L,A
        JR      NC,J$6701
        DEC     H
J$6701: DEC     E
        JR      NZ,C.66F0
        RET
J$6705: LD      BC,(VDP.DR)
        INC     C
        CP      02H     ; 2 
        JR      Z,J$674B
        LD      A,L
        DEC     A
        ADD     A,A
        LD      L,A
        LD      A,H
        DEC     A
        ADD     A,A
        BIT     6,(IX+0)
        JR      Z,J$6734
        LD      B,A
        ADD     A,A
        ADD     A,B
        LD      H,L
        LD      L,A
        AND     07H     ; 7 
        JR      Z,J.6739
        RES     1,L
        RES     2,L
        PUSH    HL
        CALL    C$676C
        INC     C
        POP     HL
        LD      A,L
        ADD     A,08H   ; 8 
        LD      L,A
        JR      J.6739
J$6734: ADD     A,A
        ADD     A,A
        RET     C
        LD      H,L
        LD      L,A
J.6739: LD      A,L
        NEG
        LD      B,A
        PUSH    BC
        XOR     A
        CALL    C.675D
        POP     BC
        DEC     H
        SET     5,H
J.6746: CALL    C.654F
        JR      C.675D
J$674B: LD      A,L
        DEC     A
        ADD     A,A
        LD      L,A
        LD      A,H
        DEC     A
        CALL    C.679F
        RET     C
        LD      H,L
        LD      L,A
        NEG
        LD      B,A
        CALL    C.654A
;
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.675D: PUSH    BC
        CALL    C$6763
        POP     BC
        INC     H
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$6763: CALL    C.67CF
        DEC     C
J$6767: OUT     (C),A
        DJNZ    J$6767
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$676C: LD      D,0C0H
        CP      02H     ; 2 
        JR      Z,J.677A
        LD      D,0FCH
        CP      06H     ; 6 
        JR      Z,J.677A
        LD      D,0F0H
J.677A: CALL    C.6787
        INC     H
        CALL    C.6787
        DEC     H
        SET     5,H
        JP      J$6487
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.6787: PUSH    HL
        LD      B,08H   ; 8 
        CALL    C.67D1
        DEC     C
        LD      HL,PATWRK
J$6791: IN      A,(C)
        AND     D
        LD      (HL),A
        INC     HL
        DJNZ    J$6791
        POP     HL
        PUSH    HL
        LD      B,08H   ; 8 
        JP      J.6623
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.679F: ADD     A,A
        ADD     A,A
        ADD     A,A
        LD      B,A
        ADD     A,A
        BIT     6,(IX+0)
        JR      NZ,J$67AB
        LD      B,A
J$67AB: ADD     A,B
        RET
J$67AD: CP      02H     ; 2 
        JR      Z,J$67C3
        XOR     A
        LD      L,A
J$67B3: LD      H,A
        CALL    C$67BD
        CALL    C.654F
        LD      HL,I$2000
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$67BD: LD      BC,I$1800
        JP      FILVRM

J$67C3: CALL    C.654A
        LD      HL,0
        LD      BC,I.0800
        JP      FILVRM

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.67CF: SET     6,H
I$67D0  EQU     $-1
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.67D1: DI
        OUT     (C),L
        EI
        OUT     (C),H
        EX      (SP),HL
        EX      (SP),HL
        RES     6,H
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.67DC: PUSH    HL
        CALL    C.67D1
        LD      HL,HOLD8
        LD      B,20H   ; " "
        DEC     C
J$67E6: INI
        JP      NZ,J$67E6
        INC     C
        POP     HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.67EE: PUSH    HL
        CALL    C.67CF
        LD      HL,HOLD8
        LD      B,20H   ; " "
J$67F7: DEC     C
J$67F8: OUTI
        JP      NZ,J$67F8
        INC     C
        POP     HL
        RET

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C$6800: LD      A,(HOKVLD)
        RRCA
        CCF                             ; EXTBIO valid ?
        RET     C                       ; nope, quit
        LD      HL,-64
        ADD     HL,SP
        LD      A,H
        CP      HIGH 0C000H             ; stack in page 3 ?
        RET     C                       ; nope, quit
        LD      SP,HL
        PUSH    HL                      ; workspace on stack
        IN      A,(0A8H)
        AND     0C0H
        RLCA
        RLCA
        LD      HL,D.FCC1
        LD      C,A
        LD      B,00H
        ADD     HL,BC
        LD      A,(HL)
        AND     80H
        JR      Z,J$682E
        INC     HL
        INC     HL
        INC     HL
        INC     HL
        LD      A,(HL)
        AND     0C0H
        RRCA
        RRCA
        RRCA
        SCF
        RRA
J$682E: OR      C
        LD      B,A
        LD      DE,1000H
        POP     HL
        PUSH    HL
        CALL    EXTBIO                  ; MSX-JE function 0 ()
        POP     DE
        OR      A
        SBC     HL,DE                   ; found MSX-JE ?
        JR      Z,J$684E                ; nope, quit
        SRA     L
        SRA     L
        LD      B,L                     ; number of MSX-JE
J$6843: LD      A,(DE)
        INC     DE
        AND     07H                     ; MSX-JE with virtual terminal input interface AND dictonary interface
        JR      Z,J$6851                ; yep,
        INC     DE
        INC     DE
        INC     DE
        DJNZ    J$6843                  ; next MSX-JE
J$684E: SCF                             ; no MSX-JE found
        JR      J$6858

J$6851: EX      DE,HL
        LD      A,(HL)                  ; slotid MSX-JE
        INC     HL
        LD      E,(HL)
        INC     HL
        LD      D,(HL)                  ; jump table MSX-JE
        OR      A                       ; MSX-JE found
J$6858: PUSH    AF
        LD      HL,64+2
        ADD     HL,SP
        POP     AF
        LD      SP,HL
        RET     C                       ; no MSX-JE, quit
        PUSH    AF
        PUSH    DE
        PUSH    AF
        POP     IY
        PUSH    DE
        POP     IX
        LD      A,1
        CALL    CALSLT                  ; MSX-JE INQUIRY
        PUSH    BC
        LD      HL,353
        ADD     HL,BC
        EX      DE,HL                   ; MIN2 + 353
        LD      HL,(HIMEM)
        AND     A
        SBC     HL,DE
        LD      (HIMEM),HL              ; allocate memory
        LD      A,(D.FFA7)
        CP      0C9H                    ; disk environment ?
        JR      Z,J$6886
        LD      (D$F349),HL             ; yep, adjust
J$6886: POP     BC                      ; MSX-JE MIN2
        POP     DE                      ; MSX-JE jumptable
        POP     AF                      ; MSX-JE slotid
        POP     IX
        LD      SP,HL
        PUSH    IX
        PUSH    BC
        PUSH    AF
        PUSH    DE
        CALL    C.41F9                  ; get KANJI workspace
        LD      (IX+4),L
        LD      (IX+5),H                ; workarea
        PUSH    HL
        POP     IY
        LD      (IY+0),21H
        LD      (IY+3),0F7H
        LD      (IY+7),0C9H
        CALL    C.69EA
        XOR     A
        LD      (IY+8),A
        LD      (IY+9),A
        LD      (IY+10),A
        LD      DE,353
        ADD     HL,DE
        LD      (IY+1),L
        LD      (IY+2),H                ; MSX-JE workarea
        POP     DE
        POP     AF
        LD      (IY+4),A                ; slotid MSX-JE
        LD      (IY+5),E
        LD      (IY+6),D                ; MSX-JE entry
        POP     DE
        LD      (IY+15),E
        LD      (IY+16),D               ; MSX-JE MIN2
        RET

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.68D3: CALL    C.68E2
        DI
        LDIR
        EI
        RET

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C$68DB: CALL    C.68E2
        EX      DE,HL
        LDIR
        RET

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.68E2: PUSH    IY
        POP     HL
        LD      DE,17
        ADD     HL,DE
        LD      DE,FNKSTR
        LD      BC,80
        RET

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C$68F0: CALL    C$48FA
        CALL    C$68FC
        PUSH    AF
        CALL    C$4911
        POP     AF
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$68FC: CALL    C.7E50
        JP      Z,J$7476                ; No MSX-JE,
        LD      L,(IY+9)
        LD      H,(IY+10)
        LD      A,L
        OR      H
        JP      NZ,J$6994
J.690D: BIT     1,(IY+8)
        JR      NZ,J$6965
        CALL    C.69AE
        JR      C,J$694C
        BIT     0,(IY+8)
        JR      NZ,J$6931
        LD      A,03H   ; 3 
        CALL    C.6A74
        CALL    C.68D3
        CALL    C.6A27
        CALL    NC,C.6B21
J$692C: CALL    C.6A36
        JR      J.690D
J$6931: CALL    C$68DB
        LD      E,(IY+15)
        LD      D,(IY+16)
        LD      A,02H   ; 2 
        CALL    C.6A74
        LD      A,04H   ; 4 
        CALL    C.6A74
        CALL    C.6A43
        CALL    C$6ACD
        JR      J$692C
J$694C: BIT     0,(IY+8)
        JR      Z,J.69AB
        CP      01H     ; 1 
        JR      Z,J$695E
        CP      20H     ; " "
        JR      C,J.69AB
        CP      7FH
        JR      Z,J.69AB
J$695E: CALL    C$6B94
        SET     1,(IY+8)
J$6965: LD      A,06H   ; 6 
        CALL    C.6A74
        BIT     2,A
        JR      Z,J$6975
        CALL    C.69EA
        RES     1,(IY+8)
J$6975: RRCA
        PUSH    AF
        CALL    C,C$6AA2
        POP     AF
        RRCA
        JP      NC,J.690D
        LD      A,07H   ; 7 
        CALL    C.6A74
        LD      A,(HL)
        AND     A
        JP      Z,J.690D
        LD      A,(GETPNT)
        LD      (IY+14),A
        LD      A,80H
        LD      (GETPNT),A
J$6994: LD      B,(HL)
        INC     HL
        LD      A,(HL)
        AND     A
        JR      NZ,J$69A3
        LD      A,(IY+14)
        LD      (GETPNT),A
        LD      HL,0
J$69A3: LD      (IY+9),L
        LD      (IY+10),H
        LD      A,B
        RET

J.69AB: JP      CHGET

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.69AE: PUSH    IY
        PUSH    IX
        CALL    CHSNS
        POP     IX
        POP     IY
        JR      Z,C.69AE
        LD      HL,(GETPNT)
        LD      A,(HL)
        CP      20H     ; " "
        JR      NZ,J$69CE
        LD      A,06H   ; 6 
        CALL    SNSMAT
        AND     02H     ; 2 
        JR      Z,J$69DD
        LD      A,20H   ; " "
J$69CE: CP      18H
        SCF
        RET     NZ
        LD      A,06H   ; 6 
        CALL    SNSMAT
        AND     04H     ; 4 
        LD      A,18H
        SCF
        RET     NZ
J$69DD: CALL    KILBUF
        LD      A,(IY+8)
        XOR     01H     ; 1 
        AND     0FDH
        LD      (IY+8),A

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.69EA: PUSH    HL
        PUSH    AF
        PUSH    IY
        POP     HL
        LD      BC,97
        ADD     HL,BC
        EX      DE,HL
        PUSH    DE
        LD      HL,NORUSE
        DI
        RES     5,(HL)
        LD      HL,(GETPNT)
        LD      B,0
J.6A00: LD      A,(PUTPNT)
        CP      L
        JR      Z,J$6A0F
        LD      A,(HL)
        LD      (DE),A
        CALL    C.58D3
        INC     DE
        INC     B
        JR      J.6A00
J$6A0F: POP     DE
        LD      A,B
        AND     A
        JR      Z,J$6A23
        LD      HL,(GETPNT)
        LD      (PUTPNT),HL
J$6A1A: LD      A,(DE)
        PUSH    BC
        CALL    C$58B4
        POP     BC
        INC     DE
        DJNZ    J$6A1A
J$6A23: EI
        POP     AF
        POP     HL
        RET

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.6A27: CALL    C.6B84
        RET     NC
        BIT     2,(IY+8)
        JR      NZ,C.6A36
        XOR     A
        LD      (CNSDFG),A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.6A36: PUSH    IY
        PUSH    IX
        CALL    C$4B10
        POP     IX
        POP     IY
        SCF
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.6A43: SET     2,(IY+8)
        LD      A,(CNSDFG)
        AND     A
        RET     NZ
        CALL    C.6B84
        RET     NC
        RES     2,(IY+8)
        LD      A,(CSRY)
        LD      B,A
        LD      A,(CRTCNT)
        CP      B
        JR      NZ,J$6A6E
        LD      L,01H   ; 1 
        PUSH    IY
        CALL    C.49F5
        POP     IY
        LD      A,(CSRY)
        DEC     A
        LD      (CSRY),A
J$6A6E: LD      A,0FFH
        LD      (CNSDFG),A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.6A74: PUSH    IY
        PUSH    IX
        CALL    C$6A81
        EI
        POP     IX
        POP     IY
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$6A81: EXX
        EX      AF,AF'
        LD      HL,0
        ADD     HL,SP
        LD      A,H
        CP      0C1H
        JR      NC,C.6A9E
        EX      DE,HL
        PUSH    IY
        POP     HL
        LD      BC,I.0161
        ADD     HL,BC
        LD      SP,HL
        PUSH    DE
        CALL    C.6A9E
        EXX
        POP     HL
        LD      SP,HL
        EXX
        RET

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.6A9E: EX      AF,AF'
        EXX
        JP      (IY)

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$6AA2: LD      A,(IX+2)
        PUSH    AF
        LD      (IX+2),00H
        CALL    C$6AB2
        POP     AF
        LD      (IX+2),A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$6AB2: CALL    C.6AD0
J$6AB5: LD      A,(HL)
        INC     HL
        AND     A
        JR      Z,C.6AD0
        CALL    C$6ADF
        JR      J$6AB5
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$6ABF: CALL    C.7E50
        BIT     0,(IY+8)
        RET     Z
        CALL    C.7E50
        JP      Z,C.7753                ; No MSX-JE,
;
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$6ACD: CALL    C.6B21
;
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.6AD0: PUSH    HL
        CALL    C.6B6E
        LD      E,00H
        PUSH    IY
        CALL    C.5CED
        POP     IY
        POP     HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$6ADF: CP      0CH     ; 12 
        JR      Z,C.6B21
        CP      05H     ; 5 
        JR      Z,J$6B25
        CP      08H     ; 8 
        JR      Z,J$6B32
        CP      12H     ; 18 
        JR      Z,J$6B44
        CP      18H
        JR      Z,J$6B47
        CP      1AH
        JR      Z,J$6B4D
        CP      10H     ; 16 
        RET     C
        CP      20H     ; " "
        INC     HL
        RET     C
        DEC     HL
        PUSH    HL
        LD      HL,(FORCLR)
        PUSH    HL
        LD      L,(IY+12)
        LD      H,(IY+13)
        LD      (FORCLR),HL
        LD      C,A
        CALL    C.6B6E
        PUSH    IY
        CALL    C.58DC
        POP     IY
        INC     (IY+11)
        POP     HL
        LD      (FORCLR),HL
        POP     HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.6B21: LD      (IY+11),01H     ; 1 
J$6B25: PUSH    HL
        CALL    C.6B6E
        PUSH    IY
        CALL    C.600F
        POP     IY
        POP     HL
        RET
J$6B32: PUSH    HL
        DEC     (IY+11)
        CALL    C.6B6E
        LD      C,20H   ; " "
        PUSH    IY
        CALL    C.58DC
        POP     IY
        POP     HL
        RET
J$6B44: LD      A,(HL)
        INC     HL
        RET
J$6B47: LD      A,(HL)
        INC     HL
        LD      (IY+11),A
        RET
J$6B4D: LD      A,(IX+0)
        AND     07H     ; 7 
        CP      07H     ; 7 
        LD      A,(HL)
        JR      Z,J$6B65
        AND     0FH     ; 15 
        LD      (IY+13),A
        LD      A,(HL)
        RRCA
        RRCA
        RRCA
        RRCA
        AND     0FH     ; 15 
        JR      J$6B69
J$6B65: LD      (IY+13),A
        CPL
J$6B69: LD      (IY+12),A
        INC     HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.6B6E: LD      HL,(CRTCNT)
        LD      H,(IY+11)
        CALL    C.6B84
        RET     C
        LD      L,19H
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.6B7B: CALL    C.7E50
        BIT     0,(IY+8)
        SCF
        RET     Z

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.6B84: LD      A,(IX+0)
        AND     07H     ; 7 
        CP      04H     ; 4 
        RET     C
        LD      A,(IX+0)
        BIT     7,A
        RET     NZ
        SCF
        RET

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$6B94: PUSH    IY
        POP     HL
        LD      BC,97
        ADD     HL,BC
        EX      DE,HL
        PUSH    DE
        LD      HL,NORUSE
        DI
        SET     5,(HL)
        LD      HL,(GETPNT)
        LD      B,00H
J$6BA8: LD      A,(PUTPNT)
        CP      L
        JR      Z,J$6BB7
        LD      A,(HL)
        LD      (DE),A
        CALL    C.58D3
        INC     DE
        INC     B
        JR      J$6BA8
J$6BB7: POP     DE
        LD      A,B
        AND     A
        JR      Z,J$6BED
        LD      HL,(GETPNT)
J$6BBF: LD      A,(DE)
        CALL    C.4982
        JR      C,J$6BE3
        DEC     B
        JR      Z,J$6BEA
        PUSH    BC
        LD      B,A
        INC     DE
        LD      A,(DE)
        LD      C,A
        CALL    C.621D
        CP      04H     ; 4 
        LD      A,C
        POP     BC
        JR      NZ,J$6BE7
        PUSH    HL
        PUSH    BC
        LD      C,A
        LD      B,00H
        LD      HL,I.7372
        ADD     HL,BC
        ADD     HL,BC
        LD      A,(HL)
        POP     BC
        POP     HL
J$6BE3: LD      (HL),A
        CALL    C.58D3
J$6BE7: INC     DE
        DJNZ    J$6BBF
J$6BEA: LD      (PUTPNT),HL
J$6BED: EI
        RET

;         Subroutine LPTOUT hander
;            Inputs  ________________________
;            Outputs ________________________

J$6BEF: EI
        PUSH    HL
        LD      HL,RAWPRT
        INC     (HL)
        DEC     (HL)
        POP     HL
        RET     NZ
        PUSH    AF
        PUSH    AF
        CALL    C.41F9                  ; get KANJI workspace
        LD      A,(IX+3)
        AND     A
        LD      (IX+3),00H
        JR      NZ,J$6C29
        POP     AF
        CP      0DH     ; 13 
        JR      Z,J$6C1B
        CP      20H     ; " "
        CCF
        JR      NC,J$6C1E
        CALL    C.4982
        JR      C,J$6C23
        LD      (IX+3),A
        JR      J.6C44
J$6C1B: CALL    C$6C65
I$6C1C  EQU     $-2
J$6C1E: CALL    NC,C.6C7F
        JR      J.6C44
J$6C23: PUSH    HL
        PUSH    BC
        LD      C,A
        XOR     A
        JR      J$6C38
J$6C29: EX      (SP),HL
        PUSH    BC
        LD      B,A
        LD      C,H
        CALL    C.621D
        LD      B,A
        LD      A,C
        ADD     A,20H   ; " "
        LD      C,A
        LD      A,B
        ADD     A,20H   ; " "
J$6C38: CALL    C$6C4B
        CALL    NC,C.6C7F
        LD      A,C
        CALL    NC,C.6C7F
        POP     BC
        POP     HL
J.6C44: EX      (SP),HL
        LD      A,H
        POP     HL
        CALL    C.4583
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$6C4B: AND     A
        BIT     4,(IX+1)
        RET     NZ
        PUSH    BC
        LD      B,A
        LD      A,1BH
        CALL    C.6C7F
        LD      A,4BH   ; "K"
        CALL    NC,C.6C7F
        LD      A,B
        POP     BC
        RET     C
        SET     4,(IX+1)
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$6C65: AND     A
        BIT     4,(IX+1)
        RET     Z
        PUSH    BC
        LD      B,A
        LD      A,1BH
        CALL    C.6C7F
        LD      A,48H   ; "H"
        CALL    NC,C.6C7F
        LD      A,B
        POP     BC
        RET     C
        RES     4,(IX+1)
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.6C7F: PUSH    AF
        LD      A,0C9H
        LD      (D.FFB6),A
        POP     AF
        CALL    LPTOUT
        CALL    C,C.6C92
        LD      A,0F7H
        LD      (D.FFB6),A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.6C92: BIT     4,(IX+1)
        SCF
        RET     Z
J.6C98: LD      IX,BREAKX
        CALL    C.6CCA
        JR      C,J.6C98
        LD      IX,LPTSTT
        CALL    C.6CCA
        SCF
        RET     Z
        LD      A,0DH   ; 13 
        CALL    C.6CC6
        EI
        JR      C,J.6C98
        LD      A,1BH
        CALL    C.6CC6
        JR      C,J.6C98
J$6CB8  EQU     $-1
        LD      A,48H   ; "H"
        CALL    C.6CC6
        JR      C,J.6C98
        RES     4,(IX+1)
        SCF
        RET

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.6CC6: LD      IX,LPTOUT

;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.6CCA: JP      C.4561
?.6CCD: CALL    C.7126
        PUSH    DE
        CALL    C.7174
        PUSH    DE
        LD      C,00H
        LD      A,B
        AND     A
        JR      Z,J.6D17
        LD      DE,BUF
        PUSH    HL
        POP     IX
J$6CE1: LD      A,(IX+0)
        INC     IX
        CALL    C.4982
        JP      NC,J$6D01
        CALL    C$6D23
        JR      C,J.6D0F
        PUSH    BC
        LD      B,H
        LD      C,L
        CALL    C.7104
        LD      H,B
        LD      L,C
        POP     BC
        LD      A,H
        LD      (DE),A
        INC     DE
        INC     C
        LD      A,L
        JR      J.6D0F
J$6D01: LD      (DE),A
        INC     DE
        INC     C
        JP      Z,J.712D
        DEC     B
        JR      Z,J.6D17
        LD      A,(IX+0)
        INC     IX
J.6D0F: LD      (DE),A
        INC     DE
        INC     C
        JP      Z,J.712D
        DJNZ    J$6CE1
J.6D17: POP     HL
        EX      (SP),HL
        LD      A,C
        CALL    C.7188
        POP     HL
        CALL    C.7152
        ADD     HL,HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$6D23: CP      0A6H
        JR      C,C.6D7F
        CP      0B0H
        JR      Z,C.6D7F
        CP      0DEH
        JR      NC,C.6D7F
        CP      0DCH
        LD      HL,I$256F
        RET     Z
        CP      0B3H
        JR      NZ,J$6D4E
        LD      A,B
        DEC     A
        LD      HL,I$2526
        RET     Z
        LD      A,(IX+0)
        CP      0DEH
        SCF
        CCF
        RET     NZ
        INC     IX
        DEC     B
        LD      HL,I$2574
        RET
J$6D4E: PUSH    DE
        LD      E,20H   ; " "
        LD      HL,I.7372
J$6D54: INC     E
        INC     HL
        INC     HL
        CP      (HL)
        JR      NZ,J$6D54
        PUSH    DE
        LD      A,B
        DEC     A
        JR      Z,J.6D79
        LD      A,(IX+0)
        CP      0DEH
        JR      Z,J$6D6D
        CP      0DFH
        JR      NZ,J.6D79
        INC     E
        INC     HL
        INC     HL
J$6D6D: INC     E
        INC     HL
        INC     HL
        INC     HL
        CP      (HL)
        JR      NZ,J.6D79
        POP     AF
        DEC     B
        INC     IX
        PUSH    DE
J.6D79: POP     HL
        LD      H,25H   ; "%"
        POP     DE
        AND     A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.6D7F: CP      30H     ; "0"
        JR      C,J$6D87
        CP      3AH     ; ":"
        JR      C,J.6D97
J$6D87: CP      41H     ; "A"
        JR      C,J$6D8F
        CP      5BH     ; "["
        JR      C,J.6D97
J$6D8F: CP      61H     ; "a"
        JR      C,J.6D9C
        CP      7BH     ; "{"
        JR      NC,J.6D9C
J.6D97: LD      H,23H   ; "#"
        LD      L,A
        AND     A
        RET
J.6D9C: PUSH    BC
        LD      HL,I$7473
        LD      BC,42
        CPDR
        LD      L,C
        LD      H,B
        POP     BC
        SCF
        RET     NZ
        PUSH    BC
        LD      BC,I$7420
        ADD     HL,BC
        POP     BC
        LD      L,(HL)
        LD      H,21H   ; "!"
        RET
?.6DB4: CALL    C.7126
        PUSH    DE
        CALL    C.7174
        PUSH    DE
        LD      C,00H
        LD      A,B
        AND     A
        JP      Z,J$6E40
        LD      DE,BUF
        PUSH    HL
        POP     IX
J$6DC9: LD      A,(IX+0)
        INC     IX
        CALL    C.4982
        JR      C,J.6E3B
        LD      H,A
        LD      A,B
        DEC     A
        LD      A,H
        JR      Z,J.6E3B
        LD      L,(IX+0)
        INC     IX
        DEC     B
        PUSH    BC
        LD      B,H
        LD      C,L
        CALL    C.70F9
        LD      H,B
        LD      L,C
        POP     BC
        LD      A,H
        CP      21H     ; "!"
        JR      NZ,J$6E07
        LD      A,L
        PUSH    HL
        PUSH    BC
        LD      HL,I.7449
        LD      BC,42
        CPDR
        JR      NZ,J$6E03
        LD      HL,I.744A
        ADD     HL,BC
        LD      A,(HL)
        POP     BC
        POP     HL
        JR      J$6E0C
J$6E03: POP     BC
        POP     HL
        JR      J.6E2D
J$6E07: CP      23H     ; "#"
        JR      NZ,J$6E11
        LD      A,L
J$6E0C: LD      HL,I$6E1A
        JR      J$6E23
J$6E11: CP      24H     ; "$"
        JR      Z,J$6E19
        CP      25H     ; "%"
        JR      NZ,J.6E2D
J$6E19: PUSH    BC
I$6E1A: LD      H,00H
        ADD     HL,HL
        LD      BC,I$7332
        ADD     HL,BC
        POP     BC
        LD      A,(HL)
J$6E23: LD      (DE),A
        INC     DE
        INC     C
        INC     HL
        LD      A,(HL)
        AND     A
        JR      NZ,J.6E3B
        JR      J$6E3E
J.6E2D: PUSH    BC
        LD      B,H
        LD      C,L
        CALL    C.7104
        LD      H,B
        LD      L,C
        POP     BC
        LD      A,H
        LD      (DE),A
        INC     DE
        INC     C
        LD      A,L
J.6E3B: LD      (DE),A
        INC     DE
        INC     C
J$6E3E: DJNZ    J$6DC9
J$6E40: POP     HL
        EX      (SP),HL
        LD      A,C
        CALL    C.7188
        POP     HL
        CALL    C.7152
        ADD     HL,HL
        RET
?.6E4C: CALL    C.7126
        PUSH    DE
        CALL    C.7174
        PUSH    DE
        LD      A,(HL)
        CALL    C.4982
        JR      C,J$6E71
        LD      A,B
        CP      02H     ; 2 
        JP      C,J.7130
        SCF
        JR      J$6E80
?.6E63: CALL    C.7126
        PUSH    DE
        CALL    C.7174
        PUSH    DE
        LD      A,(HL)
        CALL    C.4982
        JR      NC,J$6E7A
J$6E71: DEC     B
        INC     B
        JP      Z,J.7130
        LD      C,02H   ; 2 
        JR      J$6E90
J$6E7A: LD      A,B
        CP      02H     ; 2 
        JP      C,J.7130
J$6E80: LD      B,(HL)
        INC     HL
        LD      C,(HL)
        CALL    NC,C.70F9
        LD      A,C
        CALL    C.71AC
        LD      (BUF+2),HL
        LD      C,04H   ; 4 
        LD      A,B
J$6E90: CALL    C.71AC
        LD      (BUF+0),HL
        POP     HL
        EX      (SP),HL
        LD      A,C
        CALL    C.7188
        POP     HL
        CALL    C.7152
        ADD     HL,HL
        RET
?.6EA2: CALL    C.7126
        PUSH    DE
        CALL    C.7174
        PUSH    BC
        PUSH    HL
        EX      DE,HL
        CALL    C.7152
        INC     L
        CALL    C.716B
        CP      02H     ; 2 
        JP      NC,J.7130
        POP     IX
        POP     BC
        PUSH    HL
        LD      L,A
        LD      C,00H
        LD      A,B
        AND     A
        JR      Z,J.6EEF
        LD      DE,BUF
J$6EC6: LD      A,(IX+0)
        INC     IX
        CALL    C.4982
        BIT     0,L
        JR      Z,J$6EE1
        JR      C,J.6EED
        LD      (DE),A
        INC     DE
        INC     C
        DEC     B
        JR      Z,J.6EEF
        LD      A,(IX+0)
        INC     IX
C$6EDE  EQU     $-1
        JR      J.6EEA
J$6EE1: JR      C,J.6EEA
        DEC     B
        JR      Z,J.6EEF
        INC     IX
        JR      J.6EED
J.6EEA: LD      (DE),A
        INC     DE
        INC     C
J.6EED: DJNZ    J$6EC6
J.6EEF: POP     HL
        EX      (SP),HL
        LD      A,C
        CALL    C.7188
        POP     HL
        CALL    C.7152
        ADD     HL,HL
        RET
?.6EFB: CALL    C.7126
        PUSH    DE
        CALL    C.7174
        PUSH    HL
        PUSH    BC
        EX      DE,HL
        CALL    C.7152
        INC     L
        CALL    C.716B
        AND     A
        JP      Z,J.7130
        PUSH    AF
        LD      A,(HL)
        CP      2CH     ; ","
        LD      E,0FFH
        JR      NZ,J$6F1E
        CALL    C.7159
        CALL    C.716B
J$6F1E: POP     AF
        LD      D,A
        POP     BC
        EX      (SP),HL
        LD      C,00H
        LD      A,B
        AND     A
        JR      Z,J.6F5F
        LD      A,E
        AND     A
        JR      Z,J.6F5F
J$6F2C: DEC     D
        JR      Z,J$6F3E
        LD      A,(HL)
        INC     HL
        CALL    C.4982
        JR      C,J$6F3A
        DEC     B
        JR      Z,J.6F5F
        INC     HL
J$6F3A: DJNZ    J$6F2C
        JR      J.6F5F
J$6F3E: LD      IX,BUF
J$6F42: LD      A,(HL)
        LD      (IX+0),A
        INC     HL
        INC     IX
        INC     C
        CALL    C.4982
        JR      C,J$6F5A
        DEC     B
        JR      Z,J.6F5F
        LD      A,(HL)
        LD      (IX+0),A
        INC     HL
        INC     IX
        INC     C
J$6F5A: DEC     E
        JR      Z,J.6F5F
        DJNZ    J$6F42
J.6F5F: POP     HL
        EX      (SP),HL
        LD      A,C
        CALL    C.7188
        POP     HL
        CALL    C.7152
        ADD     HL,HL
        RET
?.6F6B: CALL    C.7126
        PUSH    DE
        CALL    C.7174
        PUSH    DE
        LD      A,B
        CP      04H     ; 4 
        JP      NZ,J.7130
        LD      D,(HL)
        INC     HL
        LD      E,(HL)
        INC     HL
        CALL    C.71BF
        LD      B,A
        LD      D,(HL)
        INC     HL
        LD      E,(HL)
        CALL    C.71BF
        LD      C,A
        BIT     7,B
        CALL    P,C.7104
        LD      A,B
        LD      (BUF+0),A
        LD      A,C
        LD      (BUF+1),A
        POP     HL
        EX      (SP),HL
        LD      A,02H   ; 2 
        CALL    C.7188
        POP     HL
        CALL    C.7152
        ADD     HL,HL
        RET
?.6FA2: CALL    C.7120
        PUSH    DE
        PUSH    AF
        CALL    C.7165
        LD      A,(VALTYP)
        CP      03H     ; 3 
        LD      A,01H   ; 1 
        JR      Z,J$6FCF
        INC     A
        PUSH    HL
        CALL    C.715F
        LD      HL,(DAC+2)
        LD      A,H
        AND     A
        JP      NZ,J.7130
        LD      A,L
        AND     A
        JP      Z,J.7130
        POP     HL
        PUSH    AF
        CALL    C.7152
        INC     L
        CALL    C.7165
        POP     AF
J$6FCF: PUSH    AF
        CALL    C$7177
        PUSH    HL
        PUSH    BC
        EX      DE,HL
        CALL    C.7152
        INC     L
        CALL    C.7174
        POP     IX
        POP     IY
        POP     AF
        PUSH    DE
        PUSH    HL
        PUSH    BC
        PUSH    IX
        POP     BC
        PUSH    IY
        POP     HL
        LD      D,A
        LD      C,00H
        LD      A,B
        AND     A
        JR      Z,J.7038
J$6FF2: INC     C
        DEC     D
        JR      Z,J$7005
        LD      A,(HL)
        INC     HL
        CALL    C.4982
        JR      C,J$7001
        DEC     B
        JR      Z,J.7038
        INC     HL
J$7001: DJNZ    J$6FF2
        JR      J.7038
J$7005: POP     AF
        POP     DE
        PUSH    BC
        EX      (SP),HL
        LD      H,L
        EX      (SP),HL
        LD      C,A
J$700C: PUSH    BC
        PUSH    DE
        PUSH    HL
J$700F: LD      A,C
        AND     A
        JR      Z,J$703E
        LD      A,B
        AND     A
        JR      Z,J$7036
        LD      A,(DE)
        CP      (HL)
        JR      NZ,J$7021
        INC     DE
        INC     HL
        DEC     B
        DEC     C
        JR      J$700F
J$7021: POP     HL
        POP     DE
        POP     BC
        POP     AF
        INC     A
        PUSH    AF
        LD      A,(HL)
        INC     HL
        CALL    C.4982
        JR      C,J$7032
        DEC     B
        JR      Z,J.7039
        INC     HL
J$7032: DJNZ    J$700C
        JR      J.7039
J$7036: POP     AF
        POP     AF
J.7038: POP     AF
J.7039: POP     AF
        XOR     A
        JP      J.70BD
J$703E: POP     AF
        POP     AF
        POP     AF
        POP     AF
        JR      J.70BD
?.7044: CALL    C.7120
        PUSH    DE
        PUSH    AF
        CALL    C.7174
        PUSH    HL
        PUSH    BC
        EX      DE,HL
        LD      A,(HL)
        CP      2CH     ; ","
        LD      A,00H
        JR      NZ,J$705C
        CALL    C.7159
        CALL    C.716B
J$705C: CP      03H     ; 3 
        JR      NC,J.70B2
        POP     BC
        EX      (SP),HL
        LD      D,A
        LD      C,00H
        LD      E,00H
        LD      A,B
        AND     A
        JR      Z,J.707A
J$706B: LD      A,(HL)
        INC     HL
        INC     C
        CALL    C.4982
        JR      C,J$7078
        DEC     B
        JR      Z,J.707A
        INC     E
        INC     HL
J$7078: DJNZ    J$706B
J.707A: DEC     D
        LD      A,C
        JP      M,J.70BD
        LD      A,E
        JR      NZ,J.70BD
        LD      A,C
        SUB     E
        JR      J.70BD
?.7086: CALL    C.7120
        PUSH    DE
        PUSH    AF
        CALL    C.7174
        LD      A,B
        AND     A
        JR      Z,J.70B2
        PUSH    HL
        PUSH    BC
        EX      DE,HL
        CALL    C.7152
        INC     L
        CALL    C.716B
        AND     A
        JR      Z,J.70B2
        POP     BC
        EX      (SP),HL
        LD      C,A
J$70A2: DEC     C
        JR      Z,J$70B5
        LD      A,(HL)
        INC     HL
        CALL    C.4982
        JR      C,J$70B0
        DEC     B
        JR      Z,J.70B2
        INC     HL
J$70B0: DJNZ    J$70A2
J.70B2: JP      J.7130
J$70B5: LD      A,(HL)
        CALL    C.4982
        CCF
        LD      A,00H
        RLA
J.70BD: LD      C,A
        POP     HL
        POP     AF
        EX      (SP),HL
        LD      (VALTYP),A
        LD      B,00H
        LD      (DAC+2),BC
        CALL    C$70D3
        POP     HL
        CALL    C.7152
        ADD     HL,HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$70D3: PUSH    HL
        LD      HL,VALTYP
        LD      A,(HL)
        LD      C,A
        LD      (HL),02H        ; 2 
        LD      HL,DAC+2
        CP      02H     ; 2 
        JR      Z,J$70F3
        CP      04H     ; 4 
        JR      Z,J$70EB
        CP      08H     ; 8 
        JP      NZ,J.712A
J$70EB: PUSH    BC
        CALL    C.715F
        POP     BC
        LD      HL,DAC
J$70F3: LD      B,00H
        POP     DE
        LDIR
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.70F9: CALL    C.621D
        ADD     A,20H   ; " "
        LD      B,A
        LD      A,C
        ADD     A,20H   ; " "
        LD      C,A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.7104: LD      A,B
        DEC     A
        SRL     A
        ADD     A,71H   ; "q"
        CP      0A0H
        JR      C,J$7110
        ADD     A,40H   ; "@"
J$7110: BIT     0,B
        LD      B,A
        LD      A,C
        JR      NZ,J$7118
        ADD     A,5EH   ; "^"
J$7118: ADD     A,1FH
        LD      C,A
        CP      7FH
        RET     C
J$711E: INC     C
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.7120: CALL    C.713C
        RET     NZ
        JR      J.712A
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.7126: CALL    C.713C
        RET     Z
J.712A: LD      E,0DH   ; 13 
        LD      BC,I$0F1E
J.712D  EQU     $-2
        LD      BC,I$051E
J.7130  EQU     $-2
        LD      BC,I$021E
J$7133  EQU     $-2
        LD      IX,I$406F
        JP      C.41FE
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.713C: CALL    C.7152
        JR      Z,J$711E
        LD      HL,I$5EA4
        CALL    C.41FE
        EI
        CALL    C.7152
        INC     L
        LD      A,(VALTYP)
        CP      03H     ; 3 
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.7152: LD      A,(HL)
        EX      (SP),HL
        CP      (HL)
        INC     HL
        EX      (SP),HL
        JR      NZ,J$7133
;
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.7159: LD      IX,I$4666
        JR      J.716F
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.715F: LD      IX,I$517A
        JR      J.716F
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.7165: LD      IX,I$4C64
        JR      J.716F
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.716B: LD      IX,I$521C
J.716F: CALL    C.41FE
        EI
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.7174: CALL    C.7165
;
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$7177: PUSH    HL
        LD      IX,I$67D0
        CALL    C.41FE
        EI
        LD      B,(HL)
        INC     HL
        LD      A,(HL)
        INC     HL
        LD      H,(HL)
        LD      L,A
        POP     DE
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.7188: PUSH    HL
        PUSH    AF
        LD      IX,I$6627
        CALL    C.41FE
        EI
        LD      DE,(DSCTMP+1)
        LD      HL,BUF
        POP     AF
        AND     A
        JR      Z,J$71A2
        LD      C,A
        LD      B,00H
        LDIR
J$71A2: POP     DE
        LD      HL,DSCTMP
        LD      BC,3
        LDIR
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.71AC: PUSH    AF
        RRCA
        RRCA
        RRCA
        RRCA
        CALL    C$71B6
        LD      L,A
        POP     AF
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$71B6: AND     0FH     ; 15 
J$71B7  EQU     $-1
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$71B8: CP      0AH     ; 10 
        SBC     A,69H   ; "i"
        DAA
        LD      H,A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.71BF: LD      A,D
        CALL    C.71CE
        ADD     A,A
        ADD     A,A
        ADD     A,A
        ADD     A,A
        LD      D,A
        LD      A,E
        CALL    C.71CE
        OR      D
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.71CE: SUB     30H     ; "0"
        JR      C,J.7231
        CP      0AH     ; 10 
        RET     C
        SUB     07H     ; 7 
        CP      0AH     ; 10 
        JR      C,J.7231
        CP      10H     ; 16 
        RET     C
J$71DE: SUB     20H     ; " "
        CP      0AH     ; 10 
        JR      C,J.7231
        CP      10H     ; 16 
        RET     C
        JR      J.7231
?.71E9: LD      A,(IDBYT2)
        AND     A                       ; MSX1 ?
        JR      Z,J.7231                ; yep,
        DEC     HL
        CALL    C.7159
        JR      Z,J$7234
        CALL    C.7152
        JR      Z,J$7238
        RRCA
        CALL    C$7229
        PUSH    AF
        CALL    C.7223
        ADD     A,A
        ADD     A,A
        ADD     A,A
        ADD     A,A
        PUSH    AF
        CALL    C.7223
        POP     BC
        LD      C,A
        PUSH    BC
        CALL    C.7223
        POP     DE
        OR      D
        LD      D,A
        CALL    C.7152
        ADD     HL,HL
        POP     BC
        CALL    C.7248
        OUT     (C),D
        EX      (SP),HL
        EX      (SP),HL
        EI
        OUT     (C),E
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.7223: CALL    C.7152
        INC     L
        LD      A,07H   ; 7 
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$7229: PUSH    AF
        CALL    C.716B
        POP     AF
        CP      E
        LD      A,E
        RET     NC
J.7231: JP      J.7130
J$7234: PUSH    HL
        LD      B,00H
I$7236  EQU     $-1
        CALL    C.7248
J$7238  EQU     $-2
        LD      HL,I$7254
        LD      B,20H   ; " "
J$723F: OUTI
        EX      (SP),HL
        EX      (SP),HL
        JR      NZ,J$723F
        EI
        POP     HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.7248: LD      C,10H   ; 16 
        CALL    WRTVDP
        LD      A,(VDP.DR)
        ADD     A,02H   ; 2 
        LD      C,A
        RET
I$7254: DEFB    0,0,0,0
        LD      DE,I$3306
        RLCA
        RLA
        LD      BC,I$0327
        LD      D,C
        LD      BC,I$0627
        LD      (HL),C
        LD      BC,I$0373
        LD      H,C
        LD      B,64H   ; "d"
        LD      B,11H   ; 17 
        INC     B
        LD      H,L
        LD      (BC),A
        LD      D,L
        DEC     B
        LD      (HL),A
        RLCA
I$7274: NOP
        INC     B
        EX      AF,AF'
        INC     C
        EX      AF,AF'
        INC     C
        EX      AF,AF'
        INC     C
        DJNZ    J$7292
        JR      J$729C
?.7280: JR      J$729E
?.7282: JR      J$72A0
?.7284: JR      NZ,J$72AA
        JR      Z,J$72B4
        JR      Z,J$72B6
        JR      Z,J$72B8
        JR      NC,J$72C2
        JR      C,J$72CC
        JR      C,J$72CE
J$7292: JR      C,J$72D0
        LD      B,B
        LD      B,H
        LD      C,B
        LD      C,H
        LD      C,B
        LD      C,H
        LD      C,B
        LD      C,H
J$729C: LD      D,B
        LD      D,H
J$729E: LD      E,B
        LD      E,H
J$72A0: LD      E,B
        LD      E,H
        LD      E,B
        LD      E,H
        LD      H,B
        LD      H,H
        LD      L,B
        LD      L,H
        LD      L,B
        LD      L,H
J$72AA: LD      L,B
        LD      L,H
        LD      (HL),B
        LD      (HL),H
        LD      A,B
        LD      A,H
        LD      A,B
        LD      A,H
        LD      A,B
        LD      A,H
J$72B4: LD      B,B
        LD      B,H
J$72B6: LD      C,B
        LD      C,H
J$72B8: LD      C,B
        LD      C,H
        LD      C,B
        LD      C,H
        LD      D,B
        LD      D,H
        LD      E,B
        LD      E,H
        LD      E,B
        LD      E,H
J$72C2: LD      E,B
        LD      E,H
        LD      H,B
        LD      H,H
        LD      L,B
        LD      L,H
        LD      L,B
        LD      L,H
        LD      L,B
        LD      L,H
J$72CC: LD      (HL),B
        LD      (HL),H
J$72CE: LD      A,B
        LD      A,H
J$72D0: LD      A,B
        LD      A,H
        LD      A,B
        LD      A,H
        LD      B,B
        LD      B,H
        LD      C,B
        LD      C,H
        LD      C,B
        LD      C,H
        LD      C,B
        LD      C,H
        LD      D,B
        LD      D,H
        LD      E,B
        LD      E,H
        LD      E,B
        LD      E,H
        LD      E,B
        LD      E,H
        LD      H,B
        LD      H,H
        LD      L,B
        LD      L,H
        LD      L,B
        LD      L,H
        LD      L,B
        LD      L,H
        LD      (HL),B
        LD      (HL),H
        LD      A,B
        LD      A,H
        LD      A,B
        LD      A,H
        LD      A,B
        LD      A,H
        ADD     A,B
        ADD     A,H
        ADC     A,B
        ADC     A,H
        ADC     A,B
        ADC     A,H
        ADC     A,B
        ADC     A,H
        SUB     B
        SUB     H
        SBC     A,B
        SBC     A,H
        SBC     A,B
        SBC     A,H
        SBC     A,B
        SBC     A,H
        AND     B
        AND     H
        XOR     B
        XOR     H
        XOR     B
        XOR     H
        XOR     B
        XOR     H
        OR      B
        OR      H
        CP      B
        CP      H
        CP      B
        CP      H
        CP      B
        CP      H
        RET     NZ
        CALL    NZ,C.CCC8
        RET     Z
        CALL    Z,C.CCC8
        RET     NC
        CALL    NC,C.DCD8
        RET     C
        CALL    C,C.DCD8
        RET     PO
        CALL    PO,C.ECE8
        RET     PE
        CALL    PE,C.ECE8
        RET     P
        CALL    P,C.FCF8
        RET     M
        CALL    M,C.FCF8
I$7332  EQU     $-2
        RET     NZ
        CALL    NZ,C.CCC8
        RET     Z
        CALL    Z,C.CCC8
        RET     NC
        CALL    NC,C.DCD8
        RET     C
        CALL    C,C.DCD8
        RET     PO
        CALL    PO,C.ECE8
        RET     PE
        CALL    PE,C.ECE8
        RET     P
        CALL    P,C.FCF8
        RET     M
        CALL    M,C.FCF8
        RET     NZ
        CALL    NZ,C.CCC8
        RET     Z
        CALL    Z,C.CCC8
        RET     NC
        CALL    NC,C.DCD8
        RET     C
        CALL    C,C.DCD8
        RET     PO
        CALL    PO,C.ECE8
        RET     PE
        CALL    PE,C.ECE8
        RET     P
        CALL    P,C.FCF8
        RET     M
        CALL    M,C.FCF8
I.7372  EQU     $-2
I$7374: AND     A
        NOP
        OR      C
        NOP
        XOR     B
        NOP
        OR      D
        NOP
        XOR     C
        NOP
        OR      E
        NOP
        XOR     D
        NOP
        OR      H
        NOP
        XOR     E
        NOP
        OR      L
        NOP
        OR      (HL)
        NOP
        OR      (HL)
        SBC     A,0B7H
        NOP
        OR      A
        SBC     A,0B8H
        NOP
        CP      B
        SBC     A,0B9H
        NOP
        CP      C
        SBC     A,0BAH
        NOP
        CP      D
        SBC     A,0BBH
        NOP
        CP      E
        SBC     A,0BCH
        NOP
        CP      H
        SBC     A,0BDH
        NOP
        CP      L
        SBC     A,0BEH
        NOP
        CP      (HL)
        SBC     A,0BFH
        NOP
        CP      A
        SBC     A,0C0H
        NOP
        RET     NZ
        SBC     A,0C1H
        NOP
        POP     BC
        SBC     A,0AFH
        NOP
        JP      NZ,J$C200
        SBC     A,0C3H
        NOP
        JP      J$C4DE
J$73C2  EQU     $-1
?.73C3: NOP
        CALL    NZ,C$C5DE
        NOP
        ADD     A,00H
        RST     00H
        NOP
        RET     Z
        NOP
        RET
?.73CF: NOP
        JP      Z,J$CA00
        SBC     A,0CAH
        RST     18H
        RLC     B
        SET     3,(HL)
        SET     3,A
        CALL    Z,C$CC00
        SBC     A,0CCH
        RST     18H
        CALL    C$CD00
        SBC     A,0CDH
        RST     18H
        ADC     A,00H
        ADC     A,0DEH
        ADC     A,0DFH
        RST     08H
        NOP
        RET     NC
        NOP
        POP     DE
        NOP
        JP      NC,J$D300
        NOP
        XOR     H
        NOP
        CALL    NC,C$AD00
        NOP
        PUSH    DE
        NOP
        XOR     (HL)
        NOP
        SUB     00H
        RST     10H
        NOP
        RET     C
        NOP
        EXX
        NOP
        JP      C,J$DB00
        NOP
        CALL    C,C$DC00
        NOP
        OR      D
        NOP
        OR      H
        NOP
        AND     (HL)
        NOP
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        NOP
        CALL    C$B6DE
        NOP
        CP      C
        NOP
I$7420: LD      HL,I$492A
        LD      (HL),H
        LD      (HL),B
        LD      (HL),E
        LD      (HL),L
        LD      B,A
        LD      C,D
        LD      C,E
        HALT
?.742B: LD      E,H
        INC     H
        DEC     A
        DEC     H
        CCF
        DAA
        JR      Z,J$7496
        LD      H,C
        LD      H,H
        ADD     HL,HL
        LD      (HL),A
        LD      C,(HL)
        LD      L,A
        LD      C,A
        JR      NC,J$746E
        LD      B,(HL)
        LD      D,B
        LD      B,E
        LD      D,C
        LD      B,C
        INC     HL
        LD      D,(HL)
        LD      D,A
        LD      (D$3C26),HL
        LD      E,L
        DEC     HL
I.7449: INC     L
I.744A: JR      NZ,J$746D
        LD      (D$2423),HL
        DEC     H
        LD      H,27H   ; "'"
        JR      Z,J$747D
        LD      HL,(D$2C2B)
        DEC     L
        LD      L,2FH   ; "/"
        LD      A,(D$3C3B)
        DEC     A
        LD      A,3FH   ; "?"
        LD      B,B
        LD      E,E
        LD      E,H
        LD      E,L
        LD      E,(HL)
        LD      E,A
        LD      H,B
        LD      A,E
        LD      A,H
        LD      A,L
        LD      A,(HL)
        AND     C
        AND     D
J$746D: AND     E
J$746E: AND     H
        AND     L
        OR      B
        DEC     L
        SBC     A,0DFH
I$7473  EQU     $-1
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$7474: SCF
        RET
J$7476: LD      A,(IX+4)
        LD      (IX+4),00H
J$747D: AND     A
        JR      Z,J.7489
        PUSH    AF
        LD      A,(IX+7)
        LD      (GETPNT),A
        POP     AF
        RET
J.7489: CALL    C.69AE
        JR      C,J$74A7
        BIT     0,(IY+8)
        JR      NZ,J$749F
        CALL    C.6A27
J$7496  EQU     $-1
        LD      A,(BAKCLR)
        CALL    NC,C.775C
        JR      J.7489
J$749F: CALL    C.6A43
        CALL    C.7753
        JR      J.7489
J$74A7: BIT     0,(IY+8)
        JP      Z,C.7642
        CALL    C.7642
        CALL    C.75C5
        JP      NC,J$7561
J$74B7: CP      20H     ; " "
        RET     C
        CP      7FH
        RET     Z
        AND     A
        JP      P,J.7541
        CALL    C.4982
        JR      NC,J$74DA
        CP      80H
        RET     Z
        CP      0A6H
        JR      C,J.7541
        CP      0B0H
        JR      Z,J.7541
        CP      0DEH
        JR      C,J$7547
        CP      0E0H
        JR      C,J.7541
        RET
J$74DA: PUSH    AF
        CALL    C.7642
;
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$74DE: CP      9FH
        JR      C,J.74FD
        CP      0F2H
        JR      NC,J.74FD
        LD      C,A
        POP     AF
        CP      82H
        JR      Z,J$7505
        LD      (IX+4),C
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.74EF: PUSH    AF
        LD      A,(GETPNT)
        LD      (IX+7),A
        LD      A,80H
        LD      (GETPNT),A
        POP     AF
        RET
J.74FD: LD      (IX+4),A
        CALL    C.74EF
        POP     AF
        RET
J$7505: LD      A,C
        CALL    C$762C
        CALL    C.76C2
        CALL    C$75F5
J$750F: LD      C,00H
        LD      B,C
J$7512: CP      03H     ; 3 
        JR      NZ,J$751E
        LD      A,(D.FC9B)
        CP      03H     ; 3 
        JP      Z,C.7753
J$751E: CP      1BH
        JR      Z,J$75A2
        CP      0DH     ; 13 
        JR      Z,J$754E
        CALL    C$7653
        AND     A
        JR      Z,J$753C
        DEC     A
        PUSH    AF
        PUSH    BC
        LD      C,B
        CALL    Z,C.76E2
        POP     BC
        LD      B,C
        POP     AF
        CALL    NZ,C.7707
        CALL    C.76E2
J$753C: CALL    C.7642
        JR      J$7512
J.7541: CALL    C.6D7F
        RET     C
        JR      J$7554
J$7547: CALL    C$75B4
        LD      B,25H   ; "%"
        JR      J$7556
J$754E: CALL    C.76A9
        CALL    C.7753
J$7554: LD      C,L
        LD      B,H
J$7556: CALL    C.7104
        LD      (IX+4),C
        CALL    C.74EF
        LD      A,B
        RET
J$7561: LD      HL,SWPTMP+0
        LD      (HL),A
        INC     HL
        LD      B,03H   ; 3 
J$7568: CALL    C.7642
        CP      1BH
        JP      Z,J.7489
        CALL    C.75C5
        JP      C,J$74B7
        LD      (HL),A
        INC     HL
        DJNZ    J$7568
        LD      HL,SWPTMP+0
        LD      A,(HL)
        AND     7FH
        INC     HL
        ADD     A,A
        ADD     A,A
        ADD     A,A
        ADD     A,A
        OR      (HL)
        INC     HL
        LD      B,A
        LD      A,(HL)
        AND     7FH
        INC     HL
        ADD     A,A
        ADD     A,A
        ADD     A,A
        ADD     A,A
        OR      (HL)
        LD      L,A
        LD      H,B
        CALL    C.76C2
        CALL    C.7707
        LD      C,00H
        CALL    C.76E2
        CALL    C.7642
        JP      J$750F
J$75A2  EQU     $-2
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$75A4: CP      86H
        RET     C
        CP      0A0H
        JR      C,J$75B2
        CP      0E0H
        RET     C
        CP      0FEH
        CCF
        RET     C
J$75B2: XOR     20H     ; " "
C$75B3  EQU     $-1
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$75B4: CP      0DCH
        LD      C,6FH   ; "o"
        RET     Z
        LD      C,20H   ; " "
        LD      HL,I$7374
J$75BE: INC     C
        CP      (HL)
        INC     HL
        INC     HL
        JR      NZ,J$75BE
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.75C5: AND     A
        SCF
        RET     Z
        CP      07H     ; 7 
        JR      C,J$75E3
        CP      30H     ; "0"
        RET     C
        CP      3AH     ; ":"
        CCF
        RET     C
        PUSH    BC
        LD      B,A
        LD      A,06H   ; 6 
        CALL    SNSMAT
        AND     02H     ; 2 
        LD      A,B
        POP     BC
        SCF
        RET     NZ
        SUB     30H     ; "0"
        RET
J$75E3: ADD     A,09H   ; 9 
        CP      0CH     ; 12 
        SCF
        CCF
        RET     NZ
        LD      A,(D.FC9B)
        CP      03H     ; 3 
        SCF
        RET     Z
        LD      A,0CH   ; 12 
        AND     A
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$75F5: PUSH    IY
        LD      IY,SWPTMP
        LD      C,04H   ; 4 
J$75FD: INC     C
        DEC     C
        JR      Z,J$7618
        LD      (IY+0),A
        INC     IY
        LD      (IY+0),00H
        DEC     C
        CALL    C$7787
        CALL    C.7707
        PUSH    BC
        LD      C,00H
        CALL    C.76E2
        POP     BC
J$7618: CALL    C$7622
        CP      21H     ; "!"
        JR      NC,J$75FD
        POP     IY
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$7622: CALL    C.7642
        CALL    C.4982
        RET     C
        CALL    C.7642
;
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$762C: PUSH    BC
        PUSH    HL
        LD      C,A
        LD      B,00H
        LD      HL,I$7236
        ADD     HL,BC
        ADD     HL,BC
        LD      A,(HL)
        POP     HL
        POP     BC
        CP      0ACH
        RET     C
        CP      0AFH
        RET     NC
        ADD     A,28H   ; "("
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.7642: PUSH    IX
        PUSH    IY
J$7646: CALL    CHSNS
        JR      Z,J$7646
        CALL    CHGET
        POP     IY
        POP     IX
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$7653: CP      20H     ; " "
        JR      Z,J.766D
        CP      1CH
        JR      Z,J.766D
        CP      1DH
        JR      Z,J.767E
        CP      08H     ; 8 
        JR      Z,J.767E
        CP      1EH
        JR      Z,J$7684
        CP      1FH
        JR      Z,J$7675
        XOR     A
        RET
J.766D: INC     C
        LD      A,C
        CP      E
        LD      A,01H   ; 1 
        RET     C
        LD      C,00H
J$7675: PUSH    BC
        LD      C,E
        CALL    C.76A9
        POP     BC
        LD      A,02H   ; 2 
        RET
J.767E: DEC     C
        LD      A,01H   ; 1 
        RET     P
        LD      C,E
        DEC     C
J$7684: PUSH    BC
        LD      C,E
        CALL    C$768D
        POP     BC
        LD      A,02H   ; 2 
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$768D: LD      B,00H
        AND     A
        SBC     HL,BC
        LD      A,L
        SUB     21H     ; "!"
        RET     NC
        LD      L,7FH
        ADD     A,L
        LD      L,A
        DEC     H
        LD      A,H
        CP      2FH     ; "/"
        JR      NZ,J$76A3
        LD      H,28H   ; "("
        RET
J$76A3: CP      20H     ; " "
        RET     NZ
        LD      H,74H   ; "t"
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.76A9: LD      B,00H
        ADD     HL,BC
        LD      A,L
        SUB     7FH
        RET     C
        ADD     A,21H   ; "!"
        LD      L,A
        INC     H
        LD      A,H
        CP      29H     ; ")"
        JR      NZ,J$76BC
        LD      H,30H   ; "0"
        RET
J$76BC: CP      75H     ; "u"
        RET     NZ
        LD      H,21H   ; "!"
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.76C2: PUSH    AF
        LD      E,0FFH
        LD      A,(LINLEN)
J$76C8: INC     E
        SUB     03H     ; 3 
        JR      NC,J$76C8
        LD      A,E
        CP      0BH     ; 11 
        LD      D,01H   ; 1 
        JR      C,J$76E0
        LD      D,0FDH
        LD      A,(LINLEN)
J$76D9: INC     D
        SUB     0AH     ; 10 
        JR      NC,J$76D9
        LD      E,0AH   ; 10 
J$76E0: POP     AF
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.76E2: PUSH    HL
        PUSH    DE
        PUSH    BC
        PUSH    IY
        PUSH    IX
        CALL    C.6B6E
        LD      A,D
        ADD     A,02H   ; 2 
        LD      H,A
        XOR     A
        INC     C
J$76F2: DEC     C
        JR      Z,J$76F8
        ADD     A,H
        JR      J$76F2
J$76F8: LD      H,A
        INC     H
        LD      E,02H   ; 2 
        CALL    C.5CED
        POP     IX
        POP     IY
        POP     BC
        POP     DE
        POP     HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.7707: PUSH    HL
        PUSH    DE
        PUSH    BC
        PUSH    IY
        PUSH    IX
        LD      BC,(FORCLR)
        PUSH    BC
        LD      A,B
        LD      B,C
        LD      C,A
        LD      (FORCLR),BC
        LD      C,L
        LD      B,H
        CALL    C.6B6E
        LD      H,01H   ; 1 
J$7721: PUSH    BC
        CALL    C.7104
        LD      A,C
        LD      C,B
        CALL    C.58DC
        INC     H
        LD      C,A
        CALL    C.58DC
        INC     H
        LD      C,20H   ; " "
        PUSH    DE
J$7733: CALL    C.58DC
        INC     H
        DEC     D
        JR      NZ,J$7733
        POP     DE
        EX      (SP),HL
        LD      C,01H   ; 1 
        CALL    C.76A9
        LD      C,L
        LD      B,H
        POP     HL
        DEC     E
        JR      NZ,J$7721
        POP     HL
        LD      (FORCLR),HL
        POP     IX
        POP     IY
        POP     BC
        POP     DE
        POP     HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.7753: PUSH    AF
        LD      A,(FORCLR)
        CALL    C.775C
        POP     AF
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.775C: PUSH    HL
        PUSH    IY
        PUSH    IX
        LD      L,A
        LD      A,(BAKCLR)
        PUSH    AF
        LD      A,L
        LD      (BAKCLR),A
        CALL    C.6B6E
        LD      H,01H   ; 1 
        CALL    C.600F
        POP     AF
        LD      (BAKCLR),A
        CALL    C.6B6E
        LD      A,(LINLEN)
        INC     A
        LD      H,A
        CALL    C.600F
        POP     IX
        POP     IY
        POP     HL
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$7787: PUSH    DE
        LD      HL,SWPTMP
        LD      DE,I$2121
        PUSH    DE
        LD      DE,I$77E1
J$7792: LD      A,(DE)
        AND     A
        JR      Z,J.77AD
        CALL    C.77B0
        JR      Z,J$779D
J$779A  EQU     $-1
        JR      NC,J.77AD
J$779D: POP     AF
J$779E: INC     DE
        LD      A,(DE)
        ADD     A,A
        JR      C,J$779E
J$77A2  EQU     $-1
        PUSH    HL
        EX      DE,HL
        LD      E,(HL)
        INC     HL
        LD      D,(HL)
        INC     HL
        EX      DE,HL
        EX      (SP),HL
        JR      J$7792
J.77AD: POP     HL
        POP     DE
        RET
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C.77B0: PUSH    DE
        PUSH    HL
        DEC     DE
        DEC     HL
J$77B4: INC     DE
I$77B5: INC     HL
        LD      A,(DE)
        AND     A
        JP      P,J$77DA
J$77BB: CP      (HL)
        JR      Z,J$77B4
C$77BD  EQU     $-1
J$77BE: CP      0DEH
        JR      NZ,J$77CB
J$77C2: INC     DE
        CALL    C.77B0
J$77C6: POP     HL
        POP     DE
        RET     NZ
        INC     A
J$77CA: RET
J$77CB: LD      A,(HL)
        CP      0DEH
J$77CE: JR      NZ,J$77DC
        INC     HL
        CALL    C.77B0
        POP     HL
        POP     DE
J$77D6: RET     NZ
        SUB     01H     ; 1 
        RET
J$77DA: XOR     A
        JR      NZ,J$77F7
J$77DC  EQU     $-1
J$77DD: SUB     (HL)
        POP     HL
        POP     DE
        RET
I$77E1: OR      C
        LD      HL,D.B130
        OR      D
        DEC     H
        JR      NC,J$779A
        OR      L
        LD      HL,(D.B130)
        CP      B
        DEC     L
        JR      NC,J$77A2
        CP      E
        JR      NC,J$7824
        OR      C
        JP      NZ,J$3035
J$77F7  EQU     $-1
        OR      C
        JP      J$3038
?.77FC: OR      C
        CALL    NC,C$303C
        OR      C
        PUSH    DE
        LD      A,30H   ; "0"
        OR      C
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        LD      B,D
        JR      NC,J$77BB
        LD      C,D
        JR      NC,J$77BE
        OR      A
        LD      L,B
        JR      NC,J$77C2
        CP      B
        LD      L,C
        JR      NC,J$77C6
        CP      A
        LD      L,E
        JR      NC,J$77CA
        POP     BC
        LD      L,H
        JR      NC,J$77CE
        JP      NZ,J$306E
        OR      D
        RET     Z
        LD      (HL),B
        JR      NC,J$77D6
J$7824: LD      (IX+48),H
        OR      E
        LD      H,31H   ; "1"
        OR      E
        OR      (HL)
        LD      L,31H   ; "1"
        OR      E
        CP      L
        JR      NC,J$7863
        OR      E
        CP      L
        SBC     A,32H   ; "2"
        LD      SP,I$BFB3
        INC     SP
        LD      SP,I$C0B3
        INC     (HL)
        LD      SP,I$C2B3
        DEC     (HL)
        LD      SP,I$C5B3
        SCF
        LD      SP,I$D7B3
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$7849: LD      A,(D$B331)
        RET     C
        DEC     SP
        LD      SP,I$D9B3
        INC     A
        LD      SP,I$DCB3
        DEC     A
        LD      SP,I$DDB3
        LD      A,31H   ; "1"
        OR      H
        LD      B,C
        LD      SP,I$B2B4
        LD      B,E
        LD      SP,I$B7B4
J$7863  EQU     $-1
        LD      D,L
        LD      SP,I$C2B4
        LD      E,C
        LD      SP,I$C9B4
        LD      E,L
        LD      SP,I$DDB4
        LD      E,(HL)
        LD      SP,I$77B5
        LD      SP,I$B2B5
        LD      A,C
        LD      SP,I$B3B5
        LD      A,D
        LD      SP,I$B6B5
        INC     L
        LD      (D.B7B5),A
        DEC     L
        LD      (D.B7B5),A
        SBC     A,2EH   ; "."
        LD      (D$B8B5),A
        CPL
        LD      (D$B9B5),A
        INC     SP
        LD      (D$BDB5),A
        INC     (HL)
        LD      (D$C2B5),A
        DEC     (HL)
        LD      (D$DAB5),A
        LD      (HL),32H        ; "2"
        OR      L
        IN      A,(37H)
        LD      (D$DDB5),A
        JR      C,J$78D8
        OR      (HL)
        INC     A
        LD      (D.DEB6),A
        LD      H,H
        LD      (D$B2B6),A
        LD      (HL),B
        LD      (D.DEB6),A
        OR      D
        LD      L,33H   ; "3"
        OR      (HL)
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$78B7: OR      D
        RET     C
        DEC     A
        INC     SP
        OR      (HL)
        OR      A
        LD      B,B
        INC     SP
        OR      (HL)
        OR      A
        SBC     A,43H   ; "C"
        INC     SP
        OR      (HL)
        CP      B
        LD      B,H
        INC     SP
        OR      (HL)
        SBC     A,0B8H
        LD      E,B
        INC     SP
        OR      (HL)
        CP      C
        LD      E,L
        INC     SP
        OR      (HL)
        CP      E
        LD      E,(HL)
        INC     SP
        OR      (HL)
        CP      H
        LD      E,A
J$78D8: INC     SP
        OR      (HL)
        CP      H
        SBC     A,61H   ; "a"
        INC     SP
J$78DE: OR      (HL)
        RET     NZ
        LD      H,E
        INC     SP
        OR      (HL)
        JP      NZ,J$3364
        OR      (HL)
        PUSH    BC
        LD      (HL),B
        INC     SP
        OR      (HL)
        JP      Z,J$71DE
        INC     SP
        OR      (HL)
        CALL    Z,C$74DE
        INC     SP
        OR      (HL)
        RST     08H
        HALT
?.78F7: INC     SP
        OR      (HL)
        RET     NC
        LD      A,D
        INC     SP
        OR      (HL)
        OUT     (7BH),A
        INC     SP
        OR      (HL)
        CALL    NC,C$337C
        OR      (HL)
        PUSH    DE
        LD      HL,D.B634
        RET     C
        LD      (D.B634),HL
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        DEC     H
        INC     (HL)
        OR      (HL)
        SBC     A,0DDH
        LD      E,L
        INC     (HL)
        OR      A
        LD      L,E
        INC     (HL)
        OR      A
        SBC     A,36H   ; "6"
        DEC     (HL)
        OR      A
        CP      B
        LD      B,L
        DEC     (HL)
        OR      A
        POP     BC
        LD      C,B
        DEC     (HL)
        OR      A
        JP      NZ,J$3549
        OR      A
        RST     00H
        LD      C,(HL)
        DEC     (HL)
        OR      A
        CALL    NC,C$3551
        OR      A
        SBC     A,0D4H
        LD      D,H
        DEC     (HL)
        OR      A
        PUSH    DE
        LD      D,(HL)
        DEC     (HL)
        OR      A
        SBC     A,0D5H
        LD      L,L
        DEC     (HL)
        OR      A
        SUB     6EH     ; "n"
        DEC     (HL)
        OR      A
        SBC     A,0D6H
        LD      A,C
        DEC     (HL)
        OR      A
        SUB     0B3H
        LD      A,L
        DEC     (HL)
        OR      A
        SBC     A,0D6H
        OR      E
        LD      B,H
        LD      (HL),0B7H
        SUB     0B8H
        LD      C,C
        LD      (HL),0B7H
        SBC     A,0D6H
        CP      B
        LD      C,H
        LD      (HL),0B7H
        RET     C
        LD      C,L
        LD      (HL),0B7H
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        LD      C,A
        LD      (HL),0B7H
        SBC     A,0DDH
        LD      H,E
        LD      (HL),0B8H
        LD      H,L
        LD      (HL),0B8H
        SBC     A,71H   ; "q"
        LD      (HL),0B8H
        OR      D
        LD      (HL),H
        LD      (HL),0B8H
        OR      E
        LD      (HL),L
        LD      (HL),0B8H
J$7979  EQU     $-1
        SBC     A,0B3H
J$797C: HALT
?.797D: LD      (HL),0B8H
        CP      H
J$7980: LD      A,D
        LD      (HL),0B8H
        JP      NZ,J$367E
J$7984  EQU     $-2
        CP      B
        RST     08H
J$7988: DAA
        SCF
        CP      B
        RET     C
        LD      HL,(D$B837)
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        LD      L,37H   ; "7"
        CP      B
        SBC     A,0DDH
        LD      (D$B937),A
        DEC     (HL)
        SCF
        CP      C
        OR      D
        JR      C,J$79D5
        CP      C
        SBC     A,0B2H
        LD      E,L
        SCF
        CP      C
        SBC     A,0B7H
        LD      H,B
        SCF
        CP      C
        RET     NZ
        LD      H,L
        SCF
        CP      C
        JP      NZ,J$3766
        CP      C
        SBC     A,0C2H
        LD      L,(HL)
        SCF
        CP      C
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        LD      L,A
        SCF
        CP      C
        SBC     A,0DDH
        DEC     (HL)
        JR      C,J$7979
        LD      B,E
        JR      C,J$797C
        SBC     A,5EH   ; "^"
        JR      C,J$7980
        OR      D
        LD      (HL),B
        JR      C,J$7984
        OR      E
        LD      (HL),D
        JR      C,J$7988
        SBC     A,0B3H
        LD      H,H
        ADD     HL,SP
        CP      D
        CP      B
        LD      L,(HL)
J$79D5: ADD     HL,SP
        CP      D
        SBC     A,0B8H
        HALT
?.79DA: ADD     HL,SP
        CP      D
        CP      H
        LD      (HL),A
        ADD     HL,SP
        CP      D
        JP      NZ,J$397A
        CP      D
        RST     08H
        LD      A,L
        ADD     HL,SP
        CP      D
        IN      A,(22H)
        LD      A,(D$DDBA)
        INC     HL
        LD      A,(D$33BB)
        LD      A,(D.DEBB)
        LD      B,C
        LD      A,(D$B2BB)
        LD      B,H
        LD      A,(D.DEBB)
        OR      D
        LD      E,(HL)
        LD      A,(D$B4BB)
        LD      H,E
        LD      A,(D$B6BB)
        LD      H,H
        LD      A,(D.B7BB)
        LD      L,C
        LD      A,(D.B7BB)
        SBC     A,6DH   ; "m"
        LD      A,(D$B8BB)
        LD      L,(HL)
        LD      A,(D$B9BB)
        LD      A,D
        LD      A,(D$BBBB)
        LD      A,E
        LD      A,(D$BCBB)
        SBC     A,7CH   ; "|"
        LD      A,(D$C2BB)
        LD      A,L
        LD      A,(D.DEBB)
        JP      NZ,J$3B28
        CP      E
        JP      Z,J$2ADE
        DEC     SP
        CP      E
        SET     3,(HL)
        INC     L
        DEC     SP
        CP      E
        JP      NC,J$3B2D
        CP      E
        RST     10H
        LD      L,3BH   ; ";"
        CP      E
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        JR      NC,J$7A7B
        CP      E
        SBC     A,0DDH
        LD      B,D
        DEC     SP
        CP      H
        LD      B,L
        DEC     SP
        CP      H
        SBC     A,76H   ; "v"
        DEC     SP
        CP      H
        OR      L
        LD      L,3CH   ; "<"
        CP      H
        OR      (HL)
        CPL
        INC     A
        CP      H
        OR      A
        JR      NC,J$7A94
        CP      H
        OR      A
        SBC     A,32H   ; "2"
        INC     A
        CP      H
        SBC     A,0B8H
        INC     SP
        INC     A
        CP      H
        CP      H
        DEC     (HL)
        INC     A
        CP      H
        POP     BC
        SCF
        INC     A
        CP      H
        JP      NZ,J$3C38
        CP      H
        SBC     A,0C2H
        LD      B,D
        INC     A
        CP      H
        RET
?.7A75: LD      B,H
        INC     A
        CP      H
        JP      Z,C.46DE
J$7A7A  EQU     $-1
J$7A7B: INC     A
        CP      H
        RST     08H
        LD      C,D
        INC     A
        CP      H
        CALL    NC,C$3C4B
        CP      H
        SBC     A,0D4H
        LD      E,B
        INC     A
        CP      H
        CALL    NC,C$5AB8
        INC     A
        CP      H
        SBC     A,0D4H
        CP      B
        LD      H,E
        INC     A
J$7A94: CP      H
        PUSH    DE
        LD      H,A
        INC     A
        CP      H
        SBC     A,0D5H
        LD      (HL),H
        INC     A
        CP      H
        PUSH    DE
        OR      E
        LD      A,H
        INC     A
        CP      H
        SBC     A,0D5H
        OR      E
        LD      A,(D$BC3D)
        PUSH    DE
        CP      B
        LD      B,A
        DEC     A
        CP      H
        SBC     A,0D5H
        CP      B
        LD      C,(HL)
        DEC     A
        CP      H
        PUSH    DE
        JP      NZ,J$3D50
;
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________
C$7AB8: CP      H
        SBC     A,0D5H
        JP      NZ,J$3D51
        CP      H
        PUSH    DE
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        LD      D,E
        DEC     A
        CP      H
        SBC     A,0D5H
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        LD      E,D
        DEC     A
        CP      H
        SUB     68H     ; "h"
        DEC     A
        CP      H
        SBC     A,0D6H
        LD      (HL),L
        DEC     A
        CP      H
        SUB     0B3H
        LD      A,L
        DEC     A
        CP      H
        SBC     A,0D6H
        OR      E
        LD      H,L
        LD      A,0BCH
        SUB     0B8H
        LD      A,H
        LD      A,0BCH
        SBC     A,0D6H
        CP      B
        DEC     HL
        CCF
        CP      H
        RET     C
        INC     L
        CCF
        CP      H
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        DEC     L
        CCF
        CP      H
        SBC     A,0DDH
        LD      C,L
        CCF
        CP      L
        LD      E,D
        CCF
        CP      L
        SBC     A,5EH   ; "^"
        CCF
        CP      L
        OR      D
        LD      H,C
        CCF
        CP      L
        SBC     A,0B2H
        LD      L,A
        CCF
        CP      L
        OR      E
        LD      (HL),D
        CCF
        CP      L
        OR      A
        SBC     A,79H   ; "y"
        CCF
        CP      L
        CP      C
        SBC     A,7BH   ; "{"
        CCF
        CP      L
        CP      L
        SBC     A,7DH   ; "}"
        CCF
        CP      (HL)
        INC     H
        LD      B,B
        CP      (HL)
        OR      D
        JR      Z,J$7B5F
        CP      (HL)
        SBC     A,0B2H
        LD      B,A
        LD      B,B
        CP      (HL)
        OR      A
        LD      C,C
        LD      B,B
        CP      (HL)
        JP      NZ,J$405A
        CP      (HL)
        SBC     A,0C2H
        LD      H,H
        LD      B,B
        CP      (HL)
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        LD      H,A
        LD      B,B
        CP      (HL)
        SBC     A,0DDH
        JR      NC,J$7B7B
        CP      (HL)
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        POP     BC
        JR      C,J$7B80
        CP      A
        ADD     HL,SP
        LD      B,C
        CP      A
        OR      E
        LD      C,(HL)
        LD      B,C
        CP      A
        SBC     A,0B3H
        LD      A,H
        LD      B,C
        CP      A
        CP      B
        DEC     H
        LD      B,D
        CP      A
        SBC     A,0B8H
        CPL
        LD      B,D
        CP      A
        JP      NZ,J$4234
        CP      A
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        JR      C,J$7B9E
        RET     NZ
        LD      A,42H   ; "B"
J$7B5F: RET     NZ
        SBC     A,43H   ; "C"
        LD      B,D
        RET     NZ
        OR      D
        LD      C,(HL)
        LD      B,D
        RET     NZ
        SBC     A,0B2H
        LD      H,L
        LD      B,D
        RET     NZ
        OR      (HL)
        LD      L,E
        LD      B,D
        RET     NZ
        CP      B
        LD      L,(HL)
        LD      B,D
        RET     NZ
        CP      C
        LD      A,E
        LD      B,D
        RET     NZ
        JP      NZ,J$4323
J$7B7B  EQU     $-1
        RET     NZ
        JP      J$4328
J$7B80: RET     NZ
        ADD     A,2BH   ; "+"
        LD      B,E
        RET     NZ
        SBC     A,0DAH
        CPL
        LD      B,E
        RET     NZ
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        JR      NC,J$7BD0
        RET     NZ
        SBC     A,0DDH
        LD      B,H
        LD      B,E
        POP     BC
        LD      C,L
        LD      B,E
        POP     BC
        CP      B
        LD      E,E
        LD      B,E
        POP     BC
        JP      NZ,J$4361
J$7B9D: POP     BC
J$7B9E: CALL    NC,C$4363
        POP     BC
        PUSH    DE
        LD      H,(HL)
        LD      B,E
        POP     BC
        SUB     74H     ; "t"
        LD      B,E
        POP     BC
        SUB     0B3H
        LD      A,D
        LD      B,E
        POP     BC
        SUB     0B8H
        INC     A
        LD      B,H
        POP     BC
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        CCF
        LD      B,H
        JP      NZ,J$4445
        JP      NZ,J$46B2
        LD      B,H
        JP      NZ,J$4BB3
        LD      B,H
        JP      NZ,J$4DB6
        LD      B,H
        JP      NZ,J$DEBC
        LD      D,H
        LD      B,H
        JP      NZ,J$DECE
        LD      E,D
J$7BCF: LD      B,H
J$7BD0: JP      NZ,J$5CCF
        LD      B,H
        JP      NZ,J$5FD8
        LD      B,H
        JP      J$4462
?.7BDB: JP      J$25DE
?.7BDE: LD      B,L
        JP      J$26B7
?.7BE2: LD      B,L
        JP      J$2FC2
?.7BE6: LD      B,L
        JP      J$35DD
?.7BEA: LD      B,L
        JP      C.DDDE
?.7BEE: LD      B,C
        LD      B,L
        CALL    NZ,C$4546
        CALL    NZ,C$58DE
        LD      B,L
        CALL    NZ,C$5DB3
        LD      B,L
        CALL    NZ,C$B3DE
        CPL
        LD      B,(HL)
        CALL    NZ,C$B9B3
        SBC     A,3DH   ; "="
        LD      B,(HL)
        CALL    NZ,C$3FB8
        LD      B,(HL)
        CALL    NZ,C.B8DE
        LD      B,A
        LD      B,(HL)
        CALL    NZ,C$4AC1
        LD      B,(HL)
        CALL    NZ,C$4CC2
        LD      B,(HL)
        CALL    NZ,C$DEC4
        LD      C,(HL)
        LD      B,(HL)
        CALL    NZ,C$52D7
        LD      B,(HL)
        CALL    NZ,C.55DD
        LD      B,(HL)
        CALL    NZ,C.DDDE
        LD      E,L
        LD      B,(HL)
        PUSH    BC
        LD      H,B
        LD      B,(HL)
        PUSH    BC
        OR      D
        LD      H,D
        LD      B,(HL)
        PUSH    BC
        OR      (HL)
        SBC     A,0D7H
        LD      H,E
        LD      B,(HL)
        PUSH    BC
        CP      A
        SBC     A,66H   ; "f"
        LD      B,(HL)
        PUSH    BC
        JP      NZ,J$4668
        PUSH    BC
        LD      L,(IX+70)
        ADD     A,73H   ; "s"
        LD      B,(HL)
        ADD     A,0B5H
        LD      (HL),A
        LD      B,(HL)
        ADD     A,0B8H
        LD      A,C
        LD      B,(HL)
        ADD     A,0C1H
        LD      A,H
        LD      B,(HL)
        ADD     A,0D5H
        LD      A,L
        LD      B,(HL)
        ADD     A,0D6H
        LD      HL,I$C647
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        INC     H
        LD      B,A
        RST     00H
        JR      Z,J$7CA8
        RET     Z
        ADD     HL,HL
        LD      B,A
        RET     Z
        CP      D
        DEC     L
        LD      B,A
        RET     Z
        JP      NZ,J$472E
        RET     Z
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        CPL
        LD      B,A
        RET
?.7C71: DEC     (HL)
        LD      B,A
        RET
?.7C74: OR      E
        ADD     HL,SP
        LD      B,A
        RET
?.7C78: CP      A
        SBC     A,41H   ; "A"
        LD      B,A
        JP      Z,J$4743
        JP      Z,J$4CDE
        LD      B,A
        JP      Z,J$50B2
        LD      B,A
        JP      Z,J$B2DE
        LD      E,H
        LD      B,A
        JP      Z,J$67B3
        LD      B,A
        JP      Z,J$DEB7
        LD      L,E
        LD      B,A
        JP      Z,J$6CB8
        LD      B,A
        JP      Z,C.B8DE
        LD      A,B
        LD      B,A
        JP      Z,J$21BA
        LD      C,B
        JP      Z,J$24BC
        LD      C,B
        JP      Z,J$28C0
J$7CA8  EQU     $-1
        LD      C,B
        JP      Z,J$2CC1
        LD      C,B
        JP      Z,J$2EC2
        LD      C,B
        JP      Z,C.C2DE
        LD      (D$CA48),A
        CALL    NZ,C$4837
        JP      Z,J$3CDD
        LD      C,B
        JP      Z,C.DDDE
        LD      D,H
        LD      C,B
        BIT     3,E
        LD      C,B
        SET     3,(HL)
        LD      (HL),A
        LD      C,B
        RES     6,D
        LD      (D.CB49),HL
        OR      A
        INC     H
        LD      C,C
        RES     7,D
        DAA
        LD      C,C
        RES     7,H
        ADD     HL,HL
        LD      C,C
        SET     0,D
        DEC     HL
        LD      C,C
        SET     1,C
        JR      NC,J$7D2C
        SET     2,D
        LD      SP,D.CB49
        CALL    NC,C.4934
        SET     2,(HL)
        LD      (HL),49H        ; "I"
        SET     3,(HL)
        SUB     40H     ; "@"
        LD      C,C
        SET     3,C
        LD      B,A
        LD      C,C
        SET     3,L
        LD      C,D
        LD      C,C
        SET     3,(HL)
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        LD      D,D
        LD      C,C
        CALL    Z,C.4954
        CALL    Z,C$6EDE
        LD      C,C
        CALL    Z,C$75B3
        LD      C,C
        CALL    Z,C$78B7
        LD      C,C
        CALL    Z,C$7AB8
        LD      C,C
        CALL    Z,C$25C1
        LD      C,D
        CALL    Z,C$2CDD
        LD      C,D
        CALL    Z,C.DDDE
        JR      C,J$7D6B
        CALL    C$4A3A
        CALL    C.46DE
        LD      C,D
        CALL    C$48B7
        LD      C,D
J$7D2C: CALL    C.C2DE
        LD      C,H
        LD      C,D
        CALL    C.50DD
        LD      C,D
        CALL    C.DDDE
        LD      E,B
        LD      C,D
        ADC     A,5DH   ; "]"
        LD      C,D
        ADC     A,0DEH
        LD      H,A
        LD      C,D
        ADC     A,0B3H
        LD      L,A
        LD      C,D
        ADC     A,0DEH
        OR      E
        INC     SP
        LD      C,E
        ADC     A,0B4H
        LD      C,D
        LD      C,E
        ADC     A,0B8H
        LD      C,H
        LD      C,E
        ADC     A,0DEH
        CP      B
        LD      C,L
        LD      C,E
        ADC     A,0DEH
        JP      NZ,J$4B56
        ADC     A,0D8H
        LD      E,C
        LD      C,E
        ADC     A,0DDH
        LD      E,E
        LD      C,E
        ADC     A,0DEH
        LD      E,(IX+75)
        RST     08H
        LD      H,B
J$7D6B: LD      C,E
        RST     08H
        OR      D
        LD      H,H
        LD      C,E
        RST     08H
        OR      A
        LD      L,D
        LD      C,E
        RST     08H
        CP      E
        LD      L,A
        LD      C,E
        RST     08H
        RET     NZ
        LD      (HL),D
        LD      C,E
        RST     08H
        JP      NZ,J.4B75
        RST     08H
        JP      J$78DE
?.7D84: LD      C,E
        RST     08H
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        LD      A,H
        LD      C,E
        RET     NC
        INC     HL
        LD      C,H
        RET     NC
        JP      NZ,J$4C29
        RET     NC
        PUSH    BC
        CALL    NZ,C.4C2B
        RET     NC
        CALL    NC,C$2EB8
        LD      C,H
        RET     NC
        SUB     0B3H
        CPL
        LD      C,H
        RET     NC
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        LD      SP,I.D14C
        INC     SP
        LD      C,H
        POP     DE
        CP      B
        LD      A,(D$D24C)
        DEC     A
        LD      C,H
        JP      NC,J$46BD
        LD      C,H
        JP      NC,J$48DD
        LD      C,H
        OUT     (4EH),A
        LD      C,H
        OUT     (0B3H),A
        LD      D,C
        LD      C,H
        OUT     (0B8H),A
        LD      E,D
        LD      C,H
        OUT     (0C1H),A
        LD      E,(HL)
        LD      C,H
        OUT     (0C4H),A
        SBC     A,61H   ; "a"
        LD      C,H
        OUT     (0DDH),A
        LD      H,H
        LD      C,H
        CALL    NC,C$4C69
        CALL    NC,C$71B8
        LD      C,H
        CALL    NC,C$77BD
        LD      C,H
        PUSH    DE
        LD      A,E
        LD      C,H
        PUSH    DE
        OR      E
        INC     H
        LD      C,L
        SUB     3DH     ; "="
        LD      C,L
        SUB     0B3H
        LD      B,E
        LD      C,L
        SUB     0B8H
        LD      E,L
        LD      C,L
        RST     10H
        LD      H,L
        LD      C,L
        RST     10H
        OR      D
        LD      L,B
        LD      C,L
        RST     10H
        CP      B
        LD      L,H
        LD      C,L
        RST     10H
        LD      (IX+77),B
        RET     C
        LD      A,B
        LD      C,L
        RET     C
        JP      NZ,J$4E27
        RET     C
        CALL    NC,C$4E2B
        RET     C
        PUSH    DE
        DEC     L
        LD      C,(HL)
        RET     C
        SUB     37H     ; "7"
        LD      C,(HL)
        RET     C
        SUB     0B3H
        DEC     SP
        LD      C,(HL)
        RET     C
        SUB     0B8H
        LD      C,A
        LD      C,(HL)
        RET     C
        DEFB    0DDH            ; << Illegal Op Code Byte >>
        LD      D,C
        LD      C,(HL)
        EXX
        LD      E,H
        LD      C,(HL)
        JP      C,J$4E61
        JP      C,J$71B7
        LD      C,(HL)
        JP      C,J$73C2
        LD      C,(HL)
        JP      C,J$77DD
        LD      C,(HL)
        IN      A,(24H)
        LD      C,A
        IN      A,(0B3H)
        DEC     HL
        LD      C,A
        IN      A,(0B8H)
        DEC     SP
        LD      C,A
        IN      A,(0DDH)
        LD      B,B
        LD      C,A
        CALL    C,C$4F41
        CALL    C,C$44B2
        LD      C,A
        CALL    C,C$46B7
        LD      C,A
        CALL    C,C$DECB
        LD      C,L
        LD      C,A
        CALL    C,C.50DD
        LD      C,A
        NOP
;         Subroutine __________________________
;            Inputs  ________________________
;            Outputs ________________________

C.7E50: PUSH    DE
        LD      E,(IX+4)
        LD      D,(IX+5)
        BIT     7,D                     ; MSX-JE ?
        PUSH    DE
        POP     IY
        POP     DE
        RET     NZ                      ; yep, quit
        PUSH    IX
        POP     IY
        DEC     IY
        DEC     IY
        DEC     IY
        RET

        DEFS    08000H-$,0FFH
